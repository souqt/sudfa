!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=57)}([function(e,t,r){var n;e.exports=(n=n||function(e,t){var r=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),n={},o=n.lib={},i=o.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,o=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var a=r[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=a<<24-(n+i)%4*8}else for(i=0;i<o;i+=4)t[n+i>>>2]=r[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r,n=[],o=function(t){t=t;var r=987654321,n=4294967295;return function(){var o=((r=36969*(65535&r)+(r>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=o(4294967296*(r||e.random()));r=987654071*s(),n.push(4294967296*s()|0)}return new a.init(n,t)}}),s=n.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(r,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(r,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,o=r.sigBytes,i=this.blockSize,s=o/(4*i),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,u=e.min(4*c,o);if(c){for(var l=0;l<c;l+=i)this._doProcessBlock(n,l);var d=n.splice(0,c);r.sigBytes-=u}return new a.init(d,u)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(o.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new p.HMAC.init(e,r).finalize(t)}}}),n.algo={});return n}(Math),n)},function(e,t){function r(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a.sessions={},a.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||a.extension.isInstalled()}return!0};var i={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var r=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var n=new Error("NavigatorUserMediaError");n.name="You cancelled the request for permission, giving up...",r(n)}else r(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function a(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:a.noop,!a.initDone)return e.error("Library not initialized"),{};if(!a.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(a.log("Library initialized: "+a.initDone),!e.server)return e.error("Invalid server url"),{};var t=!1,n=null,i={},s=null,c=null,u=0,l=e.server;a.isArray(l)?(a.log("Multiple servers provided ("+l.length+"), will use the first that works"),l=null,c=e.server,a.debug(c)):0===l.indexOf("ws")?(t=!0,a.log("Using WebSockets to contact Janus: "+l)):(t=!1,a.log("Using REST API to contact Janus: "+l));var d=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],p=e.iceTransportPolicy,f=e.bundlePolicy,h=!0===e.ipv6,m=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(m=!0===e.withCredentials);var _=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(_=e.max_poll_events),_<1&&(_=1);var g=null;void 0!==e.token&&null!==e.token&&(g=e.token);var v=null;void 0!==e.apisecret&&null!==e.apisecret&&(v=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var y=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(y=e.keepAlivePeriod),isNaN(y)&&(y=25e3);var b=6e4;function w(e){var t={high:9e5,medium:3e5,low:1e5};return null!=e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(b=e.longPollTimeout),isNaN(b)&&(b=6e4);var S=!1,k=null,C={},E=this,T=0,P={};function A(){if(null!=k)if(a.debug("Long poll..."),S){var t=l+"/"+k+"?rid="+(new Date).getTime();_&&(t=t+"&maxev="+_),g&&(t=t+"&token="+encodeURIComponent(g)),v&&(t=t+"&apisecret="+encodeURIComponent(v)),a.httpAPICall(t,{verb:"GET",withCredentials:m,success:R,timeout:b,error:function(t,r){if(a.error(t+":",r),++T>3)return S=!1,void e.error("Lost connection to the server (is it down?)");A()}})}else a.warn("Is the server down? (connected=false)")}function R(e,r){if(T=0,t||null==k||!0===r||A(),t||!a.isArray(e))if("keepalive"!==e.janus)if("server_info"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus){if(!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return void a.debug("This handle is not attached to this session");var o=e.candidate;a.debug("Got a trickled candidate on session "+k),a.debug(o);var i=d.webrtcStuff;i.pc&&i.remoteSdp?(a.debug("Adding remote candidate:",o),o&&!0!==o.completed?i.pc.addIceCandidate(o):i.pc.addIceCandidate(a.endOfCandidates)):(a.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),i.candidates||(i.candidates=[]),i.candidates.push(o),a.debug(i.candidates))}else{if("webrtcup"===e.janus)return a.debug("Got a webrtcup event on session "+k),a.debug(e),(u=e.sender)?(d=C[u])?void d.webrtcState(!0):void a.debug("This handle is not attached to this session"):void a.warn("Missing sender...");if("hangup"===e.janus){if(a.debug("Got a hangup event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return void a.debug("This handle is not attached to this session");d.webrtcState(!1,e.reason),d.hangup()}else if("detached"===e.janus){if(a.debug("Got a detached event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return;d.detached=!0,d.ondetached(),d.detach()}else if("media"===e.janus){if(a.debug("Got a media event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return void a.debug("This handle is not attached to this session");d.mediaState(e.type,e.receiving)}else if("slowlink"===e.janus){if(a.debug("Got a slowlink event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return void a.debug("This handle is not attached to this session");d.slowLink(e.uplink,e.lost)}else{if("error"===e.janus){var s,c;if(a.error("Ooops: "+e.error.code+" "+e.error.reason),a.debug(e),s=e.transaction)(c=P[s])&&c(e),delete P[s];return}if("event"===e.janus){var u;if(a.debug("Got a plugin event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");var l=e.plugindata;if(!l)return void a.warn("Missing plugindata...");a.debug("  -- Event is coming from "+u+" ("+l.plugin+")");var d,p=l.data;if(a.debug(p),!(d=C[u]))return void a.warn("This handle is not attached to this session");var f=e.jsep;f&&(a.debug("Handling SDP as well..."),a.debug(f));var h=d.onmessage;h?(a.debug("Notifying application..."),h(p,f)):a.debug("No provided notification callback")}else{if("timeout"===e.janus)return a.error("Timeout on session "+k),a.debug(e),void(t&&n.close(3504,"Gateway timeout"));a.warn("Unknown message/event  '"+e.janus+"' on session "+k),a.debug(e)}}}else a.debug("Got a success on session "+k),a.debug(e),(s=e.transaction)&&((c=P[s])&&c(e),delete P[s]);else a.debug("Got an ack on session "+k),a.debug(e),(s=e.transaction)&&((c=P[s])&&c(e),delete P[s]);else a.debug("Got info on the Janus instance"),a.debug(e),(s=e.transaction)&&((c=P[s])&&c(e),delete P[s]);else a.vdebug("Got a keepalive on session "+k);else for(var m=0;m<e.length;m++)R(e[m],!0)}function O(){if(l&&t&&S){s=setTimeout(O,y);var e={janus:"keepalive",session_id:k,transaction:a.randomString(12)};g&&(e.token=g),v&&(e.apisecret=v),n.send(JSON.stringify(e))}}function x(r){var o=a.randomString(12),d={janus:"create",transaction:o};if(r.reconnect&&(S=!1,d.janus="claim",d.session_id=k,n&&(n.onopen=null,n.onerror=null,n.onclose=null,s&&(clearTimeout(s),s=null))),g&&(d.token=g),v&&(d.apisecret=v),!l&&a.isArray(c)&&(0===(l=c[u]).indexOf("ws")?(t=!0,a.log("Server #"+(u+1)+": trying WebSockets to contact Janus ("+l+")")):(t=!1,a.log("Server #"+(u+1)+": trying REST API to contact Janus ("+l+")"))),t)for(var p in n=a.newWebSocket(l,"janus-protocol"),i={error:function(){if(a.error("Error connecting to the Janus WebSockets server... "+l),a.isArray(c)&&!r.reconnect)return++u===c.length?void r.error("Error connecting to any of the provided Janus servers: Is the server down?"):(l=null,void setTimeout((function(){x(r)}),200));r.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){P[o]=function(e){if(a.debug(e),"success"!==e.janus)return a.error("Ooops: "+e.error.code+" "+e.error.reason),void r.error(e.error.reason);s=setTimeout(O,y),S=!0,k=e.session_id?e.session_id:e.data.id,r.reconnect?a.log("Claimed session: "+k):a.log("Created session: "+k),a.sessions[k]=E,r.success()},n.send(JSON.stringify(d))},message:function(e){R(JSON.parse(e.data))},close:function(){l&&S&&(S=!1,e.error("Lost connection to the server (is it down?)"))}})n.addEventListener(p,i[p]);else a.httpAPICall(l,{verb:"POST",withCredentials:m,body:d,success:function(e){if(a.debug(e),"success"!==e.janus)return a.error("Ooops: "+e.error.code+" "+e.error.reason),void r.error(e.error.reason);S=!0,k=e.session_id?e.session_id:e.data.id,r.reconnect?a.log("Claimed session: "+k):a.log("Created session: "+k),a.sessions[k]=E,A(),r.success()},error:function(e,t){if(a.error(e+":",t),a.isArray(c)&&!r.reconnect)return++u===c.length?void r.error("Error connecting to any of the provided Janus servers: Is the server down?"):(l=null,void setTimeout((function(){x(r)}),200));""===t?r.error(e+": Is the server down?"):r.error(e+": "+t)}})}function M(e,r){if((r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:a.noop,!S)return a.warn("Is the server down? (connected=false)"),void r.error("Is the server down? (connected=false)");var o=C[e];if(!o||!o.webrtcStuff)return a.warn("Invalid handle"),void r.error("Invalid handle");var i=r.message,s=r.jsep,c=a.randomString(12),u={janus:"message",body:i,transaction:c};if(o.token&&(u.token=o.token),v&&(u.apisecret=v),s&&(u.jsep={type:s.type,sdp:s.sdp},s.e2ee&&(u.jsep.e2ee=!0),"hml"!==s.rid_order&&"lmh"!==s.rid_order||(u.jsep.rid_order=s.rid_order)),a.debug("Sending message to plugin (handle="+e+"):"),a.debug(u),t)return u.session_id=k,u.handle_id=e,P[c]=function(e){if(a.debug("Message sent!"),a.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return a.warn("Request succeeded, but missing plugindata..."),void r.success();a.log("Synchronous transaction successful ("+t.plugin+")");var n=t.data;return a.debug(n),void r.success(n)}"ack"===e.janus?r.success():e.error?(a.error("Ooops: "+e.error.code+" "+e.error.reason),r.error(e.error.code+" "+e.error.reason)):(a.error("Unknown error"),r.error("Unknown error"))},void n.send(JSON.stringify(u));a.httpAPICall(l+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:u,success:function(e){if(a.debug("Message sent!"),a.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return a.warn("Request succeeded, but missing plugindata..."),void r.success();a.log("Synchronous transaction successful ("+t.plugin+")");var n=t.data;return a.debug(n),void r.success(n)}"ack"===e.janus?r.success():e.error?(a.error("Ooops: "+e.error.code+" "+e.error.reason),r.error(e.error.code+" "+e.error.reason)):(a.error("Unknown error"),r.error("Unknown error"))},error:function(e,t){a.error(e+":",t),r.error(e+": "+t)}})}function D(e,r){if(S){var o=C[e];if(o&&o.webrtcStuff){var i={janus:"trickle",candidate:r,transaction:a.randomString(12)};if(o.token&&(i.token=o.token),v&&(i.apisecret=v),a.vdebug("Sending trickle candidate (handle="+e+"):"),a.vdebug(i),t)return i.session_id=k,i.handle_id=e,void n.send(JSON.stringify(i));a.httpAPICall(l+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:i,success:function(e){a.vdebug("Candidate sent!"),a.vdebug(e),"ack"===e.janus||a.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){a.error(e+":",t)}})}else a.warn("Invalid handle")}else a.warn("Is the server down? (connected=false)")}function I(e,t,n,o,i){var s=C[e];if(s&&s.webrtcStuff){var c=s.webrtcStuff;if(c.pc){var u=function(e){a.log("Received state change on data channel:",e);var t=e.target.label,n=e.target.protocol,o=c.dataChannel[t]?c.dataChannel[t].readyState:"null";if(a.log("State change on <"+t+"> data channel: "+o),"open"===o){if(c.dataChannel[t].pending&&c.dataChannel[t].pending.length>0){a.log("Sending pending messages on <"+t+">:",c.dataChannel[t].pending.length);var i,u=r(c.dataChannel[t].pending);try{for(u.s();!(i=u.n()).done;){var l=i.value;a.log("Sending data on data channel <"+t+">"),a.debug(l),c.dataChannel[t].send(l)}}catch(e){u.e(e)}finally{u.f()}c.dataChannel[t].pending=[]}s.ondataopen(t,n)}};if(o)c.dataChannel[t]=o;else{var l={ordered:!0};n&&(l.protocol=n),c.dataChannel[t]=c.pc.createDataChannel(t,l)}c.dataChannel[t].onmessage=function(e){a.log("Received message on data channel:",e);var t=e.target.label;s.ondata(e.data,t)},c.dataChannel[t].onopen=u,c.dataChannel[t].onclose=u,c.dataChannel[t].onerror=function(e){a.error("Got error on data channel:",e)},c.dataChannel[t].pending=[],i&&c.dataChannel[t].pending.push(i)}else a.warn("Invalid PeerConnection")}else a.warn("Invalid handle")}function U(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var r=C[e];if(!r||!r.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var n=r.webrtcStuff,o=t.text||t.data;if(!o)return a.warn("Invalid data"),void t.error("Invalid data");var i=t.label?t.label:a.dataChanDefaultLabel;return n.dataChannel[i]?"open"!==n.dataChannel[i].readyState?(n.dataChannel[i].pending.push(o),void t.success()):(a.log("Sending data on data channel <"+i+">"),a.debug(o),n.dataChannel[i].send(o),void t.success()):(I(e,i,t.protocol,!1,o,t.protocol),void t.success())}function B(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var r=C[e];if(!r||!r.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var n=r.webrtcStuff;if(!n.dtmfSender){if(n.pc){var o=n.pc.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));if(!o)return a.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");n.dtmfSender=o.dtmf,n.dtmfSender&&(a.log("Created DTMF Sender"),n.dtmfSender.ontonechange=function(e){a.debug("Sent DTMF tone: "+e.tone)})}if(!n.dtmfSender)return a.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var i=t.dtmf;if(!i)return a.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var s=i.tones;if(!s)return a.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var c="number"==typeof i.duration?i.duration:500,u="number"==typeof i.gap?i.gap:50;a.debug("Sending DTMF string "+s+" (duration "+c+"ms, gap "+u+"ms)"),n.dtmfSender.insertDTMF(s,c,u),t.success()}function L(e,r){(r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:a.noop;var o=!0===r.noRequest;a.log("Destroying handle "+e+" (only-locally="+o+")"),H(e);var i=C[e];if(!i||i.detached)return delete C[e],void r.success();if(o)return delete C[e],void r.success();if(!S)return a.warn("Is the server down? (connected=false)"),void r.error("Is the server down? (connected=false)");var s={janus:"detach",transaction:a.randomString(12)};if(i.token&&(s.token=i.token),v&&(s.apisecret=v),t)return s.session_id=k,s.handle_id=e,n.send(JSON.stringify(s)),delete C[e],void r.success();a.httpAPICall(l+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:s,success:function(t){a.log("Destroyed handle:"),a.debug(t),"success"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),delete C[e],r.success()},error:function(t,n){a.error(t+":",n),delete C[e],r.success()}})}function j(e,t,n,i,s){var c=C[e];if(!c||!c.webrtcStuff)return a.warn("Invalid handle"),i.stream||a.stopAllTracks(s),void i.error("Invalid handle");var u=c.webrtcStuff;a.debug("streamsDone:",s),s&&(a.debug("  -- Audio tracks:",s.getAudioTracks()),a.debug("  -- Video tracks:",s.getVideoTracks()));var l=!1;if(u.myStream&&n.update&&!u.streamExternal){if((!n.update&&z(n)||n.update&&(n.addAudio||n.replaceAudio))&&s.getAudioTracks()&&s.getAudioTracks().length)if(u.myStream.addTrack(s.getAudioTracks()[0]),a.unifiedPlan){a.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",s.getAudioTracks()[0]);var m=null;if((v=u.pc.getTransceivers())&&v.length>0){var _,g=r(v);try{for(g.s();!(_=g.n()).done;){if((k=_.value).sender&&k.sender.track&&"audio"===k.sender.track.kind||k.receiver&&k.receiver.track&&"audio"===k.receiver.track.kind){m=k;break}}}catch(e){g.e(e)}finally{g.f()}}m&&m.sender?m.sender.replaceTrack(s.getAudioTracks()[0]):u.pc.addTrack(s.getAudioTracks()[0],s)}else a.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",s.getAudioTracks()[0]),u.pc.addTrack(s.getAudioTracks()[0],s);if((!n.update&&Y(n)||n.update&&(n.addVideo||n.replaceVideo))&&s.getVideoTracks()&&s.getVideoTracks().length)if(u.myStream.addTrack(s.getVideoTracks()[0]),a.unifiedPlan){a.log((n.replaceVideo?"Replacing":"Adding")+" video track:",s.getVideoTracks()[0]);var v,y=null;if((v=u.pc.getTransceivers())&&v.length>0){var b,S=r(v);try{for(S.s();!(b=S.n()).done;){var k;if((k=b.value).sender&&k.sender.track&&"video"===k.sender.track.kind||k.receiver&&k.receiver.track&&"video"===k.receiver.track.kind){y=k;break}}}catch(e){S.e(e)}finally{S.f()}}y&&y.sender?y.sender.replaceTrack(s.getVideoTracks()[0]):u.pc.addTrack(s.getVideoTracks()[0],s)}else a.log((n.replaceVideo?"Replacing":"Adding")+" video track:",s.getVideoTracks()[0]),u.pc.addTrack(s.getVideoTracks()[0],s)}else u.myStream=s,l=!0;if(!u.pc){var E={iceServers:d,iceTransportPolicy:p,bundlePolicy:f};"chrome"===a.webRTCAdapter.browserDetails.browser&&(E.sdpSemantics=a.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var T={optional:[{DtlsSrtpKeyAgreement:!0}]};if(h&&T.optional.push({googIPv6:!0}),i.rtcConstraints&&"object"===o(i.rtcConstraints))for(var P in a.debug("Adding custom PeerConnection constraints:",i.rtcConstraints),i.rtcConstraints)T.optional.push(i.rtcConstraints[P]);"edge"===a.webRTCAdapter.browserDetails.browser&&(E.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(i.senderTransforms||i.receiverTransforms)&&(u.senderTransforms=i.senderTransforms,u.receiverTransforms=i.receiverTransforms,E.forceEncodedAudioInsertableStreams=!0,E.forceEncodedVideoInsertableStreams=!0,E.encodedInsertableStreams=!0),a.log("Creating PeerConnection"),a.debug(T),u.pc=new RTCPeerConnection(E,T),a.debug(u.pc),u.pc.getStats&&(u.volume={},u.bitrate.value="0 kbits/sec"),a.log("Preparing local SDP and gathering candidates (trickle="+u.trickle+")"),u.pc.oniceconnectionstatechange=function(e){u.pc&&c.iceState(u.pc.iceConnectionState)},u.pc.onicecandidate=function(t){if(!t.candidate||"edge"===a.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)a.log("End of candidates."),u.iceDone=!0,!0===u.trickle?D(e,{completed:!0}):function(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var r=C[e];if(!r||!r.webrtcStuff)return void a.warn("Invalid handle, not sending anything");var n=r.webrtcStuff;if(a.log("Sending offer/answer SDP..."),!n.mySdp)return void a.warn("Local SDP instance is invalid, not sending anything...");n.mySdp={type:n.pc.localDescription.type,sdp:n.pc.localDescription.sdp},!1===n.trickle&&(n.mySdp.trickle=!1);a.debug(t),n.sdpSent=!0,t.success(n.mySdp)}(e,i);else{var r={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===u.trickle&&D(e,r)}},u.pc.ontrack=function(e){if(a.log("Handling Remote Track"),a.debug(e),e.streams&&(u.remoteStream=e.streams[0],c.onremotestream(u.remoteStream),!e.track.onended)){if(u.receiverTransforms){var t=null;RTCRtpSender.prototype.createEncodedStreams?t=e.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===e.track.kind&&u.receiverTransforms.audio?t=e.receiver.createEncodedAudioStreams():"video"===e.track.kind&&u.receiverTransforms.video&&(t=e.receiver.createEncodedVideoStreams())),t&&(console.log(t),t.readableStream&&t.writableStream?t.readableStream.pipeThrough(u.receiverTransforms[e.track.kind]).pipeTo(t.writableStream):t.readable&&t.writable&&t.readable.pipeThrough(u.receiverTransforms[e.track.kind]).pipeTo(t.writable))}var r=null;a.log("Adding onended callback to track:",e.track),e.track.onended=function(e){a.log("Remote track removed:",e),u.remoteStream&&(clearTimeout(r),u.remoteStream.removeTrack(e.target),c.onremotestream(u.remoteStream))},e.track.onmute=function(e){a.log("Remote track muted:",e),u.remoteStream&&null==r&&(r=setTimeout((function(){a.log("Removing remote track"),u.remoteStream&&(u.remoteStream.removeTrack(e.target),c.onremotestream(u.remoteStream)),r=null}),2520))},e.track.onunmute=function(e){if(a.log("Remote track flowing again:",e),null!=r)clearTimeout(r),r=null;else try{u.remoteStream.addTrack(e.target),c.onremotestream(u.remoteStream)}catch(e){a.error(e)}}}}}if(l&&s){a.log("Adding local stream");var A=!0===i.simulcast2;s.getTracks().forEach((function(e){a.log("Adding local track:",e);var t=null;if(A&&"audio"!==e.kind){a.log("Enabling rid-based simulcasting:",e);var r=w(i.simulcastMaxBitrates),n=u.pc.addTransceiver(e,{direction:"sendrecv",streams:[s],sendEncodings:i.sendEncodings||[{rid:"h",active:!0,maxBitrate:r.high},{rid:"m",active:!0,maxBitrate:r.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:r.low,scaleResolutionDownBy:4}]});n&&(t=n.sender)}else t=u.pc.addTrack(e,s);if(t&&u.senderTransforms){var o=null;RTCRtpSender.prototype.createEncodedStreams?o=t.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t.track.kind&&u.senderTransforms.audio?o=t.createEncodedAudioStreams():"video"===t.track.kind&&u.senderTransforms.video&&(o=t.createEncodedVideoStreams())),o&&(console.log(o),o.readableStream&&o.writableStream?o.readableStream.pipeThrough(u.senderTransforms[t.track.kind]).pipeTo(o.writableStream):o.readable&&o.writable&&o.readable.pipeThrough(u.senderTransforms[t.track.kind]).pipeTo(o.writable))}}))}(function(e){if(a.debug("isDataEnabled:",e),"edge"===a.webRTCAdapter.browserDetails.browser)return a.warn("Edge doesn't support data channels yet"),!1;return null!=e&&!0===e.data})(n)&&!u.dataChannel[a.dataChanDefaultLabel]&&(a.log("Creating default data channel"),I(e,a.dataChanDefaultLabel,null,!1),u.pc.ondatachannel=function(t){a.log("Data channel created by Janus:",t),I(e,t.channel.label,t.channel.protocol,t.channel)}),u.myStream&&c.onlocalstream(u.myStream),t?u.pc.setRemoteDescription(t).then((function(){if(a.log("Remote description accepted!"),u.remoteSdp=t.sdp,u.candidates&&u.candidates.length>0){for(var o=0;o<u.candidates.length;o++){var s=u.candidates[o];a.debug("Adding remote candidate:",s),s&&!0!==s.completed?u.pc.addIceCandidate(s):u.pc.addIceCandidate(a.endOfCandidates)}u.candidates=[]}!function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:a.noop;var o=C[e];if(!o||!o.webrtcStuff)return a.warn("Invalid handle"),void n.error("Invalid handle");var i=o.webrtcStuff,s=!0===n.simulcast;s?a.log("Creating answer (iceDone="+i.iceDone+", simulcast="+s+")"):a.log("Creating answer (iceDone="+i.iceDone+")");var c=null;if(a.unifiedPlan){c={};var u=null,l=null,d=i.pc.getTransceivers();if(d&&d.length>0){var p,f=r(d);try{for(f.s();!(p=f.n()).done;){var h=p.value;h.sender&&h.sender.track&&"audio"===h.sender.track.kind||h.receiver&&h.receiver.track&&"audio"===h.receiver.track.kind?u||(u=h):(h.sender&&h.sender.track&&"video"===h.sender.track.kind||h.receiver&&h.receiver.track&&"video"===h.receiver.track.kind)&&(l||(l=h))}}catch(e){f.e(e)}finally{f.f()}}var m=z(t),_=J(t);if(m||_){if(m&&_){if(u)try{u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",a.log("Setting audio transceiver to sendrecv:",u)}catch(e){a.error(e)}}else if(m&&!_)try{u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",a.log("Setting audio transceiver to sendonly:",u))}catch(e){a.error(e)}else if(!m&&_)if(u)try{u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",a.log("Setting audio transceiver to recvonly:",u)}catch(e){a.error(e)}else u=i.pc.addTransceiver("audio",{direction:"recvonly"}),a.log("Adding recvonly audio transceiver:",u)}else if(t.removeAudio&&u)try{u.setDirection?u.setDirection("inactive"):u.direction="inactive",a.log("Setting audio transceiver to inactive:",u)}catch(e){a.error(e)}var g=Y(t),v=X(t);if(g||v){if(g&&v){if(l)try{l.setDirection?l.setDirection("sendrecv"):l.direction="sendrecv",a.log("Setting video transceiver to sendrecv:",l)}catch(e){a.error(e)}}else if(g&&!v){if(l)try{l.setDirection?l.setDirection("sendonly"):l.direction="sendonly",a.log("Setting video transceiver to sendonly:",l)}catch(e){a.error(e)}}else if(!g&&v)if(l)try{l.setDirection?l.setDirection("recvonly"):l.direction="recvonly",a.log("Setting video transceiver to recvonly:",l)}catch(e){a.error(e)}else l=i.pc.addTransceiver("video",{direction:"recvonly"}),a.log("Adding recvonly video transceiver:",l)}else if(t.removeVideo&&l)try{l.setDirection?l.setDirection("inactive"):l.direction="inactive",a.log("Setting video transceiver to inactive:",l)}catch(e){a.error(e)}}else c="firefox"===a.webRTCAdapter.browserDetails.browser||"edge"===a.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:J(t),offerToReceiveVideo:X(t)}:{mandatory:{OfferToReceiveAudio:J(t),OfferToReceiveVideo:X(t)}};a.debug(c);var y=Y(t);if(y&&s&&"firefox"===a.webRTCAdapter.browserDetails.browser){a.log("Enabling Simulcasting for Firefox (RID)");var b=i.pc.getSenders()[1];a.log(b);var S=b.getParameters();a.log(S);var k=w(n.simulcastMaxBitrates);b.setParameters({encodings:n.sendEncodings||[{rid:"h",active:!0,maxBitrate:k.high},{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:k.low,scaleResolutionDownBy:4}]})}i.pc.createAnswer(c).then((function(e){a.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,a.log("Setting local description"),y&&s&&("chrome"===a.webRTCAdapter.browserDetails.browser?a.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==a.webRTCAdapter.browserDetails.browser&&a.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),i.mySdp={type:"answer",sdp:e.sdp},i.pc.setLocalDescription(e).catch(n.error),i.mediaConstraints=c,i.iceDone||i.trickle?((i.senderTransforms||i.receiverTransforms)&&(e.e2ee=!0),n.success(e)):a.log("Waiting for all candidates...")}),n.error)}(e,n,i)}),i.error):function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:a.noop;var o=C[e];if(!o||!o.webrtcStuff)return a.warn("Invalid handle"),void n.error("Invalid handle");var i=o.webrtcStuff,s=!0===n.simulcast;s?a.log("Creating offer (iceDone="+i.iceDone+", simulcast="+s+")"):a.log("Creating offer (iceDone="+i.iceDone+")");var c={};if(a.unifiedPlan){var u=null,l=null,d=i.pc.getTransceivers();if(d&&d.length>0){var p,f=r(d);try{for(f.s();!(p=f.n()).done;){var h=p.value;h.sender&&h.sender.track&&"audio"===h.sender.track.kind||h.receiver&&h.receiver.track&&"audio"===h.receiver.track.kind?u||(u=h):(h.sender&&h.sender.track&&"video"===h.sender.track.kind||h.receiver&&h.receiver.track&&"video"===h.receiver.track.kind)&&(l||(l=h))}}catch(e){f.e(e)}finally{f.f()}}var m=z(t),_=J(t);m||_?m&&_?u&&(u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",a.log("Setting audio transceiver to sendrecv:",u)):m&&!_?u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",a.log("Setting audio transceiver to sendonly:",u)):!m&&_&&(u?(u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",a.log("Setting audio transceiver to recvonly:",u)):(u=i.pc.addTransceiver("audio",{direction:"recvonly"}),a.log("Adding recvonly audio transceiver:",u))):t.removeAudio&&u&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive",a.log("Setting audio transceiver to inactive:",u));var g=Y(t),v=X(t);g||v?g&&v?l&&(l.setDirection?l.setDirection("sendrecv"):l.direction="sendrecv",a.log("Setting video transceiver to sendrecv:",l)):g&&!v?l&&(l.setDirection?l.setDirection("sendonly"):l.direction="sendonly",a.log("Setting video transceiver to sendonly:",l)):!g&&v&&(l?(l.setDirection?l.setDirection("recvonly"):l.direction="recvonly",a.log("Setting video transceiver to recvonly:",l)):(l=i.pc.addTransceiver("video",{direction:"recvonly"}),a.log("Adding recvonly video transceiver:",l))):t.removeVideo&&l&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive",a.log("Setting video transceiver to inactive:",l))}else c.offerToReceiveAudio=J(t),c.offerToReceiveVideo=X(t);!0===n.iceRestart&&(c.iceRestart=!0);a.debug(c);var y=Y(t);if(y&&s&&"firefox"===a.webRTCAdapter.browserDetails.browser){a.log("Enabling Simulcasting for Firefox (RID)");var b=i.pc.getSenders().find((function(e){return"video"===e.track.kind}));if(b){var S=b.getParameters();S||(S={});var k=w(n.simulcastMaxBitrates);S.encodings=n.sendEncodings||[{rid:"h",active:!0,maxBitrate:k.high},{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:k.low,scaleResolutionDownBy:4}],b.setParameters(S)}}i.pc.createOffer(c).then((function(e){a.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,a.log("Setting local description"),y&&s&&("chrome"===a.webRTCAdapter.browserDetails.browser||"safari"===a.webRTCAdapter.browserDetails.browser?(a.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=function(e){for(var t=e.split("\r\n"),r=!1,n=[-1],o=[-1],i=null,s=null,c=null,u=null,l=-1,d=0;d<t.length;d++){if(f=t[d].match(/m=(\w+) */)){if("video"===f[1]){if(!(n[0]<0)){l=d;break}r=!0}else if(n[0]>-1){l=d;break}}else if(r){if(t[d].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/))return a.warn("The SDP already contains a SIM attribute, munging will be skipped"),e;var p=t[d].match(/a=ssrc-group:FID (\d+) (\d+)/);if(p)n[0]=p[1],o[0]=p[2],t.splice(d,1),d--;else{if(n[0]){if((m=t[d].match("a=ssrc:"+n[0]+" cname:(.+)"))&&(i=m[1]),(m=t[d].match("a=ssrc:"+n[0]+" msid:(.+)"))&&(s=m[1]),(m=t[d].match("a=ssrc:"+n[0]+" mslabel:(.+)"))&&(c=m[1]),(m=t[d].match("a=ssrc:"+n[0]+" label:(.+)"))&&(u=m[1]),0===t[d].indexOf("a=ssrc:"+o[0])){t.splice(d,1),d--;continue}if(0===t[d].indexOf("a=ssrc:"+n[0])){t.splice(d,1),d--;continue}}0!=t[d].length||(t.splice(d,1),d--)}}}if(n[0]<0){l=-1,r=!1;for(d=0;d<t.length;d++){var f;if(f=t[d].match(/m=(\w+) */)){if("video"===f[1]){if(!(n[0]<0)){l=d;break}r=!0}else if(n[0]>-1){l=d;break}}else if(r){if(n[0]<0){var h=t[d].match(/a=ssrc:(\d+)/);if(h){n[0]=h[1],t.splice(d,1),d--;continue}}else{var m;if((m=t[d].match("a=ssrc:"+n[0]+" cname:(.+)"))&&(i=m[1]),(m=t[d].match("a=ssrc:"+n[0]+" msid:(.+)"))&&(s=m[1]),(m=t[d].match("a=ssrc:"+n[0]+" mslabel:(.+)"))&&(c=m[1]),(m=t[d].match("a=ssrc:"+n[0]+" label:(.+)"))&&(u=m[1]),0===t[d].indexOf("a=ssrc:"+o[0])){t.splice(d,1),d--;continue}if(0===t[d].indexOf("a=ssrc:"+n[0])){t.splice(d,1),d--;continue}}0!==t[d].length||(t.splice(d,1),d--)}}}if(n[0]<0)return a.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;l<0&&(l=t.length);n[1]=Math.floor(4294967295*Math.random()),n[2]=Math.floor(4294967295*Math.random()),o[1]=Math.floor(4294967295*Math.random()),o[2]=Math.floor(4294967295*Math.random());for(d=0;d<n.length;d++)i&&(t.splice(l,0,"a=ssrc:"+n[d]+" cname:"+i),l++),s&&(t.splice(l,0,"a=ssrc:"+n[d]+" msid:"+s),l++),c&&(t.splice(l,0,"a=ssrc:"+n[d]+" mslabel:"+c),l++),u&&(t.splice(l,0,"a=ssrc:"+n[d]+" label:"+u),l++),i&&(t.splice(l,0,"a=ssrc:"+o[d]+" cname:"+i),l++),s&&(t.splice(l,0,"a=ssrc:"+o[d]+" msid:"+s),l++),c&&(t.splice(l,0,"a=ssrc:"+o[d]+" mslabel:"+c),l++),u&&(t.splice(l,0,"a=ssrc:"+o[d]+" label:"+u),l++);t.splice(l,0,"a=ssrc-group:FID "+n[2]+" "+o[2]),t.splice(l,0,"a=ssrc-group:FID "+n[1]+" "+o[1]),t.splice(l,0,"a=ssrc-group:FID "+n[0]+" "+o[0]),t.splice(l,0,"a=ssrc-group:SIM "+n[0]+" "+n[1]+" "+n[2]),(e=t.join("\r\n")).endsWith("\r\n")||(e+="\r\n");return e}(e.sdp)):"firefox"!==a.webRTCAdapter.browserDetails.browser&&a.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),i.mySdp={type:"offer",sdp:e.sdp},i.pc.setLocalDescription(e).catch(n.error),i.mediaConstraints=c,i.iceDone||i.trickle?((i.senderTransforms||i.receiverTransforms)&&(e.e2ee=!0),n.success(e)):a.log("Waiting for all candidates...")}),n.error)}(e,n,i)}function F(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:W;var i=n.jsep;if(t&&i)return a.error("Provided a JSEP to a createOffer"),void n.error("Provided a JSEP to a createOffer");if(!(t||i&&i.type&&i.sdp))return a.error("A valid JSEP is required for createAnswer"),void n.error("A valid JSEP is required for createAnswer");n.media="object"===o(n.media)&&n.media?n.media:{audio:!0,video:!0};var s=n.media,c=C[e];if(!c||!c.webrtcStuff)return a.warn("Invalid handle"),void n.error("Invalid handle");var u,l=c.webrtcStuff;if(l.trickle=(u=n.trickle,a.debug("isTrickleEnabled:",u),!1!==u),l.pc){if(a.log("Updating existing media session"),s.update=!0,n.stream)n.stream!==l.myStream&&a.log("Renegotiation involves a new external stream");else{if(s.addAudio){if(s.keepAudio=!1,s.replaceAudio=!1,s.removeAudio=!1,s.audioSend=!0,l.myStream&&l.myStream.getAudioTracks()&&l.myStream.getAudioTracks().length)return a.error("Can't add audio stream, there already is one"),void n.error("Can't add audio stream, there already is one")}else s.removeAudio?(s.keepAudio=!1,s.replaceAudio=!1,s.addAudio=!1,s.audioSend=!1):s.replaceAudio&&(s.keepAudio=!1,s.addAudio=!1,s.removeAudio=!1,s.audioSend=!0);if(l.myStream&&l.myStream.getAudioTracks()&&0!==l.myStream.getAudioTracks().length?!z(s)||s.removeAudio||s.replaceAudio||(s.keepAudio=!0):(s.replaceAudio&&(s.keepAudio=!1,s.replaceAudio=!1,s.addAudio=!0,s.audioSend=!0),z(s)&&(s.keepAudio=!1,s.addAudio=!0)),s.addVideo){if(s.keepVideo=!1,s.replaceVideo=!1,s.removeVideo=!1,s.videoSend=!0,l.myStream&&l.myStream.getVideoTracks()&&l.myStream.getVideoTracks().length)return a.error("Can't add video stream, there already is one"),void n.error("Can't add video stream, there already is one")}else s.removeVideo?(s.keepVideo=!1,s.replaceVideo=!1,s.addVideo=!1,s.videoSend=!1):s.replaceVideo&&(s.keepVideo=!1,s.addVideo=!1,s.removeVideo=!1,s.videoSend=!0);l.myStream&&l.myStream.getVideoTracks()&&0!==l.myStream.getVideoTracks().length?!Y(s)||s.removeVideo||s.replaceVideo||(s.keepVideo=!0):(s.replaceVideo&&(s.keepVideo=!1,s.replaceVideo=!1,s.addVideo=!0,s.videoSend=!0),Y(s)&&(s.keepVideo=!1,s.addVideo=!0)),s.addData&&(s.data=!0)}if(z(s)&&s.keepAudio&&Y(s)&&s.keepVideo)return c.consentDialog(!1),void j(e,i,s,n,l.myStream)}else s.update=!1,s.keepAudio=!1,s.keepVideo=!1;if(s.update&&!l.streamExternal){if(s.removeAudio||s.replaceAudio){if(l.myStream&&l.myStream.getAudioTracks()&&l.myStream.getAudioTracks().length){var d=l.myStream.getAudioTracks()[0];a.log("Removing audio track:",d),l.myStream.removeTrack(d);try{d.stop()}catch(e){}}if(l.pc.getSenders()&&l.pc.getSenders().length){var p=!0;if(s.replaceAudio&&a.unifiedPlan&&(p=!1),p){var f,h=r(l.pc.getSenders());try{for(h.s();!(f=h.n()).done;){var m=f.value;m&&m.track&&"audio"===m.track.kind&&(a.log("Removing audio sender:",m),l.pc.removeTrack(m))}}catch(e){h.e(e)}finally{h.f()}}}}if(s.removeVideo||s.replaceVideo){if(l.myStream&&l.myStream.getVideoTracks()&&l.myStream.getVideoTracks().length){var _=l.myStream.getVideoTracks()[0];a.log("Removing video track:",_),l.myStream.removeTrack(_);try{_.stop()}catch(e){}}if(l.pc.getSenders()&&l.pc.getSenders().length){var g=!0;if(s.replaceVideo&&a.unifiedPlan&&(g=!1),g){var v,y=r(l.pc.getSenders());try{for(y.s();!(v=y.n()).done;){var b=v.value;b&&b.track&&"video"===b.track.kind&&(a.log("Removing video sender:",b),l.pc.removeTrack(b))}}catch(e){y.e(e)}finally{y.f()}}}}}if(n.stream){var w=n.stream;return a.log("MediaStream provided by the application"),a.debug(w),s.update&&l.myStream&&l.myStream!==n.stream&&!l.streamExternal&&(a.stopAllTracks(l.myStream),l.myStream=null),l.streamExternal=!0,c.consentDialog(!1),void j(e,i,s,n,w)}if(z(s)||Y(s)){if(!a.isGetUserMediaAvailable())return void n.error("getUserMedia not available");var S={mandatory:{},optional:[]};c.consentDialog(!0);var k=z(s);k&&s&&"object"===o(s.audio)&&(k=s.audio);var E=Y(s);if(E&&s){var T=!0===n.simulcast,P=!0===n.simulcast2;if(!T&&!P||i||s.video||(s.video="hires"),s.video&&"screen"!=s.video&&"window"!=s.video)if("object"===o(s.video))E=s.video;else{var A=0,R=0;"lowres"===s.video?(R=240,A=320):"lowres-16:9"===s.video?(R=180,A=320):"hires"===s.video||"hires-16:9"===s.video||"hdres"===s.video?(R=720,A=1280):"fhdres"===s.video?(R=1080,A=1920):"4kres"===s.video?(R=2160,A=3840):"stdres"===s.video?(R=480,A=640):"stdres-16:9"===s.video?(R=360,A=640):(a.log("Default video setting is stdres 4:3"),R=480,A=640),a.log("Adding media constraint:",s.video),E={height:{ideal:R},width:{ideal:A}},a.log("Adding video constraint:",E)}else if("screen"===s.video||"window"===s.video){var O=function(t,r){c.consentDialog(!1),t?n.error(t):j(e,i,s,n,r)},x=function(e,t,r){a.log("Adding media constraint (screen capture)"),a.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){r?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(r){e.addTrack(r.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){c.consentDialog(!1),t(e)}))};if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return S.video={},s.screenshareFrameRate&&(S.video.frameRate=s.screenshareFrameRate),s.screenshareHeight&&(S.video.height=s.screenshareHeight),s.screenshareWidth&&(S.video.width=s.screenshareWidth),S.audio=s.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(S).then((function(t){c.consentDialog(!1),z(s)&&!s.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(r){t.addTrack(r.getAudioTracks()[0]),j(e,i,s,n,t)})):j(e,i,s,n,t)}),(function(e){c.consentDialog(!1),n.error(e)}));if("chrome"===a.webRTCAdapter.browserDetails.browser){var M=a.webRTCAdapter.browserDetails.version,D=33;window.navigator.userAgent.match("Linux")&&(D=35),M>=26&&M<=D?(S={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:s.screenshareFrameRate,maxFrameRate:s.screenshareFrameRate,chromeMediaSource:"screen"}},audio:z(s)&&!s.keepAudio},x(S,O)):a.extension.getScreen((function(e,t){if(e)return c.consentDialog(!1),n.error(e);(S={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:s.screenshareFrameRate,maxFrameRate:s.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=t,x(S,O,z(s)&&!s.keepAudio)}))}else if("firefox"===a.webRTCAdapter.browserDetails.browser){if(!(a.webRTCAdapter.browserDetails.version>=33)){var I=new Error("NavigatorUserMediaError");return I.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",c.consentDialog(!1),void n.error(I)}S={video:{mozMediaSource:s.video,mediaSource:s.video},audio:z(s)&&!s.keepAudio},x(S,(function(e,t){if(O(e,t),!e)var r=t.currentTime,n=window.setInterval((function(){t||window.clearInterval(n),t.currentTime==r&&(window.clearInterval(n),t.onended&&t.onended()),r=t.currentTime}),500)}))}return}}s&&"screen"===s.video||navigator.mediaDevices.enumerateDevices().then((function(t){var r=t.some((function(e){return"audioinput"===e.kind})),u=function(e){if(a.debug("isScreenSendEnabled:",e),!e)return!1;if("object"!==o(e.video)||"object"!==o(e.video.mandatory))return!1;var t=e.video.mandatory;if(t.chromeMediaSource)return"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource;if(t.mozMediaSource)return"window"===t.mozMediaSource||"screen"===t.mozMediaSource;if(t.mediaSource)return"window"===t.mediaSource||"screen"===t.mediaSource;return!1}(s)||t.some((function(e){return"videoinput"===e.kind})),l=z(s),d=Y(s),p=function(e){return a.debug("isAudioSendRequired:",e),!!e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}(s),f=function(e){return a.debug("isVideoSendRequired:",e),!!e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}(s);if(l||d||p||f){var h=!!l&&r,m=!!d&&u;if(!h&&!m)return c.consentDialog(!1),n.error("No capture device found"),!1;if(!h&&p)return c.consentDialog(!1),n.error("Audio capture is required, but no capture device found"),!1;if(!m&&f)return c.consentDialog(!1),n.error("Video capture is required, but no capture device found"),!1}var _={audio:!(!r||s.keepAudio)&&k,video:!(!u||s.keepVideo)&&E};a.debug("getUserMedia constraints",_),_.audio||_.video?navigator.mediaDevices.getUserMedia(_).then((function(t){c.consentDialog(!1),j(e,i,s,n,t)})).catch((function(e){c.consentDialog(!1),n.error({code:e.code,name:e.name,message:e.message})})):(c.consentDialog(!1),j(e,i,s,n,w))})).catch((function(e){c.consentDialog(!1),n.error(e)}))}else j(e,i,s,n)}function $(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:W;var r=t.jsep,n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var o=n.webrtcStuff;if(r){if(!o.pc)return a.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");o.pc.setRemoteDescription(r).then((function(){if(a.log("Remote description accepted!"),o.remoteSdp=r.sdp,o.candidates&&o.candidates.length>0){for(var e=0;e<o.candidates.length;e++){var n=o.candidates[e];a.debug("Adding remote candidate:",n),n&&!0!==n.completed?o.pc.addIceCandidate(n):o.pc.addIceCandidate(a.endOfCandidates)}o.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function N(e,t){var r=C[e];if(!r||!r.webrtcStuff)return a.warn("Invalid handle"),0;var n=t?"remote":"local",o=r.webrtcStuff;return o.volume[n]||(o.volume[n]={value:0}),!o.pc.getStats||"chrome"!==a.webRTCAdapter.browserDetails.browser&&"safari"!==a.webRTCAdapter.browserDetails.browser?(a.warn("Getting the "+n+" volume unsupported by browser"),0):t&&!o.remoteStream?(a.warn("Remote stream unavailable"),0):t||o.myStream?o.volume[n].timer?o.volume[n].value:(a.log("Starting "+n+" volume monitor"),o.volume[n].timer=setInterval((function(){o.pc.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(t&&!e.remoteSource||!t&&"media-source"!==e.type||(o.volume[n].value=e.audioLevel?e.audioLevel:0))}))}))}),200),0):(a.warn("Local stream unavailable"),0)}function q(e,t){var r=C[e];if(!r||!r.webrtcStuff)return a.warn("Invalid handle"),!0;var n=r.webrtcStuff;return n.pc?n.myStream?t?n.myStream.getVideoTracks()&&0!==n.myStream.getVideoTracks().length?!n.myStream.getVideoTracks()[0].enabled:(a.warn("No video track"),!0):n.myStream.getAudioTracks()&&0!==n.myStream.getAudioTracks().length?!n.myStream.getAudioTracks()[0].enabled:(a.warn("No audio track"),!0):(a.warn("Invalid local MediaStream"),!0):(a.warn("Invalid PeerConnection"),!0)}function G(e,t,r){var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),!1;var o=n.webrtcStuff;return o.pc?o.myStream?t?o.myStream.getVideoTracks()&&0!==o.myStream.getVideoTracks().length?(o.myStream.getVideoTracks()[0].enabled=!r,!0):(a.warn("No video track"),!1):o.myStream.getAudioTracks()&&0!==o.myStream.getAudioTracks().length?(o.myStream.getAudioTracks()[0].enabled=!r,!0):(a.warn("No audio track"),!1):(a.warn("Invalid local MediaStream"),!1):(a.warn("Invalid PeerConnection"),!1)}function V(e){var t=C[e];if(!t||!t.webrtcStuff)return a.warn("Invalid handle"),"Invalid handle";var r=t.webrtcStuff;return r.pc?r.pc.getStats?r.bitrate.timer?r.bitrate.value:(a.log("Starting bitrate timer (via getStats)"),r.bitrate.timer=setInterval((function(){r.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(r.bitrate.bsnow=e.bytesReceived,r.bitrate.tsnow=e.timestamp,null===r.bitrate.bsbefore||null===r.bitrate.tsbefore)r.bitrate.bsbefore=r.bitrate.bsnow,r.bitrate.tsbefore=r.bitrate.tsnow;else{var n=r.bitrate.tsnow-r.bitrate.tsbefore;"safari"===a.webRTCAdapter.browserDetails.browser&&(n/=1e3);var o=Math.round(8*(r.bitrate.bsnow-r.bitrate.bsbefore)/n);"safari"===a.webRTCAdapter.browserDetails.browser&&(o=parseInt(o/1e3)),r.bitrate.value=o+" kbits/sec",r.bitrate.bsbefore=r.bitrate.bsnow,r.bitrate.tsbefore=r.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):(a.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function W(e){a.error("WebRTC error:",e)}function H(e,r){a.log("Cleaning WebRTC stuff");var o=C[e];if(o){var i=o.webrtcStuff;if(i){if(!0===r){var s={janus:"hangup",transaction:a.randomString(12)};o.token&&(s.token=o.token),v&&(s.apisecret=v),a.debug("Sending hangup request (handle="+e+"):"),a.debug(s),t?(s.session_id=k,s.handle_id=e,n.send(JSON.stringify(s))):a.httpAPICall(l+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:s})}i.remoteStream=null,i.volume&&(i.volume.local&&i.volume.local.timer&&clearInterval(i.volume.local.timer),i.volume.remote&&i.volume.remote.timer&&clearInterval(i.volume.remote.timer)),i.volume={},i.bitrate.timer&&clearInterval(i.bitrate.timer),i.bitrate.timer=null,i.bitrate.bsnow=null,i.bitrate.bsbefore=null,i.bitrate.tsnow=null,i.bitrate.tsbefore=null,i.bitrate.value=null,!i.streamExternal&&i.myStream&&(a.log("Stopping local stream tracks"),a.stopAllTracks(i.myStream)),i.streamExternal=!1,i.myStream=null;try{i.pc.close()}catch(e){}i.pc=null,i.candidates=null,i.mySdp=null,i.remoteSdp=null,i.iceDone=!1,i.dataChannel={},i.dtmfSender=null,i.senderTransforms=null,i.receiverTransforms=null}o.oncleanup()}}function z(e){return a.debug("isAudioSendEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function J(e){return a.debug("isAudioRecvEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function Y(e){return a.debug("isVideoSendEnabled:",e),!e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function X(e){return a.debug("isVideoRecvEnabled:",e),!e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}x(e),this.getServer=function(){return l},this.isConnected=function(){return S},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.reconnect=!0,x(e)},this.getSessionId=function(){return k},this.getInfo=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,a.log("Getting info on Janus instance"),!S)return a.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var r=a.randomString(12),o={janus:"info",transaction:r};g&&(o.token=g);v&&(o.apisecret=v);if(t)return P[r]=function(t){a.log("Server info:"),a.debug(t),"server_info"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},void n.send(JSON.stringify(o));a.httpAPICall(l,{verb:"POST",withCredentials:m,body:o,success:function(t){a.log("Server info:"),a.debug(t),"server_info"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},error:function(t,r){a.error(t+":",r),""===r?e.error(t+": Is the server down?"):e.error(t+": "+r)}})}(e)},this.destroy=function(r){!function(r){(r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:a.noop;var o=!0===r.unload,c=!0;void 0!==r.notifyDestroyed&&null!==r.notifyDestroyed&&(c=!0===r.notifyDestroyed);var u=!0===r.cleanupHandles;if(a.log("Destroying session "+k+" (unload="+o+")"),!k)return a.warn("No session to destroy"),r.success(),void(c&&e.destroyed());if(u)for(var d in C)L(d,{noRequest:!0});if(!S)return a.warn("Is the server down? (connected=false)"),k=null,void r.success();var p={janus:"destroy",transaction:a.randomString(12)};g&&(p.token=g);v&&(p.apisecret=v);if(o)return t?(n.onclose=null,n.close(),n=null):navigator.sendBeacon(l+"/"+k,JSON.stringify(p)),a.log("Destroyed session:"),k=null,S=!1,r.success(),void(c&&e.destroyed());if(t){p.session_id=k;var f=function(){for(var e in i)n.removeEventListener(e,i[e]);n.removeEventListener("message",h),n.removeEventListener("error",_),s&&clearTimeout(s),n.close()},h=function(t){var n=JSON.parse(t.data);n.session_id==p.session_id&&n.transaction==p.transaction&&(f(),r.success(),c&&e.destroyed())},_=function(t){f(),r.error("Failed to destroy the server: Is the server down?"),c&&e.destroyed()};return n.addEventListener("message",h),n.addEventListener("error",_),void(1===n.readyState?n.send(JSON.stringify(p)):_())}a.httpAPICall(l+"/"+k,{verb:"POST",withCredentials:m,body:p,success:function(t){a.log("Destroyed session:"),a.debug(t),k=null,S=!1,"success"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),r.success(),c&&e.destroyed()},error:function(t,n){a.error(t+":",n),k=null,S=!1,r.success(),c&&e.destroyed()}})}(r)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:a.noop,e.iceState="function"==typeof e.iceState?e.iceState:a.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:a.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:a.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:a.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:a.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:a.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:a.noop,e.ondata="function"==typeof e.ondata?e.ondata:a.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:a.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:a.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:a.noop,!S)return a.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var r=e.plugin;if(!r)return a.error("Invalid plugin"),void e.error("Invalid plugin");var o=e.opaqueId,i=e.token?e.token:g,s=a.randomString(12),c={janus:"attach",plugin:r,opaque_id:o,transaction:s};i&&(c.token=i);v&&(c.apisecret=v);if(t)return P[s]=function(t){if(a.debug(t),"success"!==t.janus)return a.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var n=t.data.id;a.log("Created handle: "+n);var o={session:E,plugin:r,id:n,token:i,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return r},getVolume:function(){return N(n,!0)},getRemoteVolume:function(){return N(n,!0)},getLocalVolume:function(){return N(n,!1)},isAudioMuted:function(){return q(n,!1)},muteAudio:function(){return G(n,!1,!0)},unmuteAudio:function(){return G(n,!1,!1)},isVideoMuted:function(){return q(n,!0)},muteVideo:function(){return G(n,!0,!0)},unmuteVideo:function(){return G(n,!0,!1)},getBitrate:function(){return V(n)},send:function(e){M(n,e)},data:function(e){U(n,e)},dtmf:function(e){B(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){F(n,!0,e)},createAnswer:function(e){F(n,!1,e)},handleRemoteJsep:function(e){$(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){H(n,!0===e)},detach:function(e){L(n,e)}};C[n]=o,e.success(o)},c.session_id=k,void n.send(JSON.stringify(c));a.httpAPICall(l+"/"+k,{verb:"POST",withCredentials:m,body:c,success:function(t){if(a.debug(t),"success"!==t.janus)return a.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var n=t.data.id;a.log("Created handle: "+n);var o={session:E,plugin:r,id:n,token:i,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return r},getVolume:function(){return N(n,!0)},getRemoteVolume:function(){return N(n,!0)},getLocalVolume:function(){return N(n,!1)},isAudioMuted:function(){return q(n,!1)},muteAudio:function(){return G(n,!1,!0)},unmuteAudio:function(){return G(n,!1,!1)},isVideoMuted:function(){return q(n,!0)},muteVideo:function(){return G(n,!0,!0)},unmuteVideo:function(){return G(n,!0,!1)},getBitrate:function(){return V(n)},send:function(e){M(n,e)},data:function(e){U(n,e)},dtmf:function(e){B(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){F(n,!0,e)},createAnswer:function(e){F(n,!1,e)},handleRemoteJsep:function(e){$(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){H(n,!0===e)},detach:function(e){L(n,e)}};C[n]=o,e.success(o)},error:function(t,r){a.error(t+":",r),""===r?e.error(t+": Is the server down?"):e.error(t+": "+r)}})}(e)}}a.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,r=e&&e.Promise||Promise,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},extension:e&&e.extension||i,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,n){var i={method:n.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===n.verb&&(i.headers["Content-Type"]="application/json"),void 0!==n.withCredentials&&(i.credentials=!0===n.withCredentials?"include":n.withCredentials?n.withCredentials:"omit"),n.body&&(i.body=JSON.stringify(n.body));var s=t(e,i).catch((function(e){return r.reject({message:"Probably a network error, is the server down?",error:e})}));if(n.timeout){var c=new r((function(e,t){var r=setTimeout((function(){return clearTimeout(r),t({message:"Request timed out",timeout:n.timeout})}),n.timeout)}));s=r.race([s,c])}return s.then((function(e){return e.ok?o(n.success)===o(a.noop)?e.json().then((function(e){n.success(e)})).catch((function(t){return r.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:r.reject({message:"API call failed",response:e})})).catch((function(e){o(n.error)===o(a.noop)&&n.error(e.message||"<< internal error >>",e)})),s}}},a.useOldDependencies=function(e){var t=e&&e.jQuery||jQuery,r=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new r(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||i,webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,r){var n=void 0!==r.body?{contentType:"application/json",data:JSON.stringify(r.body)}:{},i=void 0!==r.withCredentials?{xhrFields:{withCredentials:r.withCredentials}}:{};return t.ajax(t.extend(n,i,{url:e,type:r.verb,cache:!1,dataType:"json",async:r.async,timeout:r.timeout,success:function(e){o(r.success)===o(a.noop)&&r.success(e)},error:function(e,t,n){o(r.error)===o(a.noop)&&r.error(t,n)}}))}}},a.noop=function(){},a.dataChanDefaultLabel="JanusDataChannel",a.endOfCandidates=null,a.stopAllTracks=function(e){try{var t,n=r(e.getTracks());try{for(n.s();!(t=n.n()).done;){var o=t.value;a.log(o),o&&o.stop()}}catch(e){n.e(e)}finally{n.f()}}catch(e){}},a.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:a.noop,a.initDone)e.callback();else{if("undefined"!=typeof console&&void 0!==console.log||(console={log:function(){}}),a.trace=a.noop,a.debug=a.noop,a.vdebug=a.noop,a.log=a.noop,a.warn=a.noop,a.error=a.noop,!0===e.debug||"all"===e.debug)a.trace=console.trace.bind(console),a.debug=console.debug.bind(console),a.vdebug=console.debug.bind(console),a.log=console.log.bind(console),a.warn=console.warn.bind(console),a.error=console.error.bind(console);else if(Array.isArray(e.debug)){var t,n=r(e.debug);try{for(n.s();!(t=n.n()).done;){var o=t.value;switch(o){case"trace":a.trace=console.trace.bind(console);break;case"debug":a.debug=console.debug.bind(console);break;case"vdebug":a.vdebug=console.debug.bind(console);break;case"log":a.log=console.log.bind(console);break;case"warn":a.warn=console.warn.bind(console);break;case"error":a.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+o+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}}}catch(e){n.e(e)}finally{n.f()}}a.log("Initializing library");var i=e.dependencies||a.useDefaultDependencies();a.isArray=i.isArray,a.webRTCAdapter=i.webRTCAdapter,a.httpAPICall=i.httpAPICall,a.newWebSocket=i.newWebSocket,a.extension=i.extension,a.extension.init(),a.listDevices=function(e,t){e="function"==typeof e?e:a.noop,null==t&&(t={audio:!0,video:!0}),a.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(r){a.debug(r),e(r),a.stopAllTracks(t)}))})).catch((function(t){a.error(t),e([])})):(a.warn("navigator.mediaDevices unavailable"),e([]))},a.attachMediaStream=function(e,t){try{e.srcObject=t}catch(r){try{e.src=URL.createObjectURL(t)}catch(e){a.error("Error attaching stream to element")}}},a.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(r){try{e.src=t.src}catch(e){a.error("Error reattaching stream to element")}}};var s=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",c=window["on"+s];if(window.addEventListener(s,(function(e){for(var t in a.log("Closing window"),a.sessions)a.sessions[t]&&a.sessions[t].destroyOnUnload&&(a.log("Destroying session "+t),a.sessions[t].destroy({unload:!0,notifyDestroyed:!1}));c&&"function"==typeof c&&c()})),a.safariVp8=!1,"safari"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){var u,l=r(RTCRtpSender.getCapabilities("video").codecs);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(d&&d.mimeType&&"video/vp8"===d.mimeType.toLowerCase()){a.safariVp8=!0;break}}}catch(e){l.e(e)}finally{l.f()}a.safariVp8?a.log("This version of Safari supports VP8"):a.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var p=new RTCPeerConnection({});p.createOffer({offerToReceiveVideo:!0}).then((function(e){a.safariVp8=-1!==e.sdp.indexOf("VP8"),a.safariVp8?a.log("This version of Safari supports VP8"):a.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),p.close(),p=null}))}if(a.unifiedPlan=!1,"firefox"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=59)a.unifiedPlan=!0;else if("chrome"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=72)a.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var f=new RTCPeerConnection;try{f.addTransceiver("audio"),a.unifiedPlan=!0}catch(e){}f.close()}else a.unifiedPlan=!1;a.initDone=!0,e.callback()}},a.isWebrtcSupported=function(){return!!window.RTCPeerConnection},a.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},a.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",n=0;n<e;n++){var o=Math.floor(Math.random()*t.length);r+=t.substring(o,o+1)}return r},e.exports=a},function(e,t,r){var n,o,i,a,s,c,u,l,d,p,f,h,m,_,g,v,y,b,w;e.exports=(n=r(0),r(5),void(n.lib.Cipher||(o=n,i=o.lib,a=i.Base,s=i.WordArray,c=i.BufferedBlockAlgorithm,u=o.enc,u.Utf8,l=u.Base64,d=o.algo.EvpKDF,p=i.Cipher=c.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:y}return function(t){return{encrypt:function(r,n,o){return e(n).encrypt(t,r,n,o)},decrypt:function(r,n,o){return e(n).decrypt(t,r,n,o)}}}}()}),i.StreamCipher=p.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),f=o.mode={},h=i.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),m=f.CBC=function(){var e=h.extend();function t(e,t,r){var n=this._iv;if(n){var o=n;this._iv=void 0}else o=this._prevBlock;for(var i=0;i<r;i++)e[t+i]^=o[i]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize;t.call(this,e,r,o),n.encryptBlock(e,r),this._prevBlock=e.slice(r,r+o)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize,i=e.slice(r,r+o);n.decryptBlock(e,r),t.call(this,e,r,o),this._prevBlock=i}}),e}(),_=(o.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,o=n<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);var c=s.create(i,n);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:m,padding:_}),reset:function(){p.reset.call(this);var e=this.cfg,t=e.iv,r=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=r.createEncryptor;else n=r.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==n?this._mode.init(this,t&&t.words):(this._mode=n.call(r,this,t&&t.words),this._mode.__creator=n)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),g=i.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),v=(o.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;if(r)var n=s.create([1398893684,1701076831]).concat(r).concat(t);else n=t;return n.toString(l)},parse:function(e){var t=l.parse(e),r=t.words;if(1398893684==r[0]&&1701076831==r[1]){var n=s.create(r.slice(2,4));r.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:n})}},y=i.SerializableCipher=a.extend({cfg:a.extend({format:v}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var o=e.createEncryptor(r,n),i=o.finalize(t),a=o.cfg;return g.create({ciphertext:i,key:r,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),b=(o.kdf={}).OpenSSL={execute:function(e,t,r,n){n||(n=s.random(8));var o=d.create({keySize:t+r}).compute(e,n),i=s.create(o.words.slice(t),4*r);return o.sigBytes=4*t,g.create({key:o,iv:i,salt:n})}},w=i.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:b}),encrypt:function(e,t,r,n){var o=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize);n.iv=o.iv;var i=y.encrypt.call(this,e,t,o.key,n);return i.mixIn(o),i},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var o=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);return n.iv=o.iv,y.decrypt.call(this,e,t,o.key,n)}}))))},function(e,t,r){"use strict";var n=r(30),o=r(93),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,o=arguments.length;n<o;n++)u(arguments[n],r);return t},extend:function(e,t,r){return u(t,(function(t,o){e[o]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,r){var n=r(111),o=r(112),i=o;i.v1=n,i.v4=o,e.exports=i},function(e,t,r){var n,o,i,a,s,c,u,l;e.exports=(l=r(0),r(18),r(19),o=(n=l).lib,i=o.Base,a=o.WordArray,s=n.algo,c=s.MD5,u=s.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=r.hasher.create(),o=a.create(),i=o.words,s=r.keySize,c=r.iterations;i.length<s;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var l=1;l<c;l++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*s,o}}),n.EvpKDF=function(e,t,r){return u.create(r).compute(e,t)},l.EvpKDF)},function(e,t,r){var n,o,i;e.exports=(i=r(0),o=(n=i).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var o=[],i=0;i<r;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<r;s++)o.push(n.charAt(a>>>6*(3-s)&63));var c=n.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,r=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var i=0;i<r.length;i++)n[r.charCodeAt(i)]=i}var a=r.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,r){for(var n=[],i=0,a=0;a<t;a++)if(a%4){var s=r[e.charCodeAt(a-1)]<<a%4*2,c=r[e.charCodeAt(a)]>>>6-a%4*2;n[i>>>2]|=(s|c)<<24-i%4*8,i++}return o.create(n,i)}(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},i.enc.Base64)},function(e,t,r){var n;e.exports=(n=r(0),function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=a.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,o=e[n];e[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],c=e[t+1],f=e[t+2],h=e[t+3],m=e[t+4],_=e[t+5],g=e[t+6],v=e[t+7],y=e[t+8],b=e[t+9],w=e[t+10],S=e[t+11],k=e[t+12],C=e[t+13],E=e[t+14],T=e[t+15],P=i[0],A=i[1],R=i[2],O=i[3];P=u(P,A,R,O,a,7,s[0]),O=u(O,P,A,R,c,12,s[1]),R=u(R,O,P,A,f,17,s[2]),A=u(A,R,O,P,h,22,s[3]),P=u(P,A,R,O,m,7,s[4]),O=u(O,P,A,R,_,12,s[5]),R=u(R,O,P,A,g,17,s[6]),A=u(A,R,O,P,v,22,s[7]),P=u(P,A,R,O,y,7,s[8]),O=u(O,P,A,R,b,12,s[9]),R=u(R,O,P,A,w,17,s[10]),A=u(A,R,O,P,S,22,s[11]),P=u(P,A,R,O,k,7,s[12]),O=u(O,P,A,R,C,12,s[13]),R=u(R,O,P,A,E,17,s[14]),P=l(P,A=u(A,R,O,P,T,22,s[15]),R,O,c,5,s[16]),O=l(O,P,A,R,g,9,s[17]),R=l(R,O,P,A,S,14,s[18]),A=l(A,R,O,P,a,20,s[19]),P=l(P,A,R,O,_,5,s[20]),O=l(O,P,A,R,w,9,s[21]),R=l(R,O,P,A,T,14,s[22]),A=l(A,R,O,P,m,20,s[23]),P=l(P,A,R,O,b,5,s[24]),O=l(O,P,A,R,E,9,s[25]),R=l(R,O,P,A,h,14,s[26]),A=l(A,R,O,P,y,20,s[27]),P=l(P,A,R,O,C,5,s[28]),O=l(O,P,A,R,f,9,s[29]),R=l(R,O,P,A,v,14,s[30]),P=d(P,A=l(A,R,O,P,k,20,s[31]),R,O,_,4,s[32]),O=d(O,P,A,R,y,11,s[33]),R=d(R,O,P,A,S,16,s[34]),A=d(A,R,O,P,E,23,s[35]),P=d(P,A,R,O,c,4,s[36]),O=d(O,P,A,R,m,11,s[37]),R=d(R,O,P,A,v,16,s[38]),A=d(A,R,O,P,w,23,s[39]),P=d(P,A,R,O,C,4,s[40]),O=d(O,P,A,R,a,11,s[41]),R=d(R,O,P,A,h,16,s[42]),A=d(A,R,O,P,g,23,s[43]),P=d(P,A,R,O,b,4,s[44]),O=d(O,P,A,R,k,11,s[45]),R=d(R,O,P,A,T,16,s[46]),P=p(P,A=d(A,R,O,P,f,23,s[47]),R,O,a,6,s[48]),O=p(O,P,A,R,v,10,s[49]),R=p(R,O,P,A,E,15,s[50]),A=p(A,R,O,P,_,21,s[51]),P=p(P,A,R,O,k,6,s[52]),O=p(O,P,A,R,h,10,s[53]),R=p(R,O,P,A,w,15,s[54]),A=p(A,R,O,P,c,21,s[55]),P=p(P,A,R,O,y,6,s[56]),O=p(O,P,A,R,T,10,s[57]),R=p(R,O,P,A,g,15,s[58]),A=p(A,R,O,P,C,21,s[59]),P=p(P,A,R,O,m,6,s[60]),O=p(O,P,A,R,S,10,s[61]),R=p(R,O,P,A,f,15,s[62]),A=p(A,R,O,P,b,21,s[63]),i[0]=i[0]+P|0,i[1]=i[1]+A|0,i[2]=i[2]+R|0,i[3]=i[3]+O|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;r[o>>>5]|=128<<24-o%32;var i=e.floor(n/4294967296),a=n;r[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),r[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(r.length+1),this._process();for(var s=this._hash,c=s.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,r,n,o,i,a){var s=e+(t&r|~t&n)+o+a;return(s<<i|s>>>32-i)+t}function l(e,t,r,n,o,i,a){var s=e+(t&n|r&~n)+o+a;return(s<<i|s>>>32-i)+t}function d(e,t,r,n,o,i,a){var s=e+(t^r^n)+o+a;return(s<<i|s>>>32-i)+t}function p(e,t,r,n,o,i,a){var s=e+(r^(t|~n))+o+a;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(c),t.HmacMD5=i._createHmacHelper(c)}(Math),n.MD5)},function(e,t,r){var n,o=r(124),i=r(44),a=r(126),s=r(127),c=r(128);"undefined"!=typeof ArrayBuffer&&(n=r(129));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),d=u||l;t.protocol=3;var p=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=o(p),h={type:"error",data:"parser error"},m=r(130);function _(e,t,r){for(var n=new Array(e.length),o=s(e.length,r),i=function(e,r,o){t(r,(function(t,r){n[e]=r,o(t,n)}))},a=0;a<e.length;a++)i(a,e[a],o)}t.encodePacket=function(e,r,n,o){"function"==typeof r&&(o=r,r=!1),"function"==typeof n&&(o=n,n=null);var i=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var o=e.data,i=new Uint8Array(o),a=new Uint8Array(1+o.byteLength);a[0]=p[e.type];for(var s=0;s<i.length;s++)a[s+1]=i[s];return n(a.buffer)}(e,r,o);if(void 0!==m&&i instanceof m)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);if(d)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},r,!0,n)},o.readAsArrayBuffer(e.data)}(e,r,n);var o=new Uint8Array(1);o[0]=p[e.type];var i=new m([o.buffer,e.data]);return n(i)}(e,r,o);if(i&&i.base64)return function(e,r){var n="b"+t.packets[e.type]+e.data.data;return r(n)}(e,o);var a=p[e.type];return void 0!==e.data&&(a+=n?c.encode(String(e.data),{strict:!1}):String(e.data)),o(""+a)},t.encodeBase64Packet=function(e,r){var n,o="b"+t.packets[e.type];if(void 0!==m&&e.data instanceof m){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];r(o+e)},i.readAsDataURL(e.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];n=String.fromCharCode.apply(null,s)}return o+=btoa(n),r(o)},t.decodePacket=function(e,r,n){if(void 0===e)return h;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),r);if(n&&!1===(e=function(e){try{e=c.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return h;var o=e.charAt(0);return Number(o)==o&&f[o]?e.length>1?{type:f[o],data:e.substring(1)}:{type:f[o]}:h}o=new Uint8Array(e)[0];var i=a(e,1);return m&&"blob"===r&&(i=new m([i])),{type:f[o],data:i}},t.decodeBase64Packet=function(e,t){var r=f[e.charAt(0)];if(!n)return{type:r,data:{base64:!0,data:e.substr(1)}};var o=n.decode(e.substr(1));return"blob"===t&&m&&(o=new m([o])),{type:r,data:o}},t.encodePayload=function(e,r,n){"function"==typeof r&&(n=r,r=null);var o=i(e);if(r&&o)return m&&!d?t.encodePayloadAsBlob(e,n):t.encodePayloadAsArrayBuffer(e,n);if(!e.length)return n("0:");_(e,(function(e,n){t.encodePacket(e,!!o&&r,!1,(function(e){n(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return n(t.join(""))}))},t.decodePayload=function(e,r,n){if("string"!=typeof e)return t.decodePayloadAsBinary(e,r,n);var o;if("function"==typeof r&&(n=r,r=null),""===e)return n(h,0,1);for(var i,a,s="",c=0,u=e.length;c<u;c++){var l=e.charAt(c);if(":"===l){if(""===s||s!=(i=Number(s)))return n(h,0,1);if(s!=(a=e.substr(c+1,i)).length)return n(h,0,1);if(a.length){if(o=t.decodePacket(a,r,!1),h.type===o.type&&h.data===o.data)return n(h,0,1);if(!1===n(o,c+i,u))return}c+=i,s=""}else s+=l}return""!==s?n(h,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,r){if(!e.length)return r(new ArrayBuffer(0));_(e,(function(e,r){t.encodePacket(e,!0,!0,(function(e){return r(null,e)}))}),(function(e,t){var n=t.reduce((function(e,t){var r;return e+(r="string"==typeof t?t.length:t.byteLength).toString().length+r+2}),0),o=new Uint8Array(n),i=0;return t.forEach((function(e){var t="string"==typeof e,r=e;if(t){for(var n=new Uint8Array(e.length),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);r=n.buffer}o[i++]=t?0:1;var s=r.byteLength.toString();for(a=0;a<s.length;a++)o[i++]=parseInt(s[a]);o[i++]=255;for(n=new Uint8Array(r),a=0;a<n.length;a++)o[i++]=n[a]})),r(o.buffer)}))},t.encodePayloadAsBlob=function(e,r){_(e,(function(e,r){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);e=n.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,m){var s=new m([t.buffer,a.buffer,e]);r(null,s)}}))}),(function(e,t){return r(new m(t))}))},t.decodePayloadAsBinary=function(e,r,n){"function"==typeof r&&(n=r,r=null);for(var o=e,i=[];o.byteLength>0;){for(var s=new Uint8Array(o),c=0===s[0],u="",l=1;255!==s[l];l++){if(u.length>310)return n(h,0,1);u+=s[l]}o=a(o,2+u.length),u=parseInt(u);var d=a(o,0,u);if(c)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var p=new Uint8Array(d);d="";for(l=0;l<p.length;l++)d+=String.fromCharCode(p[l])}i.push(d),o=a(o,u)}var f=i.length;i.forEach((function(e,o){n(t.decodePacket(e,r,!0),o,f)}))}},function(e,t,r){e.exports=r(92)},function(e,t,r){(function(n){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=r(114)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,r(21))},function(e,t,r){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r)for(var n=0,o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,r){var n,o,i,a,s,c;e.exports=(c=r(0),o=(n=c).lib,i=o.Base,a=o.WordArray,(s=n.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var o=e[n];r.push(o.high),r.push(o.low)}return a.create(r,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),r=t.length,n=0;n<r;n++)t[n]=t[n].clone();return e}}),c)},function(e,t,r){"use strict";var n,o,i,a=r(84),s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function c(){i=!1}function u(e){if(e){if(e!==n){if(e.length!==s.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,r){return t!==r.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. These characters were not unique: "+t.join(", "));n=e,c()}}else n!==s&&(n=s,c())}function l(){return i||(i=function(){n||u(s);for(var e,t=n.split(""),r=[],o=a.nextValue();t.length>0;)o=a.nextValue(),e=Math.floor(o*t.length),r.push(t.splice(e,1)[0]);return r.join("")}())}e.exports={get:function(){return n||s},characters:function(e){return u(e),n},seed:function(e){a.seed(e),o!==e&&(c(),o=e)},lookup:function(e){return l()[e]},shuffled:l}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){t.encode=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},t.decode=function(e){for(var t={},r=e.split("&"),n=0,o=r.length;n<o;n++){var i=r[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){(function(n){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=r(131)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,r(21))},function(e,t,r){var n,o,i,a,s,c,u,l;e.exports=(l=r(0),o=(n=l).lib,i=o.WordArray,a=o.Hasher,s=n.algo,c=[],u=s.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var l=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=l<<1|l>>>31}var d=(n<<5|n>>>27)+s+c[u];d+=u<20?1518500249+(o&i|~o&a):u<40?1859775393+(o^i^a):u<60?(o&i|o&a|i&a)-1894007588:(o^i^a)-899497514,s=a,a=i,i=o<<30|o>>>2,o=n,n=d}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+i|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=a._createHelper(u),n.HmacSHA1=a._createHmacHelper(u),l.SHA1)},function(e,t,r){var n,o,i,a;e.exports=(n=r(0),i=(o=n).lib.Base,a=o.enc.Utf8,void(o.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),s=o.words,c=i.words,u=0;u<r;u++)s[u]^=1549556828,c[u]^=909522486;o.sigBytes=i.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))},function(e,t,r){"use strict";(function(t){var n=r(3),o=r(95),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return("undefined"!=typeof XMLHttpRequest||void 0!==t)&&(e=r(31)),e}(),transformRequest:[function(e,t){return o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){s.headers[e]=n.merge(i)})),e.exports=s}).call(this,r(21))},function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],l=!1,d=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!l){var e=s(p);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new h(e,t)),1!==u.length||l||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,r){var n=r(10)("socket.io-parser"),o=r(115),i=r(116),a=r(39),s=r(40);function c(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=c,t.Decoder=d;var u=t.ERROR+'"encode error"';function l(e){var r=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(r+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(r+=e.nsp+","),null!=e.id&&(r+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return u;r+=o}return n("encoded %j as %s",e,r),r}function d(){this.reconstructor=null}function p(e){this.reconPack=e,this.buffers=[]}function f(e){return{type:t.ERROR,data:"parser error: "+e}}c.prototype.encode=function(e,r){(n("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){i.removeBlobs(e,(function(e){var r=i.deconstructPacket(e),n=l(r.packet),o=r.buffers;o.unshift(n),t(o)}))}(e,r):r([l(e)])},o(d.prototype),d.prototype.add=function(e){var r;if("string"==typeof e)r=function(e){var r=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return f("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var i="";"-"!==e.charAt(++r)&&(i+=e.charAt(r),r!=e.length););if(i!=Number(i)||"-"!==e.charAt(r))throw new Error("Illegal attachments");o.attachments=Number(i)}if("/"===e.charAt(r+1))for(o.nsp="";++r;){if(","===(c=e.charAt(r)))break;if(o.nsp+=c,r===e.length)break}else o.nsp="/";var s=e.charAt(r+1);if(""!==s&&Number(s)==s){for(o.id="";++r;){var c;if(null==(c=e.charAt(r))||Number(c)!=c){--r;break}if(o.id+=e.charAt(r),r===e.length)break}o.id=Number(o.id)}if(e.charAt(++r)){var u=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(r));if(!(!1!==u&&(o.type===t.ERROR||a(u))))return f("invalid payload");o.data=u}return n("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type?(this.reconstructor=new p(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(r=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",r))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,r){"use strict";(function(e){var n=r(117),o=r(118),i=r(119);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,r)}function u(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=p(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|h(t,r),o=(e=s(e,n)).write(t,r);o!==n&&(e=e.slice(0,o));return e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|f(t.length);return 0===(e=s(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):p(e,t);if("Buffer"===t.type&&i(t.data))return p(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=s(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function p(e,t){var r=t.length<0?0:0|f(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function f(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(n)return $(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function _(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,o){var i,a=1,s=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var l=-1;for(i=r;i<s;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(r+c>s&&(r=s-c),i=r;i>=0;i--){for(var d=!0,p=0;p<c;p++)if(u(e,i+p)!==u(t,p)){d=!1;break}if(d)return i}return-1}function y(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function b(e,t,r,n){return q($(t,e.length-r),e,r,n)}function w(e,t,r,n){return q(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return w(e,t,r,n)}function k(e,t,r,n){return q(N(t),e,r,n)}function C(e,t,r,n){return q(function(e,t){for(var r,n,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function E(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,a,s,c,u=e[o],l=null,d=u>239?4:u>223?3:u>191?2:1;if(o+d<=r)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(c=(15&u)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return u(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,n){return l(t),t<=0?s(e,t):void 0!==r?"string"==typeof n?s(e,t).fill(r,n):s(e,t).fill(r):s(e,t)}(null,e,t,r)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var a=e[r];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,o),o+=a.length}return n},c.byteLength=h,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,n,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(i,a),u=this.slice(n,o),l=e.slice(t,r),d=0;d<s;++d)if(u[d]!==l[d]){i=u[d],a=l[d];break}return i<a?-1:a<i?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return w(this,e,t,r);case"latin1":case"binary":return S(this,e,t,r);case"base64":return k(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function R(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=F(e[i]);return o}function O(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function x(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function D(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function I(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function U(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,n,i){return i||U(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function L(e,t,r,n,i){return i||U(e,0,r,8),o.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;r=new c(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},c.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);M(this,e,t,r,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);M(this,e,t,r,o-1,-o)}var i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,i=n-r;if(this===e&&r<t&&t<n)for(o=i-1;o>=0;--o)e[o+t]=this[o+r];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var a=c.isBuffer(e)?e:$(new c(e,n).toString()),s=a.length;for(i=0;i<r-t;++i)this[i+t]=a[i%s]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function $(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function N(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}}).call(this,r(14))},function(e,t,r){var n=r(122);e.exports=function(e){var t=e.xdomain,r=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||n))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!r&&o)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t,r){var n=r(8),o=r(11);function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=i,o(i.prototype),i.prototype.onError=function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,this.emit("error",r),this},i.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=n.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,r){e.exports=r(109)},function(e,t,r){"use strict";(function(e,n){var o,i=r(56);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var a=Object(i.a)(o);t.a=a}).call(this,r(14),r(137)(e))},function(e,t,r){var n;e.exports=(n=r(0),function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,o=0;o<64;)t(n)&&(o<8&&(s[o]=r(e.pow(n,.5))),c[o]=r(e.pow(n,1/3)),o++),n++}();var u=[],l=a.SHA256=i.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],l=r[5],d=r[6],p=r[7],f=0;f<64;f++){if(f<16)u[f]=0|e[t+f];else{var h=u[f-15],m=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,_=u[f-2],g=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;u[f]=m+u[f-7]+g+u[f-16]}var v=n&o^n&i^o&i,y=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),b=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+c[f]+u[f];p=d,d=l,l=s,s=a+b|0,a=i,i=o,o=n,n=b+(y+v)|0}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+i|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0,r[5]=r[5]+l|0,r[6]=r[6]+d|0,r[7]=r[7]+p|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;return r[o>>>5]|=128<<24-o%32,r[14+(o+64>>>9<<4)]=e.floor(n/4294967296),r[15+(o+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),n.SHA256)},function(e,t,r){var n;e.exports=(n=r(0),r(12),function(){var e=n,t=e.lib.Hasher,r=e.x64,o=r.Word,i=r.WordArray,a=e.algo;function s(){return o.create.apply(o,arguments)}var c=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=s()}();var l=a.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],l=r[5],d=r[6],p=r[7],f=n.high,h=n.low,m=o.high,_=o.low,g=i.high,v=i.low,y=a.high,b=a.low,w=s.high,S=s.low,k=l.high,C=l.low,E=d.high,T=d.low,P=p.high,A=p.low,R=f,O=h,x=m,M=_,D=g,I=v,U=y,B=b,L=w,j=S,F=k,$=C,N=E,q=T,G=P,V=A,W=0;W<80;W++){var H=u[W];if(W<16)var z=H.high=0|e[t+2*W],J=H.low=0|e[t+2*W+1];else{var Y=u[W-15],X=Y.high,K=Y.low,Q=(X>>>1|K<<31)^(X>>>8|K<<24)^X>>>7,Z=(K>>>1|X<<31)^(K>>>8|X<<24)^(K>>>7|X<<25),ee=u[W-2],te=ee.high,re=ee.low,ne=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,oe=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),ie=u[W-7],ae=ie.high,se=ie.low,ce=u[W-16],ue=ce.high,le=ce.low;z=(z=(z=Q+ae+((J=Z+se)>>>0<Z>>>0?1:0))+ne+((J+=oe)>>>0<oe>>>0?1:0))+ue+((J+=le)>>>0<le>>>0?1:0),H.high=z,H.low=J}var de,pe=L&F^~L&N,fe=j&$^~j&q,he=R&x^R&D^x&D,me=O&M^O&I^M&I,_e=(R>>>28|O<<4)^(R<<30|O>>>2)^(R<<25|O>>>7),ge=(O>>>28|R<<4)^(O<<30|R>>>2)^(O<<25|R>>>7),ve=(L>>>14|j<<18)^(L>>>18|j<<14)^(L<<23|j>>>9),ye=(j>>>14|L<<18)^(j>>>18|L<<14)^(j<<23|L>>>9),be=c[W],we=be.high,Se=be.low,ke=G+ve+((de=V+ye)>>>0<V>>>0?1:0),Ce=ge+me;G=N,V=q,N=F,q=$,F=L,$=j,L=U+(ke=(ke=(ke=ke+pe+((de+=fe)>>>0<fe>>>0?1:0))+we+((de+=Se)>>>0<Se>>>0?1:0))+z+((de+=J)>>>0<J>>>0?1:0))+((j=B+de|0)>>>0<B>>>0?1:0)|0,U=D,B=I,D=x,I=M,x=R,M=O,R=ke+(_e+he+(Ce>>>0<ge>>>0?1:0))+((O=de+Ce|0)>>>0<de>>>0?1:0)|0}h=n.low=h+O,n.high=f+R+(h>>>0<O>>>0?1:0),_=o.low=_+M,o.high=m+x+(_>>>0<M>>>0?1:0),v=i.low=v+I,i.high=g+D+(v>>>0<I>>>0?1:0),b=a.low=b+B,a.high=y+U+(b>>>0<B>>>0?1:0),S=s.low=S+j,s.high=w+L+(S>>>0<j>>>0?1:0),C=l.low=C+$,l.high=k+F+(C>>>0<$>>>0?1:0),T=d.low=T+q,d.high=E+N+(T>>>0<q>>>0?1:0),A=p.low=A+V,p.high=P+G+(A>>>0<V>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),n.SHA512)},function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){"use strict";var n=r(3),o=r(96),i=r(98),a=r(99),s=r(100),c=r(32);e.exports=function(e){return new Promise((function(t,u){var l=e.data,d=e.headers;n.isFormData(l)&&delete d["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",h=e.auth.password||"";d.Authorization="Basic "+btoa(f+":"+h)}if(p.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:e,request:p};o(t,u,n),p=null}},p.onerror=function(){u(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},n.isStandardBrowserEnv()){var m=r(101),_=(e.withCredentials||s(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;_&&(d[e.xsrfHeaderName]=_)}if("setRequestHeader"in p&&n.forEach(d,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)})),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),u(e),p=null)})),void 0===l&&(l=null),p.send(l)}))}},function(e,t,r){"use strict";var n=r(97);e.exports=function(e,t,r,o,i){var a=new Error(e);return n(a,t,r,o,i)}},function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,o=r;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},function(e,t){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),i=e.indexOf("]");-1!=o&&-1!=i&&(e=e.substring(0,o)+e.substring(o,i).replace(/:/g,";")+e.substring(i,e.length));for(var a=r.exec(e||""),s={},c=14;c--;)s[n[c]]=a[c]||"";return-1!=o&&-1!=i&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t){var r=1e3,n=6e4,o=60*n,i=24*o;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var s,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===c&&!1===isNaN(e))return t.long?a(s=e,i,"day")||a(s,o,"hour")||a(s,n,"minute")||a(s,r,"second")||s+" ms":function(e){if(e>=i)return Math.round(e/i)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){(function(t){e.exports=function(e){return r&&t.isBuffer(e)||n&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))};var r="function"==typeof t&&"function"==typeof t.isBuffer,n="function"==typeof ArrayBuffer}).call(this,r(23).Buffer)},function(e,t,r){var n=r(120),o=r(47),i=r(11),a=r(22),s=r(48),c=r(49),u=r(10)("socket.io-client:manager"),l=r(46),d=r(136),p=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=t.parser||a;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=f,f.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},i(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=n(this.uri,this.opts);var r=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var i=s(r,"open",(function(){o.onopen(),e&&e()})),a=s(r,"error",(function(t){if(u("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var c=this._timeout;u("connect attempt will timeout after %d",c);var l=setTimeout((function(){u("connect attempt timed out after %d",c),i.destroy(),r.close(),r.emit("error","timeout"),o.emitAll("connect_timeout",c)}),c);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(i),this.subs.push(a),this},f.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",c(this,"ondata"))),this.subs.push(s(e,"ping",c(this,"onping"))),this.subs.push(s(e,"pong",c(this,"onpong"))),this.subs.push(s(e,"error",c(this,"onerror"))),this.subs.push(s(e,"close",c(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",c(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var r=this.nsps[e];if(!r){r=new o(this,e,t),this.nsps[e]=r;var n=this;r.on("connecting",i),r.on("connect",(function(){r.id=n.generateId(e)})),this.autoConnect&&i()}function i(){~l(n.connecting,r)||n.connecting.push(r)}return r},f.prototype.destroy=function(e){var t=l(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},f.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(r){for(var n=0;n<r.length;n++)t.engine.write(r[n],e.options);t.encoding=!1,t.processPacketQueue()})))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},f.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var r=setTimeout((function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(r)}})}},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,r){var n=r(24),o=r(123),i=r(132),a=r(133);t.polling=function(e){var t=!1,r=!1,a=!1!==e.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,c=location.port;c||(c=s?443:80),t=e.hostname!==location.hostname||c!==e.port,r=e.secure!==s}if(e.xdomain=t,e.xscheme=r,"open"in new n(e)&&!e.forceJSONP)return new o(e);if(!a)throw new Error("JSONP disabled");return new i(e)},t.websocket=a},function(e,t,r){var n=r(25),o=r(15),i=r(8),a=r(16),s=r(45),c=r(17)("engine.io-client:polling");e.exports=l;var u=null!=new(r(24))({xdomain:!1}).responseType;function l(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),n.call(this,e)}a(l,n),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=function(e){var t=this;function r(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(c("we are currently polling - waiting to pause"),n++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--n||r()}))),this.writable||(c("we are currently writing - waiting to pause"),n++,this.once("drain",(function(){c("pre-pause writing complete"),--n||r()})))}else r()},l.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},l.prototype.onData=function(e){var t=this;c("polling got data %s",e);i.decodePayload(e,this.socket.binaryType,(function(e,r,n){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},l.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},l.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,r)}))},l.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(r=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e}},function(e,t,r){(function(t){var n=r(125),o=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(r){if(!r||"object"!=typeof r)return!1;if(n(r)){for(var o=0,s=r.length;o<s;o++)if(e(r[o]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(r)||"function"==typeof ArrayBuffer&&r instanceof ArrayBuffer||i&&r instanceof Blob||a&&r instanceof File)return!0;if(r.toJSON&&"function"==typeof r.toJSON&&1===arguments.length)return e(r.toJSON(),!0);for(var c in r)if(Object.prototype.hasOwnProperty.call(r,c)&&e(r[c]))return!0;return!1}}).call(this,r(23).Buffer)},function(e,t,r){"use strict";var n,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i={},a=0,s=0;function c(e){var t="";do{t=o[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function u(){var e=c(+new Date);return e!==n?(a=0,n=e):e+"."+c(a++)}for(;s<64;s++)i[o[s]]=s;u.encode=c,u.decode=function(e){var t=0;for(s=0;s<e.length;s++)t=64*t+i[e.charAt(s)];return t},e.exports=u},function(e,t){var r=[].indexOf;e.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t,r){var n=r(22),o=r(11),i=r(135),a=r(48),s=r(49),c=r(10)("socket.io-client:socket"),u=r(15),l=r(44);e.exports=f;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=o.prototype.emit;function f(e,t,r){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}o(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(d.hasOwnProperty(e))return p.apply(this,arguments),this;var t=i(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:l(t))?n.BINARY_EVENT:n.EVENT,data:t,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?u.encode(this.query):this.query;c("sending connect packet with query %s",e),this.packet({type:n.CONNECT,query:e})}else this.packet({type:n.CONNECT})},f.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,r=e.type===n.ERROR&&"/"===e.nsp;if(t||r)switch(e.type){case n.CONNECT:this.onconnect();break;case n.EVENT:case n.BINARY_EVENT:this.onevent(e);break;case n.ACK:case n.BINARY_ACK:this.onack(e);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,r=!1;return function(){if(!r){r=!0;var o=i(arguments);c("sending ack %j",o),t.packet({type:l(o)?n.BINARY_ACK:n.ACK,id:e,data:o})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}},function(e,t){var r=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},function(e,t,r){"use strict";e.exports=r(83)},function(e,t,r){(function(r){var n;function o(e){if(!e)throw"MediaStream is mandatory.";var t;this.start=function(r){var n;"undefined"!=typeof MediaRecorder?n=g:(d||l||u)&&(-1!==this.mimeType.indexOf("video")?n=b:-1!==this.mimeType.indexOf("audio")&&(n=v)),"image/gif"===this.mimeType&&(n=S),"audio/wav"!==this.mimeType&&"audio/pcm"!==this.mimeType||(n=v),this.recorderType&&(n=this.recorderType),(t=new n(e)).blobs=[];var o=this;t.ondataavailable=function(e){t.blobs.push(e),o.ondataavailable(e)},t.onstop=this.onstop,t.onStartedDrawingNonBlankFrames=this.onStartedDrawingNonBlankFrames,(t=function(e,t){for(var r in t)"function"!=typeof t[r]&&(e[r]=t[r]);return e}(t,this)).start(r)},this.onStartedDrawingNonBlankFrames=function(){},this.clearOldRecordedFrames=function(){t&&t.clearOldRecordedFrames()},this.stop=function(){t&&t.stop()},this.ondataavailable=function(e){console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.save=function(e,r){if(e)f(e,r);else{if(!t)return;ConcatenateBlobs(t.blobs,t.blobs[0].type,(function(e){f(e)}))}},this.pause=function(){t&&(t.pause(),console.log("Paused recording.",this.mimeType||t.mimeType))},this.resume=function(){t&&(t.resume(),console.log("Resumed recording.",this.mimeType||t.mimeType))},this.recorderType=null,this.mimeType="video/webm",this.disableLogs=!1}void 0!==o&&(o.MultiStreamRecorder=function(e){if(!e)throw"MediaStream is mandatory.";var t,r,n=this,i=_();this.stream=e,this.start=function(c){for(var u in t=new o(e),r=new o(e),t.mimeType="audio/ogg",r.mimeType="video/webm",this)"function"!=typeof this[u]&&(t[u]=r[u]=this[u]);function l(e){s++,n.ondataavailable(e)}t.ondataavailable=function(e){a[s]||(a[s]={}),a[s].audio=e,a[s].video&&!a[s].onDataAvailableEventFired&&(a[s].onDataAvailableEventFired=!0,l(a[s]))},r.ondataavailable=function(e){if(i)return n.ondataavailable({video:e,audio:e});a[s]||(a[s]={}),a[s].video=e,a[s].audio&&!a[s].onDataAvailableEventFired&&(a[s].onDataAvailableEventFired=!0,l(a[s]))},r.onstop=t.onstop=function(e){n.onstop(e)},i||(r.onStartedDrawingNonBlankFrames=function(){r.clearOldRecordedFrames(),t.start(c)}),r.start(c)},this.stop=function(){t&&t.stop(),r&&r.stop()},this.ondataavailable=function(e){console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.pause=function(){t&&t.pause(),r&&r.pause()},this.resume=function(){t&&t.resume(),r&&r.resume()};var a={},s=0});var i,a,s="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";i=void 0!==r?r:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==r&&(r.navigator={userAgent:s,getUserMedia:function(){}},i.window=r),"undefined"==typeof document&&(i.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){return{}}),"undefined"==typeof location&&(i.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(i.screen={width:0,height:0})),void 0===(a=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(a=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(a=mozAudioContext)),"undefined"==typeof window&&(window={}),void 0===(a=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(a=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(a=mozAudioContext));var c=window.URL;void 0===c&&"undefined"!=typeof webkitURL&&(c=webkitURL),"undefined"!=typeof navigator?(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia)):navigator={getUserMedia:function(){},userAgent:s};var u=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),l=!1;"undefined"!=typeof opera&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("OPR/")&&(l=!0);var d=!u&&!u&&!!navigator.webkitGetUserMedia,p=window.MediaStream;function f(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(e){}var r=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var n=t.split(".");t=n[0],r=n[1]}var o=(t||Math.round(9999999999*Math.random())+888888888)+"."+r;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,o);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,o);var i=document.createElement("a");i.href=c.createObjectURL(e),i.target="_blank",i.download=o,navigator.mozGetUserMedia&&(i.onclick=function(){(document.body||document.documentElement).removeChild(i)},(document.body||document.documentElement).appendChild(i));var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(a),navigator.mozGetUserMedia||c.revokeObjectURL(i.href)}function h(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}void 0===p&&"undefined"!=typeof webkitMediaStream&&(p=webkitMediaStream),void 0!==p&&("getVideoTracks"in p.prototype||(p.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach((function(t){-1!==t.kind.toString().indexOf("video")&&e.push(t)})),e},p.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach((function(t){-1!==t.kind.toString().indexOf("audio")&&e.push(t)})),e}),"stop"in p.prototype||(p.prototype.stop=function(){this.getAudioTracks().forEach((function(e){e.stop&&e.stop()})),this.getVideoTracks().forEach((function(e){e.stop&&e.stop()}))})),"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var m={AudioContext:a};function _(){var e=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=!!window.chrome&&!e;if(void 0!==window.InstallTrigger)return!0;if(!t)return!1;navigator.appVersion;var r,n,o=navigator.userAgent,i=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10);return t&&(r=o.indexOf("Chrome"),i=o.substring(r+7)),-1!==(n=i.indexOf(";"))&&(i=i.substring(0,n)),-1!==(n=i.indexOf(" "))&&(i=i.substring(0,n)),a=parseInt(""+i,10),isNaN(a)&&(i=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10)),a>=49}m={AudioContext:window.AudioContext||window.webkitAudioContext};function g(e){var t,r=this;this.start=function(n,o){var i;(r.mimeType||(r.mimeType="video/webm"),-1!==r.mimeType.indexOf("audio"))&&(e.getVideoTracks().length&&e.getAudioTracks().length&&(navigator.mozGetUserMedia?(i=new p).addTrack(e.getAudioTracks()[0]):i=new p(e.getAudioTracks()),e=i));-1!==r.mimeType.indexOf("audio")&&(r.mimeType=d?"audio/webm":"audio/ogg"),r.dontFireOnDataAvailableEvent=!1;var a={mimeType:r.mimeType};r.disableLogs||o||console.log("Passing following params over MediaRecorder API.",a),t&&(t=null),d&&!_()&&(a="video/vp8");try{t=new MediaRecorder(e,a)}catch(r){t=new MediaRecorder(e)}"canRecordMimeType"in t&&!1===t.canRecordMimeType(r.mimeType)&&(r.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",r.mimeType)),t.ignoreMutedMedia=r.ignoreMutedMedia||!1;var s=!1;t.ondataavailable=function(e){if(!r.dontFireOnDataAvailableEvent&&e.data&&e.data.size&&!(e.data.size<26800)&&!s){s=!0;var o=r.getNativeBlob?e.data:new Blob([e.data],{type:r.mimeType||"video/webm"});r.ondataavailable(o),r.dontFireOnDataAvailableEvent=!0,t&&(t.stop(),t=null),r.start(n,"__disableLogs")}},t.onerror=function(e){r.disableLogs||("InvalidState"===e.name?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed."):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute."):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute."):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute."):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),t&&"inactive"!==t.state&&"stopped"!==t.state&&t.stop()};try{t.start(36e5)}catch(e){t=null}setTimeout((function(){t&&"recording"===t.state&&t.requestData()}),n)},this.stop=function(e){t&&"recording"===t.state&&(t.requestData(),setTimeout((function(){r.dontFireOnDataAvailableEvent=!0,t&&"recording"===t.state&&t.stop(),t=null}),2e3))},this.pause=function(){t&&"recording"===t.state&&t.pause()},this.ondataavailable=function(e){console.log("recorded-blob",e)},this.resume=function(){if(this.dontFireOnDataAvailableEvent){this.dontFireOnDataAvailableEvent=!1;var e=r.disableLogs;return r.disableLogs=!0,this.record(),void(r.disableLogs=e)}t&&"paused"===t.state&&t.resume()},this.clearRecordedData=function(){t&&(this.pause(),this.dontFireOnDataAvailableEvent=!0,this.stop())},function n(){t&&(!1!==function(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}()?setTimeout(n,1e3):r.stop())}()}function v(e){var t,r;this.start=function(n){n=n||1e3,(t=new y(e,this)).record(),r=setInterval((function(){t.requestData()}),n)},this.stop=function(){t&&(t.stop(),clearTimeout(r))},this.pause=function(){t&&t.pause()},this.resume=function(){t&&t.resume()},this.ondataavailable=function(){}}function y(e,t){var r;m.AudioContextConstructor||(m.AudioContextConstructor=new m.AudioContext),r=m.AudioContextConstructor.sampleRate;var n,o=[],i=[],a=!1,s=0,c=t.sampleRate||r,u=(t.mimeType||"audio/wav").indexOf("audio/pcm")>-1,l=t.audioChannels||2;function d(e,t){for(var r=new Float32Array(t),n=0,o=e.length,i=0;i<o;i++){var a=e[i];r.set(a,n),n+=a.length}return r}function p(e,t,r){for(var n=r.length,o=0;o<n;o++)e.setUint8(t+o,r.charCodeAt(o))}function f(e){for(var t=e.length,r=new Int16Array(t);t--;)r[t]=65535*e[t];return r.buffer}this.record=function(){a=!0,o.length=i.length=0,s=0},this.requestData=function(){if(!w)if(0!==s){b=!0;var e=o.slice(0),r=i.slice(0),n=s;o.length=i.length=[],s=0,b=!1;var a=d(e,n),m=a;if(2===l)m=function(e,t){for(var r=e.length+t.length,n=new Float32Array(r),o=0,i=0;i<r;)n[i++]=e[o],n[i++]=t[o],o++;return n}(a,d(r,n));if(u){var _=new Blob([f(m)],{type:"audio/pcm"});return console.debug("audio recorded blob size:",h(_.size)),void t.ondataavailable(_)}var g=new ArrayBuffer(44+2*m.length),v=new DataView(g);p(v,0,"RIFF"),v.setUint32(4,44+2*m.length-8,!0),p(v,8,"WAVE"),p(v,12,"fmt "),v.setUint32(16,16,!0),v.setUint16(20,1,!0),v.setUint16(22,l,!0),v.setUint32(24,c,!0),v.setUint32(28,c*l*2,!0),v.setUint16(32,2*l,!0),v.setUint16(34,16,!0),p(v,36,"data"),v.setUint32(40,2*m.length,!0);for(var y=m.length,S=44,k=0;k<y;k++)v.setInt16(S,32767*m[k],!0),S+=2;_=new Blob([v],{type:"audio/wav"});console.debug("audio recorded blob size:",h(_.size)),t.ondataavailable(_)}else b=!1},this.stop=function(){a=!1,this.requestData(),g.disconnect()};var _=m.AudioContextConstructor;m.VolumeGainNode=_.createGain();var g,v=m.VolumeGainNode;m.AudioInput=_.createMediaStreamSource(e),(g=m.AudioInput).connect(v);var y=t.bufferSize||2048;if(0===t.bufferSize&&(y=0),_.createJavaScriptNode)n=_.createJavaScriptNode(y,l,l);else{if(!_.createScriptProcessor)throw"WebAudio API has no support on this browser.";n=_.createScriptProcessor(y,l,l)}y=n.bufferSize,console.debug("using audio buffer-size:",y);var b=!1;window.scriptprocessornode=n,1===l&&console.debug("All right-channels are skipped.");var w=!1;this.pause=function(){w=!0},this.resume=function(){w=!1},n.onaudioprocess=function(e){if(a&&!b&&!w){var t=e.inputBuffer.getChannelData(0);if(o.push(new Float32Array(t)),2===l){var r=e.inputBuffer.getChannelData(1);i.push(new Float32Array(r))}s+=y}},v.connect(n),n.connect(_.destination)}function b(e){var t,r;this.start=function(n){for(var o in n=n||1e3,t=new w(e,this),this)"function"!=typeof this[o]&&(t[o]=this[o]);t.record(),r=setInterval((function(){t.requestData()}),n)},this.stop=function(){t&&(t.stop(),clearTimeout(r))},this.clearOldRecordedFrames=function(){t&&t.clearOldRecordedFrames()},this.pause=function(){t&&t.pause()},this.resume=function(){t&&t.resume()},this.ondataavailable=function(){}}function w(e,t){this.record=function(r){this.width||(this.width=320),this.height||(this.height=240),this.video&&this.video instanceof HTMLVideoElement&&(this.width||(this.width=a.videoWidth||a.clientWidth||320),this.height||(this.height=a.videoHeight||a.clientHeight||240)),this.video||(this.video={width:this.width,height:this.height}),this.canvas&&this.canvas.width&&this.canvas.height||(this.canvas={width:this.width,height:this.height}),l.width=this.canvas.width,l.height=this.canvas.height,this.video&&this.video instanceof HTMLVideoElement?(this.isHTMLObject=!0,a=this.video.cloneNode()):((a=document.createElement("video")).src=c.createObjectURL(e),a.width=this.video.width,a.height=this.video.height),a.muted=!0,a.play(),s=(new Date).getTime(),u=new k.Video(t.speed,t.quality),console.log("canvas resolutions",l.width,"*",l.height),console.log("video width/height",a.width||l.width,"*",a.height||l.height),o()},this.clearOldRecordedFrames=function(){u.frames=[]};var r=!1;this.requestData=function(){if(!f)if(u.frames.length){r=!0;var e=u.frames.slice(0);u.frames=function(e,t,r,n){var o=document.createElement("canvas");o.width=l.width,o.height=l.height;for(var i=o.getContext("2d"),a=[],s=-1===t,c=t&&t>0&&t<=e.length?t:e.length,u={r:0,g:0,b:0},d=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),p=r&&r>=0&&r<=1?r:0,f=n&&n>=0&&n<=1?n:0,h=!1,m=0;m<c;m++){var _,g,v;if(!h){var y=new Image;y.src=e[m].image,i.drawImage(y,0,0,l.width,l.height);var b=i.getImageData(0,0,l.width,l.height);_=0,g=b.data.length,v=b.data.length/4;for(var w=0;w<g;w+=4){var S={r:b.data[w],g:b.data[w+1],b:b.data[w+2]};Math.sqrt(Math.pow(S.r-u.r,2)+Math.pow(S.g-u.g,2)+Math.pow(S.b-u.b,2))<=d*p&&_++}}!h&&v-_<=v*f||(s&&(h=!0),a.push(e[m]))}(a=a.concat(e.slice(c))).length<=0&&a.push(e[e.length-1]);return a}(e,-1),u.compile((function(e){t.ondataavailable(e),console.debug("video recorded blob size:",h(e.size))})),u.frames=[],r=!1}else r=!1};var n=!1;function o(){if(f)return s=(new Date).getTime(),void setTimeout(o,500);if(!i){if(r)return setTimeout(o,100);var e=(new Date).getTime()-s;if(!e)return o();s=(new Date).getTime(),!p.isHTMLObject&&a.paused&&a.play(),d.drawImage(a,0,0,l.width,l.height),i||u.frames.push({duration:e,image:l.toDataURL("image/webp")}),n||function(e,t,r){var n=document.createElement("canvas");n.width=l.width,n.height=l.height;var o,i,a,s=n.getContext("2d"),c={r:0,g:0,b:0},u=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),d=t&&t>=0&&t<=1?t:0,p=r&&r>=0&&r<=1?r:0,f=new Image;f.src=e.image,s.drawImage(f,0,0,l.width,l.height);var h=s.getImageData(0,0,l.width,l.height);o=0,i=h.data.length,a=h.data.length/4;for(var m=0;m<i;m+=4){var _={r:h.data[m],g:h.data[m+1],b:h.data[m+2]};Math.sqrt(Math.pow(_.r-c.r,2)+Math.pow(_.g-c.g,2)+Math.pow(_.b-c.b,2))<=u*d&&o++}return!(a-o<=a*p)}(u.frames[u.frames.length-1])||(n=!0,t.onStartedDrawingNonBlankFrames()),setTimeout(o,10)}}var i=!1;this.stop=function(){i=!0,this.requestData()};var a,s,u,l=document.createElement("canvas"),d=l.getContext("2d"),p=this;var f=!1;this.pause=function(){f=!0},this.resume=function(){f=!1}}function S(e){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";function t(){Date.now();var e=new Blob([new Uint8Array(u.stream().bin)],{type:"image/gif"});n.ondataavailable(e),u.stream().bin=[]}this.start=function(e){e=e||1e3;var n=this.videoWidth||320,c=this.videoHeight||240;o.width=a.width=n,o.height=a.height=c,(u=new GIFEncoder).setRepeat(0),u.setDelay(this.frameRate||this.speed||200),u.setQuality(this.quality||1),u.start(),Date.now(),d=requestAnimationFrame((function e(t){r?setTimeout(e,500,t):(d=requestAnimationFrame(e),void 0===typeof s&&(s=t),t-s<90||(a.paused&&a.play(),i.drawImage(a,0,0,n,c),u.addFrame(i),s=t))})),l=setTimeout(t,e)},this.stop=function(){d&&(cancelAnimationFrame(d),clearTimeout(l),t())};var r=!1;this.pause=function(){r=!0},this.resume=function(){r=!1},this.ondataavailable=function(){},this.onstop=function(){};var n=this,o=document.createElement("canvas"),i=o.getContext("2d"),a=document.createElement("video");a.muted=!0,a.autoplay=!0,a.src=c.createObjectURL(e),a.play();var s,u,l,d=null}void 0!==o&&(o.MediaRecorderWrapper=g),void 0!==o&&(o.StereoAudioRecorder=v),void 0!==o&&(o.StereoAudioRecorderHelper=y),void 0!==o&&(o.WhammyRecorder=b),void 0!==o&&(o.WhammyRecorderHelper=w),void 0!==o&&(o.GifRecorder=S);var k=function(){function e(e,t){this.frames=[],e||(e=1),this.duration=1e3/e,this.quality=t||.8}function t(e){function t(e,t,r){return[{data:e,id:231}].concat(r.map((function(e){var r=function(e){var t=0;e.keyframe&&(t|=128);e.invisible&&(t|=8);e.lacing&&(t|=e.lacing<<1);e.discardable&&(t|=1);if(e.trackNum>127)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:r,id:163}})))}function r(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function n(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var r=0;r<e.length;r+=8)t.push(parseInt(e.substr(r,8),2));return new Uint8Array(t)}function o(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}var i=new function(e){var o=function(e){if(!e[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var t=e[0].width,r=e[0].height,n=e[0].duration,o=1;o<e.length;o++)n+=e[o].duration;return{duration:n,width:t,height:r}}(e);if(!o)return[];for(var i,a=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(i=o.duration,[].slice.call(new Uint8Array(new Float64Array([i]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:o.width,id:176},{data:o.height,id:186}]}]}]}]}],s=0,c=0;s<e.length;){var u=[],l=0;do{u.push(e[s]),l+=e[s].duration,s++}while(s<e.length&&l<3e4);var d={id:524531317,data:t(c,0,u)};a[1].data.push(d),c+=l}return function e(t){for(var o=[],i=0;i<t.length;i++){var a=t[i].data;"object"==typeof a&&(a=e(a)),"number"==typeof a&&(a=n(a.toString(2))),"string"==typeof a&&(a=new Uint8Array(a.split("").map((function(e){return e.charCodeAt(0)}))));var s=a.size||a.byteLength||a.length,c=Math.ceil(Math.ceil(Math.log(s)/Math.log(2))/8),u=s.toString(2),l=new Array(7*c+7+1-u.length).join("0")+u,d=new Array(c).join("0")+"1"+l;o.push(r(t[i].id)),o.push(n(d)),o.push(a)}return new Blob(o,{type:"video/webm"})}(a)}(e.map((function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],r=t.indexOf("*"),n=0,o=[];n<4;n++)o[n]=t.charCodeAt(r+3+n);return{width:16383&(o[1]<<8|o[0]),height:16383&(o[3]<<8|o[2]),data:t,riff:e}}(function e(t){for(var r=0,n={};r<t.length;){var i=t.substr(r,4),a=o(t,r),s=t.substr(r+4+4,a);r+=8+a,n[i]=n[i]||[],"RIFF"===i||"LIST"===i?n[i].push(e(s)):n[i].push(s)}return n}(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(i)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var r,n,o,i=(r=t,n=c.createObjectURL(new Blob([r.toString(),"this.onmessage =  function (e) {"+r.name+"(e.data);}"],{type:"application/javascript"})),o=new Worker(n),c.revokeObjectURL(n),o);i.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},i.postMessage(this.frames)},{Video:e}}();void 0!==o&&(o.Whammy=k),window.ConcatenateBlobs=function(e,t,r){var n=[],o=0;!function i(){if(!e[o])return function(){var e=0;n.forEach((function(t){e+=t.byteLength}));var o=new Uint16Array(e),i=0;n.forEach((function(e){var t=e.byteLength;t%2!=0&&(e=e.slice(0,t-1)),o.set(new Uint16Array(e),i),i+=t}));var a=new Blob([o.buffer],{type:t});r(a)}();var a=new FileReader;a.onload=function(e){n.push(e.target.result),o++,i()},a.readAsArrayBuffer(e[o])}()},e.exports=o,void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}).call(this,r(14))},function(e,t,r){parcelRequire=function(t,n,o,i){var a,s="function"==typeof parcelRequire&&parcelRequire;function c(e,o){if(!n[e]){if(!t[e]){var i="function"==typeof parcelRequire&&parcelRequire;if(!o&&i)return i(e,!0);if(s)return s(e,!0);if("string"==typeof e)return r(110)(e);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}l.resolve=function(r){return t[e][1][r]||r},l.cache={};var u=n[e]=new c.Module(e);t[e][0].call(u.exports,l,u,u.exports,this)}return n[e].exports;function l(e){return c(l.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=n,c.parent=s,c.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]};for(var u=0;u<o.length;u++)try{c(o[u])}catch(t){a||(a=t)}if(o.length){var l=c(o[o.length-1]);e.exports=l}if(parcelRequire=c,a)throw a;return c}({EgBh:[function(e,t,r){var n={};n.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),n.useArrayBufferView=!n.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=n;var o=t.exports.BlobBuilder;function i(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(o=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),i.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},i.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);n.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},i.prototype.getBuffer=function(){if(this.flush(),n.useBlobBuilder){for(var e=new o,t=0,r=this._parts.length;t<r;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=i},{}],kdPp:[function(e,t,r){var n=e("./bufferbuilder").BufferBuilder,o=e("./bufferbuilder").binaryFeatures,i={unpack:function(e){return new a(e).unpack()},pack:function(e){var t=new s;return t.pack(e),t.getBuffer()}};function a(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function s(){this.bufferBuilder=new n}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=i,a.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},a.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},a.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},a.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},a.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},a.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},a.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},a.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},a.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},a.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},a.prototype.unpack_string=function(e){for(var t,r,n=this.read(e),o=0,i="";o<e;)(t=n[o])<128?(i+=String.fromCharCode(t),o++):(192^t)<32?(r=(192^t)<<6|63&n[o+1],i+=String.fromCharCode(r),o+=2):(r=(15&t)<<12|(63&n[o+1])<<6|63&n[o+2],i+=String.fromCharCode(r),o+=3);return this.index+=e,i},a.prototype.unpack_array=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=this.unpack();return t},a.prototype.unpack_map=function(e){for(var t={},r=0;r<e;r++){var n=this.unpack(),o=this.unpack();t[n]=o}return t},a.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},a.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),r=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,r-20)+t*Math.pow(2,r-52))},a.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},s.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},s.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var r=e.constructor;if(r==Array)this.pack_array(e);else if(r==Blob||r==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(r==ArrayBuffer)o.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)o.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(r==Object||r.toString().startsWith("class"))this.pack_object(e);else if(r==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+r.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},s.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var r=0;r<t;r++)this.pack(e[r])},s.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},s.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var r=Math.floor(Math.log(e)/Math.LN2),n=e/Math.pow(2,r)-1,o=Math.floor(n*Math.pow(2,52)),i=Math.pow(2,32),a=t<<31|r+1023<<20|o/i&1048575,s=o%i;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(s)},s.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var r in e)e.hasOwnProperty(r)&&(this.pack(r),this.pack(e[r]))},s.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},s.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},s.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),r=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&r)>>>24),this.bufferBuilder.append((16711680&r)>>>16),this.bufferBuilder.append((65280&r)>>>8),this.bufferBuilder.append(255&r)},s.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},s.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),r=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&r)>>>24),this.bufferBuilder.append((16711680&r)>>>16),this.bufferBuilder.append((65280&r)>>>8),this.bufferBuilder.append(255&r)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.extractVersion=a,r.wrapPeerConnectionEvent=function(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,o=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return o.apply(this,arguments);var i=function(e){var t=r(e);t&&n(t)};return this._eventMap=this._eventMap||{},this._eventMap[n]=i,o.apply(this,[e,i])};var i=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return i.apply(this,arguments);var n=this._eventMap[r];return delete this._eventMap[r],i.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},r.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+n(e)+". Please use a boolean."):(o=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},r.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+n(e)+". Please use a boolean."):(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},r.log=function(){if("object"===("undefined"==typeof window?"undefined":n(window))){if(o)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},r.deprecated=function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},r.detectBrowser=function(e){var{navigator:t}=e,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return r},r.compactObject=function e(t){return s(t)?Object.keys(t).reduce((function(r,n){var o=s(t[n]),i=o?e(t[n]):t[n],a=o&&!Object.keys(i).length;return void 0===i||a?r:Object.assign(r,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},n,i))}),{}):t},r.walkStats=c,r.filterStats=function(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var i=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)})),i.forEach((function(t){e.forEach((function(r){r.type===n&&r.trackId===t.id&&c(e,r,o)}))})),o};var o=!0,i=!0;function a(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?c(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((function(t){c(e,e.get(t),r)}))})))}},{}],s6SN:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var r=n.detectBrowser(e),o=function(e){if("object"!==i(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"===i(e[r])?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var a={};"number"==typeof n.ideal?(a[o("min",r)]=n.ideal,t.optional.push(a),(a={})[o("max",r)]=n.ideal,t.optional.push(a)):(a[o("",r)]=n.ideal,t.optional.push(a))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",r)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,n){if(r.version>=61)return n(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var s=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=o(e.audio)}if(e&&"object"===i(e.video)){var c=e.video.facingMode;c=c&&("object"===i(c)?c:{ideal:c});var u,l=r.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)&&(delete e.video.facingMode,"environment"===c.exact||"environment"===c.ideal?u=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(u=["front"]),u))return t.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return u.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&u.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=c.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=o(e.video),a("chrome: "+JSON.stringify(e)),n(e)}));e.video=o(e.video)}return a("chrome: "+JSON.stringify(e)),n(e)},c=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,n){s(e,(function(e){t.webkitGetUserMedia(e,r,(function(e){n&&n(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return u(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(e("../utils.js"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=n.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var n=r.video&&r.video.width,o=r.video&&r.video.height,i=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:i||3}},n&&(r.video.mandatory.maxWidth=n),o&&(r.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(e){if("object"!==c(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)n.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var o;o=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track};var i=new Event("track");i.track=n.track,i.receiver=o,i.transceiver={receiver:o},i.streams=[t.stream],r.dispatchEvent(i)})),t.stream.getTracks().forEach((function(n){var o;o=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n};var i=new Event("track");i.track=n,i.receiver=o,i.transceiver={receiver:o},i.streams=[t.stream],r.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},r.shimGetSendersWithDtmf=function(e){if("object"===c(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var o=r.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===c(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[r,n,o]=arguments;if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var i=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){n(a(i(e)))},r]):new Promise((function(r,n){t.apply(e,[function(e){r(a(i(e)))},n])})).then(n,o)}}},r.shimSenderReceiverGetStats=function(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return n.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var o=e.RTCPeerConnection.prototype.getReceivers;o&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=o.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),n.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return n.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,o=arguments[0];return this.getSenders().forEach((function(e){e.track===o&&(t?n=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===o&&(r?n=!0:r=e),e.track===o})),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}},r.shimAddTrackRemoveTrackWithNative=u,r.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=n.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return u(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}o.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[r.id];if(i)i.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[r.id]=a,this._reverseStreams[a.id]=r,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=s({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){var n=l(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(t){return l(e,t)}))}));e.RTCPeerConnection.prototype[t]=n[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,r=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],o=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:r})),a.apply(this,arguments)):a.apply(this,arguments);var e,t,r};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(n){r._streams[n].getTracks().find((function(t){return e.track===t}))&&(t=r._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],o=e._streams[n.id];r=r.replace(new RegExp(o.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}},r.shimPeerConnection=function(e){var t=n.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=s({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}));var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},r.fixNegotiationNeeded=function(e){n.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}}),Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}});var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(e("../utils.js")),o=e("./getusermedia"),i=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();r.apply(this,arguments);var o=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(o)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),o.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&n.deprecated("RTCIceServer.url","RTCIceServer.urls");var o="string"==typeof t;return o&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!r?(r=!0,!0):t&&!r})),delete e.url,e.urls=o?t[0]:t,!!t.length}}))};var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,r){"use strict";var n={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};n.localCName=n.generateIdentifier(),n.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},n.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},n.getDescription=function(e){var t=n.splitSections(e);return t&&t[0]},n.getMediaSections=function(e){var t=n.splitSections(e);return t.shift(),t},n.matchPrefix=function(e,t){return n.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},n.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},n.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},n.parseIceOptions=function(e){return e.substr(14).split(" ")},n.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},n.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},n.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},n.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<n.length;o++)r[(t=n[o].trim().split("="))[0].trim()]=t[1];return r},n.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},n.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},n.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},n.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},n.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},n.getMid=function(e){var t=n.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},n.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},n.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:n.matchPrefix(e+t,"a=fingerprint:").map(n.parseFingerprint)}},n.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},n.getIceParameters=function(e,t){var r=n.splitLines(e);return{usernameFragment:(r=r.concat(n.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:r.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},n.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=n.splitLines(e)[0].split(" "),o=3;o<r.length;o++){var i=r[o],a=n.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){var s=n.parseRtpMap(a),c=n.matchPrefix(e,"a=fmtp:"+i+" ");switch(s.parameters=c.length?n.parseFmtp(c[0]):{},s.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(n.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return n.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(n.parseExtmap(e))})),t},n.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){r+=n.writeRtpMap(e),r+=n.writeFmtp(e),r+=n.writeRtcpFb(e)}));var o=0;return t.codecs.forEach((function(e){e.maxptime>o&&(o=e.maxptime)})),o>0&&(r+="a=maxptime:"+o+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){r+=n.writeExtmap(e)})),r},n.parseRtpEncodingParameters=function(e){var t,r=[],o=n.parseRtpParameters(e),i=-1!==o.fecMechanisms.indexOf("RED"),a=-1!==o.fecMechanisms.indexOf("ULPFEC"),s=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=n.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),o.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(n.rtx={ssrc:t}),r.push(n),i&&((n=JSON.parse(JSON.stringify(n))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},r.push(n))}})),0===r.length&&c&&r.push({ssrc:c});var l=n.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=l}))),r},n.parseRtcpParameters=function(e){var t={},r=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var o=n.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=o.length>0,t.compound=0===o.length;var i=n.matchPrefix(e,"a=rtcp-mux");return t.mux=i.length>0,t},n.parseMsid=function(e){var t,r=n.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var o=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return o.length>0?{stream:(t=o[0].value.split(" "))[0],track:t[1]}:void 0},n.parseSctpDescription=function(e){var t,r=n.parseMLine(e),o=n.matchPrefix(e,"a=max-message-size:");o.length>0&&(t=parseInt(o[0].substr(19),10)),isNaN(t)&&(t=65536);var i=n.matchPrefix(e,"a=sctp-port:");if(i.length>0)return{port:parseInt(i[0].substr(12),10),protocol:r.fmt,maxMessageSize:t};if(n.matchPrefix(e,"a=sctpmap:").length>0){var a=n.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},n.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},n.generateSessionId=function(){return Math.random().toString().substr(2,21)},n.writeSessionBoilerplate=function(e,t,r){var o=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||n.generateSessionId())+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(e,t,r,o){var i=n.writeRtpDescription(e.kind,t);if(i+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var a="msid:"+o.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+a,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),i},n.getDirection=function(e,t){for(var r=n.splitLines(e),o=0;o<r.length;o++)switch(r[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[o].substr(2)}return t?n.getDirection(t):"sendrecv"},n.getKind=function(e){return n.splitLines(e)[0].split(" ")[0].substr(2)},n.isRejected=function(e){return"0"===e.split(" ",2)[1]},n.parseMLine=function(e){var t=n.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},n.parseOLine=function(e){var t=n.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},n.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=n.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=n)},{}],NJ2u:[function(e,t,r){"use strict";var n=e("sdp");function o(e,t,r,o,i){var a=n.writeRtpDescription(e.kind,t);if(a+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(o?o.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),a}function i(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},o=function(e,t,r,o){var i=n(e.parameters.apt,r),a=n(t.parameters.apt,o);return i&&a&&i.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(n){for(var i=0;i<t.codecs.length;i++){var a=t.codecs[i];if(n.name.toLowerCase()===a.name.toLowerCase()&&n.clockRate===a.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&a.parameters.apt&&!o(n,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(n.numChannels,a.numChannels),r.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var n=0;n<t.headerExtensions.length;n++){var o=t.headerExtensions[n];if(e.uri===o.uri){r.headerExtensions.push(o);break}}})),r}function a(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function s(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function c(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,r,n,o){var i=new Event("track");i.track=r,i.receiver=n,i.transceiver={receiver:n},i.streams=o,e.setTimeout((function(){t._dispatchEvent("track",i)}))}var l=function(r){var o=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){o[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var o="string"==typeof n;return o&&(n=[n]),n=n.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)})),delete e.url,e.urls=o?n[0]:n,!!n.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var a=r.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=n.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var o=this._createIceAndDtlsTransports();n.iceTransport=o.iceTransport,n.dtlsTransport=o.dtlsTransport}return t||this.transceivers.push(n),n},l.prototype.addTrack=function(t,r){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var o=0;o<this.transceivers.length;o++)this.transceivers[o].track||this.transceivers[o].kind!==t.kind||(n=this.transceivers[o]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},l.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var n=e.clone();e.getTracks().forEach((function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),n.getTracks().forEach((function(e){r.addTrack(e,n)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw c("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,r){var n=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;o.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),o},l.prototype._gather=function(t,r){var o=this,i=this.transceivers[r].iceGatherer;if(!i.onlocalcandidate){var a=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),i.onlocalcandidate=function(e){if(!(o.usingBundle&&r>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:r};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),s.component=1,s.ufrag=i.getLocalParameters().usernameFragment;var u=n.writeCandidate(s);a.candidate=Object.assign(a.candidate,n.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=n.getMediaSections(o._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",o._localDescription.sdp=n.getDescription(o._localDescription.sdp)+l.join("");var d=o.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),c||o._dispatchEvent("icecandidate",a),d&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){i.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,r,o){var a=i(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:n.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),o&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,r,o=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,o.signalingState)||o._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+o.signalingState));if("offer"===e.type)t=n.splitSections(e.sdp),r=t.shift(),t.forEach((function(e,t){var r=n.parseRtpParameters(e);o.transceivers[t].localCapabilities=r})),o.transceivers.forEach((function(e,t){o._gather(e.mid,t)}));else if("answer"===e.type){t=n.splitSections(o._remoteDescription.sdp),r=t.shift();var s=n.matchPrefix(r,"a=ice-lite").length>0;t.forEach((function(e,t){var a=o.transceivers[t],c=a.iceGatherer,u=a.iceTransport,l=a.dtlsTransport,d=a.localCapabilities,p=a.remoteCapabilities;if(!(n.isRejected(e)&&0===n.matchPrefix(e,"a=bundle-only").length||a.rejected)){var f=n.getIceParameters(e,r),h=n.getDtlsParameters(e,r);s&&(h.role="server"),o.usingBundle&&0!==t||(o._gather(a.mid,t),"new"===u.state&&u.start(c,f,s?"controlling":"controlled"),"new"===l.state&&l.start(h));var m=i(d,p);o._transceive(a,m.codecs.length>0,!1)}}))}return o._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?o._updateSignalingState("have-local-offer"):o._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(o){var l=this;if(-1===["offer","answer"].indexOf(o.type))return Promise.reject(c("TypeError",'Unsupported type "'+o.type+'"'));if(!a("setRemoteDescription",o.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+o.type+" in state "+l.signalingState));var d={};l.remoteStreams.forEach((function(e){d[e.id]=e}));var p=[],f=n.splitSections(o.sdp),h=f.shift(),m=n.matchPrefix(h,"a=ice-lite").length>0,_=n.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=_;var g=n.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,f.forEach((function(a,c){var u=n.splitLines(a),f=n.getKind(a),g=n.isRejected(a)&&0===n.matchPrefix(a,"a=bundle-only").length,v=u[0].substr(2).split(" ")[2],y=n.getDirection(a,h),b=n.parseMsid(a),w=n.getMid(a)||n.generateIdentifier();if(g||"application"===f&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))l.transceivers[c]={mid:w,kind:f,protocol:v,rejected:!0};else{var S,k,C,E,T,P,A,R,O;!g&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(f,!0));var x,M,D=n.parseRtpParameters(a);g||(x=n.getIceParameters(a,h),(M=n.getDtlsParameters(a,h)).role="client"),A=n.parseRtpEncodingParameters(a);var I=n.parseRtcpParameters(a),U=n.matchPrefix(a,"a=end-of-candidates",h).length>0,B=n.matchPrefix(a,"a=candidate:").map((function(e){return n.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===o.type||"answer"===o.type)&&!g&&_&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==o.type||g)"answer"!==o.type||g||(k=(S=l.transceivers[c]).iceGatherer,C=S.iceTransport,E=S.dtlsTransport,T=S.rtpReceiver,P=S.sendEncodingParameters,R=S.localCapabilities,l.transceivers[c].recvEncodingParameters=A,l.transceivers[c].remoteCapabilities=D,l.transceivers[c].rtcpParameters=I,B.length&&"new"===C.state&&(!m&&!U||_&&0!==c?B.forEach((function(e){s(S.iceTransport,e)})):C.setRemoteCandidates(B)),_&&0!==c||("new"===C.state&&C.start(k,x,"controlling"),"new"===E.state&&E.start(M)),!i(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,l._transceive(S,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!T||"sendrecv"!==y&&"sendonly"!==y?delete S.rtpReceiver:(O=T.track,b?(d[b.stream]||(d[b.stream]=new e.MediaStream),r(O,d[b.stream]),p.push([O,T,d[b.stream]])):(d.default||(d.default=new e.MediaStream),r(O,d.default),p.push([O,T,d.default]))));else{(S=l.transceivers[c]||l._createTransceiver(f)).mid=w,S.iceGatherer||(S.iceGatherer=l._createIceGatherer(c,_)),B.length&&"new"===S.iceTransport.state&&(!U||_&&0!==c?B.forEach((function(e){s(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(B)),R=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(R.codecs=R.codecs.filter((function(e){return"rtx"!==e.name}))),P=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var L,j=!1;"sendrecv"===y||"sendonly"===y?(j=!S.rtpReceiver,T=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,f),j&&(O=T.track,b&&"-"===b.stream||(b?(d[b.stream]||(d[b.stream]=new e.MediaStream,Object.defineProperty(d[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(O,"id",{get:function(){return b.track}}),L=d[b.stream]):(d.default||(d.default=new e.MediaStream),L=d.default)),L&&(r(O,L),S.associatedRemoteMediaStreams.push(L)),p.push([O,T,L]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var r,n,o=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));o&&(r=o,(n=t).removeTrack(r),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:r})))})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=R,S.remoteCapabilities=D,S.rtpReceiver=T,S.rtcpParameters=I,S.sendEncodingParameters=P,S.recvEncodingParameters=A,l._transceive(l.transceivers[c],!1,j)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===o.type?"active":"passive"),l._remoteDescription={type:o.type,sdp:o.sdp},"offer"===o.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(d).forEach((function(t){var r=d[t];if(r.getTracks().length){if(-1===l.remoteStreams.indexOf(r)){l.remoteStreams.push(r);var n=new Event("addstream");n.stream=r,e.setTimeout((function(){l._dispatchEvent("addstream",n)}))}p.forEach((function(e){var t=e[0],n=e[1];r.id===e[2].id&&u(l,t,n,[r])}))}})),p.forEach((function(e){e[2]||u(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},l.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var i=r.transceivers.filter((function(e){return"audio"===e.kind})).length,a=r.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(i=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?--i<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));i>0||a>0;)i>0&&(r._createTransceiver("audio"),i--),a>0&&(r._createTransceiver("video"),a--);var u=n.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach((function(o,i){var a=o.track,s=o.kind,c=o.mid||n.generateIdentifier();o.mid=c,o.iceGatherer||(o.iceGatherer=r._createIceGatherer(i,r.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),o.remoteCapabilities&&o.remoteCapabilities.codecs&&o.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(o.remoteCapabilities&&o.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=o.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),o.wantReceive&&(o.rtpReceiver=new e.RTCRtpReceiver(o.dtlsTransport,s)),o.localCapabilities=u,o.sendEncodingParameters=l})),"max-compat"!==r._config.bundlePolicy&&(u+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){u+=o(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+n.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},l.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var a=n.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(a+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=n.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,n){if(!(n+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=i(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=o(e,u,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(u)},l.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(o,i){if(!r._remoteDescription)return i(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<r.transceivers.length;u++)if(r.transceivers[u].mid===e.sdpMid){a=u;break}var l=r.transceivers[a];if(!l)return i(c("OperationError","Can not add ICE candidate"));if(l.rejected)return o();var d=Object.keys(e.candidate).length>0?n.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return o();if(d.component&&1!==d.component)return o();if((0===a||a>0&&l.iceTransport!==r.transceivers[0].iceTransport)&&!s(l.iceTransport,d))return i(c("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=n.getMediaSections(r._remoteDescription.sdp))[a]+="a="+(d.type?p:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=n.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var f=0;f<r.transceivers.length&&(r.transceivers[f].rejected||(r.transceivers[f].iceTransport.addRemoteCandidate({}),(t=n.getMediaSections(r._remoteDescription.sdp))[f]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=n.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));f++);o()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw c("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&n.push(e[t].getStats())}))})),Promise.all(n).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){e[r].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[r]),t.set(r,e[r])})),t}))}}}));var d=["createOffer","createAnswer"];return d.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:"YHvh"}],YdKx:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],P3bV:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimPeerConnection=function(e){var t=n.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=(0,i.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,o.filterIceServers)(e.iceServers,t.version),n.log("ICE servers after filtering:",e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},r.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(e("../utils")),o=e("./filtericeservers"),i=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),a=e("./getusermedia"),s=e("./getdisplaymedia");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=n.detectBrowser(e),r=e&&e.navigator,o=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,o){n.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,o)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var a=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===i(e)&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var u=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===i(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}};var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}},{}],Fzdr:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimOnTrack=function(e){"object"===s(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(e){var t=n.detectBrowser(e);if("object"===s(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]})),t.version<68){var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,r,n]=arguments;return i.apply(this,[e||null]).then((function(e){if(t.version<53&&!r)try{e.forEach((function(e){e.type=o[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,Object.assign({},t,{type:o[t.type]||t.type}))}))}return e})).then(r,n)}}},r.shimSenderGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},r.shimReceiverGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r}),n.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},r.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;n.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},r.shimAddTransceiver=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],r=e&&"sendEncodings"in e;r&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var n=t.apply(this,arguments);if(r){var{sender:o}=n,i=o.getParameters();"encodings"in i||(i.encodings=e.sendEncodings,this.setParametersPromises.push(o.setParameters(i).catch((function(){}))))}return n})}},r.shimCreateOffer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(r,e)})).finally((function(){r.setParametersPromises=[]})):t.apply(this,arguments)}}},r.shimCreateAnswer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(r,e)})).finally((function(){r.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}}),Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}});var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(e("../utils")),o=e("./getusermedia"),i=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimLocalStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(n){return t.call(r,n,e)})),e.getVideoTracks().forEach((function(n){return t.call(r,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var r=arguments[1];return r&&(this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})}},r.shimRemoteStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}},r.shimCallbacksAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),Promise.resolve()):o};var c=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=c,c=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=c,c=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=c}},r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return n(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))},r.shimConstraints=a,r.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var o=[],i=0;i<e.iceServers.length;i++){var a=e.iceServers[i];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(n.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,o.push(a)):o.push(e.iceServers[i])}e.iceServers=o}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===i(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}};var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:n.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&(!e.RTCIceCandidate||!("foundation"in e.RTCIceCandidate.prototype))){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===a(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),o=n.default.parseCandidate(e.candidate),i=Object.assign(r,o);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,o.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},r.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=n.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=n.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var o,i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),a=(u=i,l=65536,"firefox"===t.browser&&(l=t.version<57?-1===u?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),l),s=function(e,r){var o=65536;"firefox"===t.browser&&57===t.version&&(o=65535);var i=n.default.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?o=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(o=2147483637),o}(arguments[0],i);o=0===a&&0===s?Number.POSITIVE_INFINITY:0===a||0===s?Math.max(a,s):Math.min(a,s);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return o}}),this._sctp=c}var u,l;return r.apply(this,arguments)}}},r.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},o.wrapPeerConnectionEvent(e,"datachannel",(function(e){return r(e.channel,e.target),e}))}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0],o=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}},r.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}},r.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),r.apply(this,arguments)}}}};var n=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(e("./utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=n.log,u=n.detectBrowser(e),l={browserDetails:u,commonShim:c,extractVersion:n.extractVersion,disableLog:n.disableLog,disableWarnings:n.disableWarnings};switch(u.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),l;r("adapter.js shimming chrome."),l.browserShim=o,o.shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),l;r("adapter.js shimming firefox."),l.browserShim=a,a.shimGetUserMedia(e),a.shimPeerConnection(e),a.shimOnTrack(e),a.shimRemoveStream(e),a.shimSenderGetStats(e),a.shimReceiverGetStats(e),a.shimRTCDataChannel(e),a.shimAddTransceiver(e),a.shimCreateOffer(e),a.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!i||!i.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),l;r("adapter.js shimming edge."),l.browserShim=i,i.shimGetUserMedia(e),i.shimGetDisplayMedia(e),i.shimPeerConnection(e),i.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!s||!t.shimSafari)return r("Safari shim is not included in this adapter release."),l;r("adapter.js shimming safari."),l.browserShim=s,s.shimRTCIceServerUrls(e),s.shimCreateOfferLegacy(e),s.shimCallbacksAPI(e),s.shimLocalStreamsAPI(e),s.shimRemoteStreamsAPI(e),s.shimTrackEventTransceiver(e),s.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return l};var n=l(e("./utils")),o=l(e("./chrome/chrome_shim")),i=l(e("./edge/edge_shim")),a=l(e("./firefox/firefox_shim")),s=l(e("./safari/safari_shim")),c=l(e("./common_shim"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(0,e("./adapter_factory.js").adapterFactory)({window:window});r.default=n},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("webrtc-adapter"));r.webRTCAdapter=o.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./adapter");r.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return n.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return n.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),r=n.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&r<72)return!1;if("firefox"===t&&r>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var o=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),o=!0}catch(e){}finally{e&&e.close()}return o},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("peerjs-js-binarypack")),i=e("./supports"),a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};r.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=a,this.browser=i.Supports.getBrowser(),this.browserVersion=i.Supports.getVersion(),this.supports=function(){var e,t={browser:i.Supports.isBrowserSupported(),webRTC:i.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(a),t.audioVideo=!0;var r=void 0;try{r=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!r.ordered;try{r.binaryType="blob",t.binaryBlob=!i.Supports.isIOS}catch(e){}}catch(e){}finally{r&&r.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=o.pack,this.unpack=o.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],n=e.size,o=Math.ceil(n/r.util.chunkedMTU),i=0,a=0;a<n;){var s=Math.min(n,a+r.util.chunkedMTU),c=e.slice(a,s),u={__peerData:this._dataCount,n:i,data:c,total:o};t.push(u),a=s,i++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var r=new FileReader;return r.onload=function(e){e.target&&t(e.target.result)},r.readAsArrayBuffer(e),r},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,o="~";function i(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new a(r,n||e,i),c=o?o+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=o?o+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,a=new Array(i);n<i;n++)a[n]=r[n].fn;return a},u.prototype.listenerCount=function(e){var t=o?o+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,i,a){var s=o?o+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,i),!0;case 6:return l.fn.call(l.context,t,r,n,i,a),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var p,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,n);break;default:if(!c)for(p=1,c=new Array(d-1);p<d;p++)c[p-1]=arguments[p];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var i=o?o+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||n&&!a.once||r&&a.context!==r||c(this,i);else{for(var s=0,u=[],l=a.length;s<l;s++)(a[s].fn!==t||n&&!a[s].once||r&&a[s].context!==r)&&u.push(a[s]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&c(this,t)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=o,u.EventEmitter=u,void 0!==t&&(t.exports=u)},{}],WOs9:[function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(r,"__esModule",{value:!0});var i,a="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(i=r.LogLevel||(r.LogLevel={}));var s=function(){function e(){this._logLevel=i.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.All&&this._print.apply(this,o([i.All],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.Warnings&&this._print.apply(this,o([i.Warnings],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.Errors&&this._print.apply(this,o([i.Errors],e))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=o([a],t);for(var s in n)n[s]instanceof Error&&(n[s]="("+n[s].name+") "+n[s].message);e>=i.All?console.log.apply(console,o(n)):e>=i.Warnings?console.warn.apply(console,o(["WARNING"],n)):e>=i.Errors&&console.error.apply(console,o(["ERROR"],n))},e}();r.default=new s},{}],ZRYf:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e.Open="open",e.Stream="stream",e.Data="data",e.Close="close",e.Error="error",e.IceStateChanged="iceStateChanged"}(r.ConnectionEventType||(r.ConnectionEventType={})),function(e){e.Data="data",e.Media="media"}(r.ConnectionType||(r.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(r.PeerEventType||(r.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(r.PeerErrorType||(r.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(r.SerializationType||(r.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(r.SocketEventType||(r.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(r.ServerMessageType||(r.ServerMessageType={}))},{}],wJlv:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var c=e("eventemitter3"),u=s(e("./logger")),l=e("./enums"),d=function(e){function t(t,r,n,o,i,a){void 0===a&&(a=5e3);var s=e.call(this)||this;s.pingInterval=a,s._disconnected=!0,s._messagesQueue=[];var c=t?"wss://":"ws://";return s._baseUrl=c+r+":"+n+o+"peerjs?key="+i,s}return n(t,e),t.prototype.start=function(e,t){var r=this;this._id=e;var n=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(n),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),u.default.log("Server message received:",t)}catch(t){return void u.default.log("Invalid server message",e.data)}r.emit(l.SocketEventType.Message,t)},this._socket.onclose=function(e){r._disconnected||(u.default.log("Socket closed.",e),r._cleanup(),r._disconnected=!0,r.emit(l.SocketEventType.Disconnected))},this._socket.onopen=function(){r._disconnected||(r._sendQueuedMessages(),u.default.log("Socket open"),r._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:l.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else u.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,r=i(this._messagesQueue);this._messagesQueue=[];try{for(var n=a(r),o=n.next();!o.done;o=n.next()){var s=o.value;this.send(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(l.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(c.EventEmitter);r.Socket=d},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./enums"),l=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===u.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===u.ConnectionType.Data){var r=this.connection,n={ordered:!!e.reliable},o=t.createDataChannel(r.label,n);r.initialize(o)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){c.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,r=this.connection.peer,n=this.connection.connectionId,o=this.connection.type,i=this.connection.provider;c.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(c.default.log("Received ICE candidates for "+r+":",e.candidate),i.socket.send({type:u.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:o,connectionId:n},dst:r}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":c.default.log("iceConnectionState is failed, closing connections to "+r),t.connection.emit(u.ConnectionEventType.Error,new Error("Negotiation of connection to "+r+" failed.")),t.connection.close();break;case"closed":c.default.log("iceConnectionState is closed, closing connections to "+r),t.connection.emit(u.ConnectionEventType.Error,new Error("Connection to "+r+" closed.")),t.connection.close();break;case"disconnected":c.default.log("iceConnectionState changed to disconnected on the connection with "+r);break;case"completed":e.onicecandidate=s.util.noop}t.connection.emit(u.ConnectionEventType.IceStateChanged,e.iceConnectionState)},c.default.log("Listening for data channel"),e.ondatachannel=function(e){c.default.log("Received data channel");var t=e.channel;i.getConnection(r,n).initialize(t)},c.default.log("Listening for remote stream"),e.ontrack=function(e){c.default.log("Received remote stream");var o=e.streams[0],a=i.getConnection(r,n);if(a.type===u.ConnectionType.Media){var s=a;t._addStreamToMediaConnection(o,s)}}},e.prototype.cleanup=function(){c.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,r=!1;if(this.connection.type===u.ConnectionType.Data){var n=this.connection.dataChannel;n&&(r=!!n.readyState&&"closed"!==n.readyState)}(t||r)&&e.close()}},e.prototype._makeOffer=function(){return o(this,void 0,Promise,(function(){var e,t,r,o,a,l,d;return i(this,(function(i){switch(i.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,i.label=1;case 1:return i.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:r=i.sent(),c.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,e.setLocalDescription(r)];case 4:return i.sent(),c.default.log("Set localDescription:",r,"for:"+this.connection.peer),o={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:s.util.browser},this.connection.type===u.ConnectionType.Data&&(a=this.connection,o=n(n({},o),{label:a.label,reliable:a.reliable,serialization:a.serialization})),t.socket.send({type:u.ServerMessageType.Offer,payload:o,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=i.sent())&&(t.emitError(u.PeerErrorType.WebRTC,l),c.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return d=i.sent(),t.emitError(u.PeerErrorType.WebRTC,d),c.default.log("Failed to createOffer, ",d),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return o(this,void 0,Promise,(function(){var e,t,r,n,o;return i(this,(function(i){switch(i.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,i.label=1;case 1:return i.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:r=i.sent(),c.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,e.setLocalDescription(r)];case 4:return i.sent(),c.default.log("Set localDescription:",r,"for:"+this.connection.peer),t.socket.send({type:u.ServerMessageType.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,browser:s.util.browser},dst:this.connection.peer}),[3,6];case 5:return n=i.sent(),t.emitError(u.PeerErrorType.WebRTC,n),c.default.log("Failed to setLocalDescription, ",n),[3,6];case 6:return[3,8];case 7:return o=i.sent(),t.emitError(u.PeerErrorType.WebRTC,o),c.default.log("Failed to create answer, ",o),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return o(this,void 0,Promise,(function(){var r,n,o,a;return i(this,(function(i){switch(i.label){case 0:t=new RTCSessionDescription(t),r=this.connection.peerConnection,n=this.connection.provider,c.default.log("Setting remote description",t),o=this,i.label=1;case 1:return i.trys.push([1,5,,6]),[4,r.setRemoteDescription(t)];case 2:return i.sent(),c.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,o._makeAnswer()];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return a=i.sent(),n.emitError(u.PeerErrorType.WebRTC,a),c.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return o(this,void 0,Promise,(function(){var t,r,n,o,a,s;return i(this,(function(i){switch(i.label){case 0:c.default.log("handleCandidate:",e),t=e.candidate,r=e.sdpMLineIndex,n=e.sdpMid,o=this.connection.peerConnection,a=this.connection.provider,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.addIceCandidate(new RTCIceCandidate({sdpMid:n,sdpMLineIndex:r,candidate:t}))];case 2:return i.sent(),c.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return s=i.sent(),a.emitError(u.PeerErrorType.WebRTC,s),c.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(c.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return c.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(r){t.addTrack(r,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){c.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();r.Negotiator=l},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var o=e.call(this)||this;return o.peer=t,o.provider=r,o.options=n,o._open=!1,o.metadata=n.metadata,o}return n(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}(e("eventemitter3").EventEmitter);r.BaseConnection=o},{eventemitter3:"JJlS"}],dbHP:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./negotiator"),l=e("./enums"),d=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i._localStream=i.options._stream,i.connectionId=i.options.connectionId||t.ID_PREFIX+s.util.randomToken(),i._negotiator=new u.Negotiator(i),i._localStream&&i._negotiator.startConnection({_stream:i._localStream,originator:!0}),i}return n(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),t.prototype.addStream=function(t){c.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,l.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,r=e.payload;switch(e.type){case l.ServerMessageType.Answer:this._negotiator.handleSDP(t,r.sdp),this._open=!0;break;case l.ServerMessageType.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:c.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var r,n;if(void 0===t&&(t={}),this._localStream)c.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(o(o({},this.options._payload),{_stream:e}));var a=this.provider._getMessages(this.connectionId);try{for(var s=i(a),u=s.next();!u.done;u=s.next()){var l=u.value;this.handleMessage(l)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,l.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);r.MediaConnection=d},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("eventemitter3"),a=o(e("./logger")),s=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){a.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return n(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(i.EventEmitter);r.EncodingQueue=s},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var a=e("./util"),s=i(e("./logger")),c=e("./negotiator"),u=e("./enums"),l=e("./baseconnection"),d=e("./encodingQueue"),p=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.stringify=JSON.stringify,i.parse=JSON.parse,i._buffer=[],i._bufferSize=0,i._buffering=!1,i._chunkedData={},i._encodingQueue=new d.EncodingQueue,i.connectionId=i.options.connectionId||t.ID_PREFIX+a.util.randomToken(),i.label=i.options.label||i.connectionId,i.serialization=i.options.serialization||u.SerializationType.Binary,i.reliable=!!i.options.reliable,i._encodingQueue.on("done",(function(e){i._bufferedSend(e)})),i._encodingQueue.on("error",(function(){s.default.error("DC#"+i.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),i.close()})),i._negotiator=new c.Negotiator(i),i._negotiator.startConnection(i.options._payload||{originator:!0}),i}return n(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return u.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){s.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(u.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){s.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){s.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var r=this,n=t.data,o=n.constructor,i=n;if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){if(o===Blob)return void a.util.blobToArrayBuffer(n,(function(e){var t=a.util.unpack(e);r.emit(u.ConnectionEventType.Data,t)}));if(o===ArrayBuffer)i=a.util.unpack(n);else if(o===String){var s=a.util.binaryStringToArrayBuffer(n);i=a.util.unpack(s)}}else this.serialization===u.SerializationType.JSON&&(i=this.parse(n));i.__peerData?this._handleChunk(i):e.prototype.emit.call(this,u.ConnectionEventType.Data,i)},t.prototype._handleChunk=function(e){var t=e.__peerData,r=this._chunkedData[t]||{data:[],count:0,total:e.total};if(r.data[e.n]=e.data,r.count++,this._chunkedData[t]=r,r.total===r.count){delete this._chunkedData[t];var n=new Blob(r.data);this._handleDataMessage({data:n})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,u.ConnectionEventType.Close))},t.prototype.send=function(t,r){if(this.open)if(this.serialization===u.SerializationType.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){var n=a.util.pack(t);if(!r&&n.size>a.util.chunkedMTU)return void this._sendChunks(n);a.util.supports.binaryBlob?this._bufferedSend(n):this._encodingQueue.enque(n)}else this._bufferedSend(t);else e.prototype.emit.call(this,u.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var r=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){r._buffering=!1,r._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return s.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,r,n=a.util.chunk(e);s.default.log("DC#"+this.connectionId+" Try to send "+n.length+" chunks...");try{for(var i=o(n),c=i.next();!c.done;c=i.next()){var u=c.value;this.send(u,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case u.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case u.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:s.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(l.BaseConnection);r.DataConnection=p},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var a=e("./util"),s=i(e("./logger")),c=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return n(this,void 0,Promise,(function(){var e,t,r,n;return o(this,(function(o){switch(o.label){case 0:e=this._buildUrl("id"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=o.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw r=o.sent(),s.default.error("Error retrieving ID",r),n="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return n(this,void 0,Promise,(function(){var e,t,r,n;return o(this,(function(o){switch(o.label){case 0:e=this._buildUrl("peers"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=o.sent()).status){if(401===t.status)throw"",r=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+r);throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw n=o.sent(),s.default.error("Error retrieving list peers",n),new Error("Could not get list peers from the server."+n);case 4:return[2]}}))}))},e}();r.API=c},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var c=e("eventemitter3"),u=e("./util"),l=s(e("./logger")),d=e("./socket"),p=e("./mediaconnection"),f=e("./dataconnection"),h=e("./enums"),m=e("./api"),_=function(e){function t(r,n){var i,a=e.call(this)||this;return a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,r&&r.constructor==Object?n=r:r&&(i=r.toString()),n=o({debug:0,host:u.util.CLOUD_HOST,port:u.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:u.util.randomToken(),config:u.util.defaultConfig},n),a._options=n,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==u.util.CLOUD_HOST?a._options.secure=u.util.isSecure():a._options.host==u.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&l.default.setLogFunction(a._options.logFunction),l.default.logLevel=a._options.debug||0,a._api=new m.API(n),a._socket=a._createServerConnection(),u.util.supports.audioVideo||u.util.supports.data?i&&!u.util.validateId(i)?(a._delayedAbort(h.PeerErrorType.InvalidID,'ID "'+i+'" is invalid'),a):(i?a._initialize(i):a._api.retrieveId().then((function(e){return a._initialize(e)})).catch((function(e){return a._abort(h.PeerErrorType.ServerError,e)})),a):(a._delayedAbort(h.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return n(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,r=Object.create(null);try{for(var n=i(this._connections),o=n.next();!o.done;o=n.next()){var s=a(o.value,2),c=s[0],u=s[1];r[c]=u}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new d.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(h.SocketEventType.Message,(function(t){e._handleMessage(t)})),t.on(h.SocketEventType.Error,(function(t){e._abort(h.PeerErrorType.SocketError,t)})),t.on(h.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(h.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),t.on(h.SocketEventType.Close,(function(){e.disconnected||e._abort(h.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,r,n=e.type,o=e.payload,a=e.src;switch(n){case h.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(h.PeerEventType.Open,this.id);break;case h.ServerMessageType.Error:this._abort(h.PeerErrorType.ServerError,o.msg);break;case h.ServerMessageType.IdTaken:this._abort(h.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case h.ServerMessageType.InvalidKey:this._abort(h.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case h.ServerMessageType.Leave:l.default.log("Received leave message from "+a),this._cleanupPeer(a),this._connections.delete(a);break;case h.ServerMessageType.Expire:this.emitError(h.PeerErrorType.PeerUnavailable,"Could not connect to peer "+a);break;case h.ServerMessageType.Offer:var s=o.connectionId;if((_=this.getConnection(a,s))&&(_.close(),l.default.warn("Offer received for existing Connection ID:"+s)),o.type===h.ConnectionType.Media)_=new p.MediaConnection(a,this,{connectionId:s,_payload:o,metadata:o.metadata}),this._addConnection(a,_),this.emit(h.PeerEventType.Call,_);else{if(o.type!==h.ConnectionType.Data)return void l.default.warn("Received malformed connection type:"+o.type);_=new f.DataConnection(a,this,{connectionId:s,_payload:o,metadata:o.metadata,label:o.label,serialization:o.serialization,reliable:o.reliable}),this._addConnection(a,_),this.emit(h.PeerEventType.Connection,_)}var c=this._getMessages(s);try{for(var u=i(c),d=u.next();!d.done;d=u.next()){var m=d.value;_.handleMessage(m)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}break;default:if(!o)return void l.default.warn("You received a malformed message from "+a+" of type "+n);var _;s=o.connectionId,(_=this.getConnection(a,s))&&_.peerConnection?_.handleMessage(e):s?this._storeMessage(s,e):l.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var r=new f.DataConnection(e,this,t);return this._addConnection(e,r),r},t.prototype.call=function(e,t,r){if(void 0===r&&(r={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){r._stream=t;var n=new p.MediaConnection(e,this,r);return this._addConnection(e,n),n}l.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){l.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var r,n,o=this._connections.get(e);if(!o)return null;try{for(var a=i(o),s=a.next();!s.done;s=a.next()){var c=s.value;if(c.connectionId===t)return c}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return null},t.prototype._delayedAbort=function(e,t){var r=this;setTimeout((function(){r._abort(e,t)}),0)},t.prototype._abort=function(e,t){l.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var r;l.default.error("Error:",t),(r="string"==typeof t?new Error(t):t).type=e,this.emit(h.PeerEventType.Error,r)},t.prototype.destroy=function(){this.destroyed||(l.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(h.PeerEventType.Close))},t.prototype._cleanup=function(){var e,t;try{for(var r=i(this._connections.keys()),n=r.next();!n.done;n=r.next()){var o=n.value;this._cleanupPeer(o),this._connections.delete(o)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,r,n=this._connections.get(e);if(n)try{for(var o=i(n),a=o.next();!a.done;a=o.next())a.value.close()}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;l.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(h.PeerEventType.Disconnected,e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)l.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");l.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(h.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(c.EventEmitter);r.Peer=_},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./util"),o=e("./peer");r.peerjs={Peer:o.Peer,util:n.util},r.default=o.Peer,window.peerjs=r.peerjs,window.Peer=o.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o={options:{disableScrolling:!1,hostedStyles:!0,animations:!0,keyboardControl:!0,minResolution:0,autoInit:!0,wrapAround:!1,showImageCount:!0},version:"1.4.11"};function i(e,t){var r=this;this.root=t,this.index=e,this.imgPaths=[],this.subTexts=[],this.altTexts=[],this.options={};var n=document.getElementsByClassName("hes-gallery")[this.index];this.options.wrapAround=n.hasAttribute("data-wrap")?"true"==n.dataset.wrap:this.root.options.wrapAround,this.options.showImageCount=n.hasAttribute("data-img-count")?"true"==n.dataset.imgCount:this.root.options.showImageCount;var o=0;n.querySelectorAll("img").forEach((function(e,t){e.hasAttribute("data-disabled")?o++:(e.hasAttribute("data-fullsize")?r.imgPaths.push(e.dataset.fullsize||""):r.imgPaths.push(e.src||""),r.subTexts.push(e.dataset.subtext||""),r.altTexts.push(e.alt||""),e.onclick=function(){r.root.show(r.index,t-o)})})),this.count=this.imgPaths.length}o.setOptions=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};for(var t in e)this.options[t]=e[t]},o.init=function(e){var t=this;this.setOptions(e),this.executed||this.createDOM(),this.options.animations?this.elements.pic_cont.classList="hg-transition":this.elements.pic_cont.classList="",this.count=document.querySelectorAll(".hes-gallery").length,this.galleries=[];for(var r=0;r<this.count;r++)this.galleries[r]=new i(r,this);return this.options.keyboardControl&&!this.keydownEventListener&&(addEventListener("keydown",(function(e){var r=e.keyCode;39==r&&t.open&&t.options.keyboardControl&&t.next(),37==r&&t.open&&t.options.keyboardControl&&t.prev(),27==r&&t.open&&t.options.keyboardControl&&t.hide()})),this.keydownEventListener=!0),"HesGallery initiated!"},o.createDOM=function(){var e=this;this.elements={},this.options.hostedStyles&&(document.head.innerHTML+="<link rel='stylesheet' href='https://unpkg.com/hes-gallery/dist/hes-gallery.min.css'>");var t=document.createElement("div");t.id="hgallery",t.setAttribute("style","visibility:hidden;"),this.elements.galery=t,this.elements.galery.innerHTML+="\n    <div id='hg-bg'></div>\n    <div id='hg-pic-cont'>\n      <img id='hg-pic' />\n      <div id='hg-prev-onpic'></div>\n      <div id='hg-next-onpic'></div>\n      <div id='hg-subtext'></div>\n      <div id='hg-howmany'></div>\n    </div>\n    <button id='hg-prev'></button>\n    <button id='hg-next'></button>\n  ",document.body.appendChild(t),this.elements.b_prev=document.getElementById("hg-prev"),this.elements.b_next=document.getElementById("hg-next"),this.elements.pic_cont=document.getElementById("hg-pic-cont"),this.elements.b_next_onpic=document.getElementById("hg-next-onpic"),this.elements.b_prev_onpic=document.getElementById("hg-prev-onpic"),this.elements.b_prev.onclick=this.elements.b_prev_onpic.onclick=function(){e.prev()},this.elements.b_next.onclick=this.elements.b_next_onpic.onclick=function(){e.next()},document.getElementById("hg-bg").onclick=function(){e.hide()},this.executed=!0},o.show=function(e,t){if(innerWidth<this.options.minResolution)return!1;this.currentImg=t,this.currentGal=e,this.open=!0,!this.options.animations&&"hg-transition"!=this.elements.pic_cont.classList||this.elements.pic_cont.classList.remove("hg-transition"),document.getElementById("hg-pic").setAttribute("src",this.galleries[e].imgPaths[t]),document.getElementById("hg-pic").alt=this.galleries[e].altTexts[t],this.elements.galery.classList.add("open"),document.getElementById("hg-subtext").innerHTML=this.galleries[e].subTexts[t],this.galleries[this.currentGal].options.showImageCount&&1!=this.galleries[this.currentGal].imgPaths.length?document.getElementById("hg-howmany").innerHTML=this.currentImg+1+"/"+this.galleries[e].count:document.getElementById("hg-howmany").innerHTML="",1==this.galleries[this.currentGal].imgPaths.length?(this.elements.b_prev.classList="hg-unvisible",this.elements.b_prev_onpic.classList="hg-unvisible",this.elements.b_next.classList="hg-unvisible",this.elements.b_next_onpic.classList="hg-unvisible"):this.currentImg+1!=1||this.galleries[this.currentGal].options.wrapAround?(this.currentImg+1!=this.galleries[this.currentGal].count||this.galleries[this.currentGal].options.wrapAround?(this.elements.b_next.classList="",this.elements.b_next_onpic.classList=""):(this.elements.b_next.classList="hg-unvisible",this.elements.b_next_onpic.classList="hg-unvisible"),this.elements.b_prev.classList="",this.elements.b_prev_onpic.classList=""):(this.elements.b_prev.classList="hg-unvisible",this.elements.b_prev_onpic.classList="hg-unvisible",this.elements.b_next.classList="",this.elements.b_next_onpic.classList=""),this.options.disableScrolling&&(document.body.classList+=" hg-disable-scrolling")},o.hide=function(){this.options.animations&&this.elements.pic_cont.classList.add("hg-transition"),this.elements.galery.classList.remove("open"),this.open=!1,this.options.disableScrolling&&document.body.classList.remove("hg-disable-scrolling")},o.next=function(){this.galleries[this.currentGal].options.wrapAround&&this.currentImg==this.galleries[this.currentGal].count-1?this.show(this.currentGal,0):this.currentImg+1<this.galleries[this.currentGal].count&&this.show(this.currentGal,this.currentImg+1)},o.prev=function(){this.galleries[this.currentGal].options.wrapAround&&0==this.currentImg?this.show(this.currentGal,this.galleries[this.currentGal].count-1):1<this.currentImg+1&&this.show(this.currentGal,this.currentImg-1)},document.addEventListener("DOMContentLoaded",(function(){o.options.autoInit&&o.init()})),"object"==n(t)&&void 0!==e&&(e.exports=o),"undefined"!=typeof NodeList&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach)},function(e,t,r){var n=r(113),o=r(22),i=r(41),a=r(10)("socket.io-client");e.exports=t=c;var s=t.managers={};function c(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var r,o=n(e),c=o.source,u=o.id,l=o.path,d=s[u]&&l in s[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(a("ignoring socket cache for %s",c),r=i(c,t)):(s[u]||(a("new io instance for %s",c),s[u]=i(c,t)),r=s[u]),o.query&&!t.query&&(t.query=o.query),r.socket(o.path,t)}t.protocol=o.protocol,t.connect=c,t.Manager=r(41),t.Socket=r(47)},function(e,t){e.exports=function e(t){var r=new RegExp("^.*("+["\\+https:\\/\\/developers.google.com\\/\\+\\/web\\/snippet\\/","googlebot","baiduspider","gurujibot","yandexbot","slurp","msnbot","bingbot","facebookexternalhit","linkedinbot","twitterbot","slackbot","telegrambot","applebot","pingdom","tumblr ","Embedly","spbot"].join("|")+").*$");t=t||{};var n={version:!1,language:!1,platform:!0,os:!0,pixelDepth:!0,colorDepth:!0,resolution:!1,isAuthoritative:!0,silkAccelerated:!0,isKindleFire:!0,isDesktop:!0,isMobile:!0,isTablet:!0,isWindows:!0,isLinux:!0,isLinux64:!0,isChromeOS:!0,isMac:!0,isiPad:!0,isiPhone:!0,isiPod:!0,isAndroid:!0,isSamsung:!0,isSmartTV:!0,isRaspberry:!0,isBlackberry:!0,isTouchScreen:!0,isOpera:!1,isIE:!1,isEdge:!1,isIECompatibilityMode:!1,isSafari:!1,isFirefox:!1,isWebkit:!1,isChrome:!1,isKonqueror:!1,isOmniWeb:!1,isSeaMonkey:!1,isFlock:!1,isAmaya:!1,isPhantomJS:!1,isEpiphany:!1,source:!1,cpuCores:!1};for(var o in t)t.hasOwnProperty(o)&&void 0!==n[o]&&(n[o]=t[o]);return this.options=n,this.version="1.0.0",this._Versions={Edge:/Edge\/([\d\w\.\-]+)/i,Firefox:/firefox\/([\d\w\.\-]+)/i,IE:/msie\s([\d\.]+[\d])|trident\/\d+\.\d+;.*[rv:]+(\d+\.\d)/i,Chrome:/chrome\/([\d\w\.\-]+)/i,Chromium:/(?:chromium|crios)\/([\d\w\.\-]+)/i,Safari:/version\/([\d\w\.\-]+)/i,Opera:/version\/([\d\w\.\-]+)|OPR\/([\d\w\.\-]+)/i,Ps3:/([\d\w\.\-]+)\)\s*$/i,Psp:/([\d\w\.\-]+)\)?\s*$/i,Amaya:/amaya\/([\d\w\.\-]+)/i,SeaMonkey:/seamonkey\/([\d\w\.\-]+)/i,OmniWeb:/omniweb\/v([\d\w\.\-]+)/i,Flock:/flock\/([\d\w\.\-]+)/i,Epiphany:/epiphany\/([\d\w\.\-]+)/i,WinJs:/msapphost\/([\d\w\.\-]+)/i,PhantomJS:/phantomjs\/([\d\w\.\-]+)/i,UC:/UCBrowser\/([\d\w\.]+)/i},this._Browsers={Edge:/edge/i,Amaya:/amaya/i,Konqueror:/konqueror/i,Epiphany:/epiphany/i,SeaMonkey:/seamonkey/i,Flock:/flock/i,OmniWeb:/omniweb/i,Chromium:/chromium|crios/i,Chrome:/chrome/i,Safari:/safari/i,IE:/msie|trident/i,Opera:/opera|OPR/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Firefox:/firefox/i,WinJs:/msapphost/i,PhantomJS:/phantomjs/i,UC:/UCBrowser/i},this._OS={Windows10:/windows nt 10\.0/i,Windows81:/windows nt 6\.3/i,Windows8:/windows nt 6\.2/i,Windows7:/windows nt 6\.1/i,UnknownWindows:/windows nt 6\.\d+/i,WindowsVista:/windows nt 6\.0/i,Windows2003:/windows nt 5\.2/i,WindowsXP:/windows nt 5\.1/i,Windows2000:/windows nt 5\.0/i,WindowsPhone8:/windows phone 8\./,OSXCheetah:/os x 10[._]0/i,OSXPuma:/os x 10[._]1(\D|$)/i,OSXJaguar:/os x 10[._]2/i,OSXPanther:/os x 10[._]3/i,OSXTiger:/os x 10[._]4/i,OSXLeopard:/os x 10[._]5/i,OSXSnowLeopard:/os x 10[._]6/i,OSXLion:/os x 10[._]7/i,OSXMountainLion:/os x 10[._]8/i,OSXMavericks:/os x 10[._]9/i,OSXYosemite:/os x 10[._]10/i,OSXElCapitan:/os x 10[._]11/i,OSXSierra:/os x 10[._]12/i,Mac:/os x/i,Linux:/linux/i,Linux64:/linux x86_64/i,ChromeOS:/cros/i,Wii:/wii/i,PS3:/playstation 3/i,PSP:/playstation portable/i,iPad:/\(iPad.*os (\d+)[._](\d+)/i,iPhone:/\(iPhone.*os (\d+)[._](\d+)/i,Bada:/Bada\/(\d+)\.(\d+)/i,Curl:/curl\/(\d+)\.(\d+)\.(\d+)/i},this._Platform={Windows:/windows nt/i,WindowsPhone:/windows phone/i,Mac:/macintosh/i,Linux:/linux/i,Wii:/wii/i,Playstation:/playstation/i,iPad:/ipad/i,iPod:/ipod/i,iPhone:/iphone/i,Android:/android/i,Blackberry:/blackberry/i,Samsung:/samsung/i,Curl:/curl/i},this.DefaultAgent={isAuthoritative:!0,isMobile:!1,isTablet:!1,isiPad:!1,isiPod:!1,isiPhone:!1,isAndroid:!1,isBlackberry:!1,isOpera:!1,isIE:!1,isEdge:!1,isIECompatibilityMode:!1,isSafari:!1,isFirefox:!1,isWebkit:!1,isChrome:!1,isKonqueror:!1,isOmniWeb:!1,isSeaMonkey:!1,isFlock:!1,isAmaya:!1,isPhantomJS:!1,isEpiphany:!1,isDesktop:!1,isWindows:!1,isLinux:!1,isLinux64:!1,isMac:!1,isChromeOS:!1,isBada:!1,isSamsung:!1,isRaspberry:!1,isBot:!1,isCurl:!1,isAndroidTablet:!1,isWinJs:!1,isKindleFire:!1,isSilk:!1,isCaptive:!1,isSmartTV:!1,isUC:!1,isTouchScreen:!1,silkAccelerated:!1,colorDepth:-1,pixelDepth:-1,resolution:[],cpuCores:-1,language:"unknown",browser:"unknown",version:"unknown",os:"unknown",platform:"unknown",geoIp:{},source:"",hashInt:function(e){var t,r,n=0;if(0===e.length)return n;for(t=0,r=e.length;t<r;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},hashMD5:function(e){function t(e,t){return e<<t|e>>>32-t}function r(e,t){var r,n,o,i,a;return o=2147483648&e,i=2147483648&t,a=(1073741823&e)+(1073741823&t),(r=1073741824&e)&(n=1073741824&t)?2147483648^a^o^i:r|n?1073741824&a?3221225472^a^o^i:1073741824^a^o^i:a^o^i}function n(e,n,o,i,a,s,c){return e=r(e,r(r(function(e,t,r){return e&t|~e&r}(n,o,i),a),c)),r(t(e,s),n)}function o(e,n,o,i,a,s,c){return e=r(e,r(r(function(e,t,r){return e&r|t&~r}(n,o,i),a),c)),r(t(e,s),n)}function i(e,n,o,i,a,s,c){return e=r(e,r(r(function(e,t,r){return e^t^r}(n,o,i),a),c)),r(t(e,s),n)}function a(e,n,o,i,a,s,c){return e=r(e,r(r(function(e,t,r){return t^(e|~r)}(n,o,i),a),c)),r(t(e,s),n)}function s(e){var t,r="",n="";for(t=0;t<=3;t++)r+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return r}var c,u,l,d,p,f,h,m,_,g;for(c=function(e){for(var t,r=e.length,n=r+8,o=16*((n-n%64)/64+1),i=new Array(o-1),a=0,s=0;s<r;)a=s%4*8,i[t=(s-s%4)/4]=i[t]|e.charCodeAt(s)<<a,s++;return a=s%4*8,i[t=(s-s%4)/4]=i[t]|128<<a,i[o-2]=r<<3,i[o-1]=r>>>29,i}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e)),h=1732584193,m=4023233417,_=2562383102,g=271733878,u=0;u<c.length;u+=16)l=h,d=m,p=_,f=g,h=n(h,m,_,g,c[u+0],7,3614090360),g=n(g,h,m,_,c[u+1],12,3905402710),_=n(_,g,h,m,c[u+2],17,606105819),m=n(m,_,g,h,c[u+3],22,3250441966),h=n(h,m,_,g,c[u+4],7,4118548399),g=n(g,h,m,_,c[u+5],12,1200080426),_=n(_,g,h,m,c[u+6],17,2821735955),m=n(m,_,g,h,c[u+7],22,4249261313),h=n(h,m,_,g,c[u+8],7,1770035416),g=n(g,h,m,_,c[u+9],12,2336552879),_=n(_,g,h,m,c[u+10],17,4294925233),m=n(m,_,g,h,c[u+11],22,2304563134),h=n(h,m,_,g,c[u+12],7,1804603682),g=n(g,h,m,_,c[u+13],12,4254626195),_=n(_,g,h,m,c[u+14],17,2792965006),h=o(h,m=n(m,_,g,h,c[u+15],22,1236535329),_,g,c[u+1],5,4129170786),g=o(g,h,m,_,c[u+6],9,3225465664),_=o(_,g,h,m,c[u+11],14,643717713),m=o(m,_,g,h,c[u+0],20,3921069994),h=o(h,m,_,g,c[u+5],5,3593408605),g=o(g,h,m,_,c[u+10],9,38016083),_=o(_,g,h,m,c[u+15],14,3634488961),m=o(m,_,g,h,c[u+4],20,3889429448),h=o(h,m,_,g,c[u+9],5,568446438),g=o(g,h,m,_,c[u+14],9,3275163606),_=o(_,g,h,m,c[u+3],14,4107603335),m=o(m,_,g,h,c[u+8],20,1163531501),h=o(h,m,_,g,c[u+13],5,2850285829),g=o(g,h,m,_,c[u+2],9,4243563512),_=o(_,g,h,m,c[u+7],14,1735328473),h=i(h,m=o(m,_,g,h,c[u+12],20,2368359562),_,g,c[u+5],4,4294588738),g=i(g,h,m,_,c[u+8],11,2272392833),_=i(_,g,h,m,c[u+11],16,1839030562),m=i(m,_,g,h,c[u+14],23,4259657740),h=i(h,m,_,g,c[u+1],4,2763975236),g=i(g,h,m,_,c[u+4],11,1272893353),_=i(_,g,h,m,c[u+7],16,4139469664),m=i(m,_,g,h,c[u+10],23,3200236656),h=i(h,m,_,g,c[u+13],4,681279174),g=i(g,h,m,_,c[u+0],11,3936430074),_=i(_,g,h,m,c[u+3],16,3572445317),m=i(m,_,g,h,c[u+6],23,76029189),h=i(h,m,_,g,c[u+9],4,3654602809),g=i(g,h,m,_,c[u+12],11,3873151461),_=i(_,g,h,m,c[u+15],16,530742520),h=a(h,m=i(m,_,g,h,c[u+2],23,3299628645),_,g,c[u+0],6,4096336452),g=a(g,h,m,_,c[u+7],10,1126891415),_=a(_,g,h,m,c[u+14],15,2878612391),m=a(m,_,g,h,c[u+5],21,4237533241),h=a(h,m,_,g,c[u+12],6,1700485571),g=a(g,h,m,_,c[u+3],10,2399980690),_=a(_,g,h,m,c[u+10],15,4293915773),m=a(m,_,g,h,c[u+1],21,2240044497),h=a(h,m,_,g,c[u+8],6,1873313359),g=a(g,h,m,_,c[u+15],10,4264355552),_=a(_,g,h,m,c[u+6],15,2734768916),m=a(m,_,g,h,c[u+13],21,1309151649),h=a(h,m,_,g,c[u+4],6,4149444226),g=a(g,h,m,_,c[u+11],10,3174756917),_=a(_,g,h,m,c[u+2],15,718787259),m=a(m,_,g,h,c[u+9],21,3951481745),h=r(h,l),m=r(m,d),_=r(_,p),g=r(g,f);return(s(h)+s(m)+s(_)+s(g)).toLowerCase()}},this.Agent={},this.getBrowser=function(e){switch(!0){case this._Browsers.Edge.test(e):return this.Agent.isEdge=!0,"Edge";case this._Browsers.PhantomJS.test(e):return this.Agent.isPhantomJS=!0,"PhantomJS";case this._Browsers.Konqueror.test(e):return this.Agent.isKonqueror=!0,"Konqueror";case this._Browsers.Amaya.test(e):return this.Agent.isAmaya=!0,"Amaya";case this._Browsers.Epiphany.test(e):return this.Agent.isEpiphany=!0,"Epiphany";case this._Browsers.SeaMonkey.test(e):return this.Agent.isSeaMonkey=!0,"SeaMonkey";case this._Browsers.Flock.test(e):return this.Agent.isFlock=!0,"Flock";case this._Browsers.OmniWeb.test(e):return this.Agent.isOmniWeb=!0,"OmniWeb";case this._Browsers.Opera.test(e):return this.Agent.isOpera=!0,"Opera";case this._Browsers.Chromium.test(e):return this.Agent.isChrome=!0,"Chromium";case this._Browsers.Chrome.test(e):return this.Agent.isChrome=!0,"Chrome";case this._Browsers.Safari.test(e):return this.Agent.isSafari=!0,"Safari";case this._Browsers.WinJs.test(e):return this.Agent.isWinJs=!0,"WinJs";case this._Browsers.IE.test(e):return this.Agent.isIE=!0,"IE";case this._Browsers.PS3.test(e):return"ps3";case this._Browsers.PSP.test(e):return"psp";case this._Browsers.Firefox.test(e):return this.Agent.isFirefox=!0,"Firefox";case this._Browsers.UC.test(e):return this.Agent.isUC=!0,"UCBrowser";default:return 0!==e.indexOf("Mozilla")&&/^([\d\w\-\.]+)\/[\d\w\.\-]+/i.test(e)?(this.Agent.isAuthoritative=!1,RegExp.$1):"unknown"}},this.getBrowserVersion=function(e){switch(this.Agent.browser){case"Edge":if(this._Versions.Edge.test(e))return RegExp.$1;break;case"PhantomJS":if(this._Versions.PhantomJS.test(e))return RegExp.$1;break;case"Chrome":if(this._Versions.Chrome.test(e))return RegExp.$1;break;case"Chromium":if(this._Versions.Chromium.test(e))return RegExp.$1;break;case"Safari":if(this._Versions.Safari.test(e))return RegExp.$1;break;case"Opera":if(this._Versions.Opera.test(e))return RegExp.$1?RegExp.$1:RegExp.$2;break;case"Firefox":if(this._Versions.Firefox.test(e))return RegExp.$1;break;case"WinJs":if(this._Versions.WinJs.test(e))return RegExp.$1;break;case"IE":if(this._Versions.IE.test(e))return RegExp.$2?RegExp.$2:RegExp.$1;break;case"ps3":if(this._Versions.Ps3.test(e))return RegExp.$1;break;case"psp":if(this._Versions.Psp.test(e))return RegExp.$1;break;case"Amaya":if(this._Versions.Amaya.test(e))return RegExp.$1;break;case"Epiphany":if(this._Versions.Epiphany.test(e))return RegExp.$1;break;case"SeaMonkey":if(this._Versions.SeaMonkey.test(e))return RegExp.$1;break;case"Flock":if(this._Versions.Flock.test(e))return RegExp.$1;break;case"OmniWeb":if(this._Versions.OmniWeb.test(e))return RegExp.$1;break;case"UCBrowser":if(this._Versions.UC.test(e))return RegExp.$1;break;default:if("unknown"!==this.Agent.browser&&new RegExp(this.Agent.browser+"[\\/ ]([\\d\\w\\.\\-]+)","i").test(e))return RegExp.$1}},this.getOS=function(e){switch(!0){case this._OS.WindowsVista.test(e):return this.Agent.isWindows=!0,"Windows Vista";case this._OS.Windows7.test(e):return this.Agent.isWindows=!0,"Windows 7";case this._OS.Windows8.test(e):return this.Agent.isWindows=!0,"Windows 8";case this._OS.Windows81.test(e):return this.Agent.isWindows=!0,"Windows 8.1";case this._OS.Windows10.test(e):return this.Agent.isWindows=!0,"Windows 10.0";case this._OS.Windows2003.test(e):return this.Agent.isWindows=!0,"Windows 2003";case this._OS.WindowsXP.test(e):return this.Agent.isWindows=!0,"Windows XP";case this._OS.Windows2000.test(e):return this.Agent.isWindows=!0,"Windows 2000";case this._OS.WindowsPhone8.test(e):return"Windows Phone 8";case this._OS.Linux64.test(e):return this.Agent.isLinux=!0,this.Agent.isLinux64=!0,"Linux 64";case this._OS.Linux.test(e):return this.Agent.isLinux=!0,"Linux";case this._OS.ChromeOS.test(e):return this.Agent.isChromeOS=!0,"Chrome OS";case this._OS.Wii.test(e):return"Wii";case this._OS.PS3.test(e):case this._OS.PSP.test(e):return"Playstation";case this._OS.OSXCheetah.test(e):return this.Agent.isMac=!0,"OS X Cheetah";case this._OS.OSXPuma.test(e):return this.Agent.isMac=!0,"OS X Puma";case this._OS.OSXJaguar.test(e):return this.Agent.isMac=!0,"OS X Jaguar";case this._OS.OSXPanther.test(e):return this.Agent.isMac=!0,"OS X Panther";case this._OS.OSXTiger.test(e):return this.Agent.isMac=!0,"OS X Tiger";case this._OS.OSXLeopard.test(e):return this.Agent.isMac=!0,"OS X Leopard";case this._OS.OSXSnowLeopard.test(e):return this.Agent.isMac=!0,"OS X Snow Leopard";case this._OS.OSXLion.test(e):return this.Agent.isMac=!0,"OS X Lion";case this._OS.OSXMountainLion.test(e):return this.Agent.isMac=!0,"OS X Mountain Lion";case this._OS.OSXMavericks.test(e):return this.Agent.isMac=!0,"OS X Mavericks";case this._OS.OSXYosemite.test(e):return this.Agent.isMac=!0,"OS X Yosemite";case this._OS.OSXElCapitan.test(e):return this.Agent.isMac=!0,"OS X El Capitan";case this._OS.OSXSierra.test(e):return this.Agent.isMac=!0,"macOS Sierra";case this._OS.Mac.test(e):return this.Agent.isMac=!0,"OS X";case this._OS.iPad.test(e):return this.Agent.isiPad=!0,e.match(this._OS.iPad)[0].replace("_",".");case this._OS.iPhone.test(e):return this.Agent.isiPhone=!0,e.match(this._OS.iPhone)[0].replace("_",".");case this._OS.Bada.test(e):return this.Agent.isBada=!0,"Bada";case this._OS.Curl.test(e):return this.Agent.isCurl=!0,"Curl";default:return"unknown"}},this.getPlatform=function(e){switch(!0){case this._Platform.Windows.test(e):return"Microsoft Windows";case this._Platform.WindowsPhone.test(e):return this.Agent.isWindowsPhone=!0,"Microsoft Windows Phone";case this._Platform.Mac.test(e):return"Apple Mac";case this._Platform.Curl.test(e):return"Curl";case this._Platform.Android.test(e):return this.Agent.isAndroid=!0,"Android";case this._Platform.Blackberry.test(e):return this.Agent.isBlackberry=!0,"Blackberry";case this._Platform.Linux.test(e):return"Linux";case this._Platform.Wii.test(e):return"Wii";case this._Platform.Playstation.test(e):return"Playstation";case this._Platform.iPad.test(e):return this.Agent.isiPad=!0,"iPad";case this._Platform.iPod.test(e):return this.Agent.isiPod=!0,"iPod";case this._Platform.iPhone.test(e):return this.Agent.isiPhone=!0,"iPhone";case this._Platform.Samsung.test(e):return this.Agent.isiSamsung=!0,"Samsung";default:return"unknown"}},this.testCompatibilityMode=function(){var e=this;if(this.Agent.isIE&&/Trident\/(\d)\.0/i.test(e.Agent.source)){var t=parseInt(RegExp.$1,10),r=parseInt(e.Agent.version,10);7===r&&7===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=11),7===r&&6===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=10),7===r&&5===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=9),7===r&&4===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=8)}},this.testSilk=function(){switch(!0){case new RegExp("silk","gi").test(this.Agent.source):this.Agent.isSilk=!0}return/Silk-Accelerated=true/gi.test(this.Agent.source)&&(this.Agent.SilkAccelerated=!0),!!this.Agent.isSilk&&"Silk"},this.testKindleFire=function(){var e=this;switch(!0){case/KFOT/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire";case/KFTT/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD";case/KFJWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 8.9";case/KFJWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 8.9 4G";case/KFSOWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 7";case/KFTHWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 7";case/KFTHWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 7 4G";case/KFAPWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 8.9";case/KFAPWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 8.9 4G";default:return!1}},this.testCaptiveNetwork=function(){switch(!0){case/CaptiveNetwork/gi.test(this.Agent.source):return this.Agent.isCaptive=!0,this.Agent.isMac=!0,this.Agent.platform="Apple Mac","CaptiveNetwork";default:return!1}},this.testMobile=function(){var e=this;switch(!0){case e.Agent.isWindows:case e.Agent.isLinux:case e.Agent.isMac:case e.Agent.isChromeOS:e.Agent.isDesktop=!0;break;case e.Agent.isAndroid:case e.Agent.isSamsung:e.Agent.isMobile=!0,e.Agent.isDesktop=!1}switch(!0){case e.Agent.isiPad:case e.Agent.isiPod:case e.Agent.isiPhone:case e.Agent.isBada:case e.Agent.isBlackberry:case e.Agent.isAndroid:case e.Agent.isWindowsPhone:e.Agent.isMobile=!0,e.Agent.isDesktop=!1}/mobile/i.test(e.Agent.source)&&(e.Agent.isMobile=!0,e.Agent.isDesktop=!1)},this.testTablet=function(){var e=this;switch(!0){case e.Agent.isiPad:case e.Agent.isAndroidTablet:case e.Agent.isKindleFire:e.Agent.isTablet=!0}/tablet/i.test(e.Agent.source)&&(e.Agent.isTablet=!0)},this.testNginxGeoIP=function(e){var t=this;Object.keys(e).forEach((function(r){/^GEOIP/i.test(r)&&(t.Agent.geoIp[r]=e[r])}))},this.testBot=function(){var e=this,t=r.exec(e.Agent.source.toLowerCase());t?e.Agent.isBot=t[1]:e.Agent.isAuthoritative||(e.Agent.isBot=/bot/i.test(e.Agent.source))},this.testSmartTV=function(){var e=new RegExp("smart-tv|smarttv|googletv|appletv|hbbtv|pov_tv|netcast.tv","gi").exec(this.Agent.source.toLowerCase());e&&(this.Agent.isSmartTV=e[1])},this.testAndroidTablet=function(){this.Agent.isAndroid&&!/mobile/i.test(this.Agent.source)&&(this.Agent.isAndroidTablet=!0)},this.testTouchSupport=function(){this.Agent.isTouchScreen="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},this.getLaguage=function(){this.Agent.language=(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||"").toLowerCase()},this.getColorDepth=function(){this.Agent.colorDepth=screen.colorDepth||-1},this.getScreenResolution=function(){this.Agent.resolution=[screen.availWidth,screen.availHeight]},this.getPixelDepth=function(){this.Agent.pixelDepth=screen.pixelDepth||-1},this.getCPU=function(){this.Agent.cpuCores=navigator.hardwareConcurrency||-1},this.reset=function(){var e=this;for(var t in e.DefaultAgent)e.DefaultAgent.hasOwnProperty(t)&&(e.Agent[t]=e.DefaultAgent[t]);return e},this.parse=function(t){t=t||navigator.userAgent;var r=new e;return r.Agent.source=t.replace(/^\s*/,"").replace(/\s*$/,""),r.Agent.os=r.getOS(r.Agent.source),r.Agent.platform=r.getPlatform(r.Agent.source),r.Agent.browser=r.getBrowser(r.Agent.source),r.Agent.version=r.getBrowserVersion(r.Agent.source),r.testBot(),r.testSmartTV(),r.testMobile(),r.testAndroidTablet(),r.testTablet(),r.testCompatibilityMode(),r.testSilk(),r.testKindleFire(),r.testCaptiveNetwork(),r.testTouchSupport(),r.getLaguage(),r.getColorDepth(),r.getPixelDepth(),r.getScreenResolution(),r.getCPU(),r.Agent},this.get=function(e){var t=this.parse(),r=[];for(var n in this.options)this.options.hasOwnProperty(n)&&!0===this.options[n]&&r.push(t[n]);e&&r.push(e),!this.options.resolution&&t.isMobile&&r.push(t.resolution);var o=t.hashMD5(r.join(":"));return[o.slice(0,8),o.slice(8,12),"4"+o.slice(12,15),"b"+o.slice(15,18),o.slice(20)].join("-")},this.Agent=this.DefaultAgent,this}},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",(function(){return n}))},function(e,t,r){r(138),e.exports=r(139)},function(e,t,r){var n;e.exports=(n=r(0),r(12),r(59),r(60),r(6),r(7),r(18),r(28),r(61),r(29),r(62),r(63),r(64),r(19),r(65),r(5),r(2),r(66),r(67),r(68),r(69),r(70),r(71),r(72),r(73),r(74),r(75),r(76),r(77),r(78),r(79),r(80),r(81),n)},function(e,t,r){var n;e.exports=(n=r(0),function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var r=e.byteLength,n=[],o=0;o<r;o++)n[o>>>2]|=e[o]<<24-o%4*8;t.call(this,n,r)}else t.apply(this,arguments)}).prototype=e}}(),n.lib.WordArray)},function(e,t,r){var n;e.exports=(n=r(0),function(){var e=n,t=e.lib.WordArray,r=e.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o+=2){var i=t[o>>>2]>>>16-o%4*8&65535;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var r=e.length,n=[],o=0;o<r;o++)n[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(n,2*r)}},r.Utf16LE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i+=2){var a=o(t[i>>>2]>>>16-i%4*8&65535);n.push(String.fromCharCode(a))}return n.join("")},parse:function(e){for(var r=e.length,n=[],i=0;i<r;i++)n[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return t.create(n,2*r)}}}(),n.enc.Utf16)},function(e,t,r){var n,o,i,a,s,c;e.exports=(c=r(0),r(28),o=(n=c).lib.WordArray,i=n.algo,a=i.SHA256,s=i.SHA224=a.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}}),n.SHA224=a._createHelper(s),n.HmacSHA224=a._createHmacHelper(s),c.SHA224)},function(e,t,r){var n,o,i,a,s,c,u,l;e.exports=(l=r(0),r(12),r(29),o=(n=l).x64,i=o.Word,a=o.WordArray,s=n.algo,c=s.SHA512,u=s.SHA384=c.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=c._doFinalize.call(this);return e.sigBytes-=16,e}}),n.SHA384=c._createHelper(u),n.HmacSHA384=c._createHmacHelper(u),l.SHA384)},function(e,t,r){var n;e.exports=(n=r(0),r(12),function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.x64.Word,s=t.algo,c=[],u=[],l=[];!function(){for(var e=1,t=0,r=0;r<24;r++){c[e+5*t]=(r+1)*(r+2)/2%64;var n=(2*e+3*t)%5;e=t%5,t=n}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,i=0;i<24;i++){for(var s=0,d=0,p=0;p<7;p++){if(1&o){var f=(1<<p)-1;f<32?d^=1<<f:s^=1<<f-32}128&o?o=o<<1^113:o<<=1}l[i]=a.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=a.create()}();var p=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var r=this._state,n=this.blockSize/2,o=0;o<n;o++){var i=e[t+2*o],a=e[t+2*o+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(A=r[o]).high^=a,A.low^=i}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var f=0,h=0,m=0;m<5;m++)f^=(A=r[p+5*m]).high,h^=A.low;var _=d[p];_.high=f,_.low=h}for(p=0;p<5;p++){var g=d[(p+4)%5],v=d[(p+1)%5],y=v.high,b=v.low;for(f=g.high^(y<<1|b>>>31),h=g.low^(b<<1|y>>>31),m=0;m<5;m++)(A=r[p+5*m]).high^=f,A.low^=h}for(var w=1;w<25;w++){var S=(A=r[w]).high,k=A.low,C=c[w];C<32?(f=S<<C|k>>>32-C,h=k<<C|S>>>32-C):(f=k<<C-32|S>>>64-C,h=S<<C-32|k>>>64-C);var E=d[u[w]];E.high=f,E.low=h}var T=d[0],P=r[0];for(T.high=P.high,T.low=P.low,p=0;p<5;p++)for(m=0;m<5;m++){var A=r[w=p+5*m],R=d[w],O=d[(p+1)%5+5*m],x=d[(p+2)%5+5*m];A.high=R.high^~O.high&x.high,A.low=R.low^~O.low&x.low}A=r[0];var M=l[s];A.high^=M.high,A.low^=M.low}},_doFinalize:function(){var t=this._data,r=t.words,n=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;r[n>>>5]|=1<<24-n%32,r[(e.ceil((n+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*r.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,c=s/8,u=[],l=0;l<c;l++){var d=a[l],p=d.high,f=d.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),u.push(f),u.push(p)}return new o.init(u,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),r=0;r<25;r++)t[r]=t[r].clone();return e}});t.SHA3=i._createHelper(p),t.HmacSHA3=i._createHmacHelper(p)}(Math),n.SHA3)},function(e,t,r){var n;e.exports=(n=r(0),function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=o.create([0,1518500249,1859775393,2400959708,2840853838]),p=o.create([1352829926,1548603684,1836072691,2053994217,0]),f=a.RIPEMD160=i.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,o=e[n];e[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i,a,f,b,w,S,k,C,E,T,P,A=this._hash.words,R=d.words,O=p.words,x=s.words,M=c.words,D=u.words,I=l.words;for(S=i=A[0],k=a=A[1],C=f=A[2],E=b=A[3],T=w=A[4],r=0;r<80;r+=1)P=i+e[t+x[r]]|0,P+=r<16?h(a,f,b)+R[0]:r<32?m(a,f,b)+R[1]:r<48?_(a,f,b)+R[2]:r<64?g(a,f,b)+R[3]:v(a,f,b)+R[4],P=(P=y(P|=0,D[r]))+w|0,i=w,w=b,b=y(f,10),f=a,a=P,P=S+e[t+M[r]]|0,P+=r<16?v(k,C,E)+O[0]:r<32?g(k,C,E)+O[1]:r<48?_(k,C,E)+O[2]:r<64?m(k,C,E)+O[3]:h(k,C,E)+O[4],P=(P=y(P|=0,I[r]))+T|0,S=T,T=E,E=y(C,10),C=k,k=P;P=A[1]+f+E|0,A[1]=A[2]+b+T|0,A[2]=A[3]+w+S|0,A[3]=A[4]+i+k|0,A[4]=A[0]+a+C|0,A[0]=P},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,i=o.words,a=0;a<5;a++){var s=i[a];i[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return o},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,r){return e^t^r}function m(e,t,r){return e&t|~e&r}function _(e,t,r){return(e|~t)^r}function g(e,t,r){return e&r|t&~r}function v(e,t,r){return e^(t|~r)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(f),t.HmacRIPEMD160=i._createHmacHelper(f)}(Math),n.RIPEMD160)},function(e,t,r){var n,o,i,a,s,c,u,l,d;e.exports=(d=r(0),r(18),r(19),o=(n=d).lib,i=o.Base,a=o.WordArray,s=n.algo,c=s.SHA1,u=s.HMAC,l=s.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=u.create(r.hasher,e),o=a.create(),i=a.create([1]),s=o.words,c=i.words,l=r.keySize,d=r.iterations;s.length<l;){var p=n.update(t).finalize(i);n.reset();for(var f=p.words,h=f.length,m=p,_=1;_<d;_++){m=n.finalize(m),n.reset();for(var g=m.words,v=0;v<h;v++)f[v]^=g[v]}o.concat(p),c[0]++}return o.sigBytes=4*l,o}}),n.PBKDF2=function(e,t,r){return l.create(r).compute(e,t)},d.PBKDF2)},function(e,t,r){var n;e.exports=(n=r(0),r(2),n.mode.CFB=function(){var e=n.lib.BlockCipherMode.extend();function t(e,t,r,n){var o=this._iv;if(o){var i=o.slice(0);this._iv=void 0}else i=this._prevBlock;n.encryptBlock(i,0);for(var a=0;a<r;a++)e[t+a]^=i[a]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize;t.call(this,e,r,o,n),this._prevBlock=e.slice(r,r+o)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize,i=e.slice(r,r+o);t.call(this,e,r,o,n),this._prevBlock=i}}),e}(),n.mode.CFB)},function(e,t,r){var n,o,i;e.exports=(i=r(0),r(2),i.mode.CTR=(n=i.lib.BlockCipherMode.extend(),o=n.Encryptor=n.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0);var a=i.slice(0);r.encryptBlock(a,0),i[n-1]=i[n-1]+1|0;for(var s=0;s<n;s++)e[t+s]^=a[s]}}),n.Decryptor=o,n),i.mode.CTR)},function(e,t,r){var n;e.exports=(n=r(0),r(2),n.mode.CTRGladman=function(){var e=n.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,r=e>>8&255,n=255&e;255===t?(t=0,255===r?(r=0,255===n?n=0:++n):++r):++t,e=0,e+=t<<16,e+=r<<8,e+=n}else e+=1<<24;return e}var r=e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);n.encryptBlock(s,0);for(var c=0;c<o;c++)e[r+c]^=s[c]}});return e.Decryptor=r,e}(),n.mode.CTRGladman)},function(e,t,r){var n,o,i;e.exports=(i=r(0),r(2),i.mode.OFB=(n=i.lib.BlockCipherMode.extend(),o=n.Encryptor=n.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,o=this._iv,i=this._keystream;o&&(i=this._keystream=o.slice(0),this._iv=void 0),r.encryptBlock(i,0);for(var a=0;a<n;a++)e[t+a]^=i[a]}}),n.Decryptor=o,n),i.mode.OFB)},function(e,t,r){var n,o;e.exports=(o=r(0),r(2),o.mode.ECB=((n=o.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),n.Decryptor=n.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),n),o.mode.ECB)},function(e,t,r){var n;e.exports=(n=r(0),r(2),n.pad.AnsiX923={pad:function(e,t){var r=e.sigBytes,n=4*t,o=n-r%n,i=r+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Ansix923)},function(e,t,r){var n;e.exports=(n=r(0),r(2),n.pad.Iso10126={pad:function(e,t){var r=4*t,o=r-e.sigBytes%r;e.concat(n.lib.WordArray.random(o-1)).concat(n.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Iso10126)},function(e,t,r){var n;e.exports=(n=r(0),r(2),n.pad.Iso97971={pad:function(e,t){e.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(e,t)},unpad:function(e){n.pad.ZeroPadding.unpad(e),e.sigBytes--}},n.pad.Iso97971)},function(e,t,r){var n;e.exports=(n=r(0),r(2),n.pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){for(var t=e.words,r=e.sigBytes-1;!(t[r>>>2]>>>24-r%4*8&255);)r--;e.sigBytes=r+1}},n.pad.ZeroPadding)},function(e,t,r){var n;e.exports=(n=r(0),r(2),n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)},function(e,t,r){var n,o,i,a;e.exports=(a=r(0),r(2),o=(n=a).lib.CipherParams,i=n.enc.Hex,n.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return o.create({ciphertext:t})}},a.format.Hex)},function(e,t,r){var n;e.exports=(n=r(0),r(6),r(7),r(5),r(2),function(){var e=n,t=e.lib.BlockCipher,r=e.algo,o=[],i=[],a=[],s=[],c=[],u=[],l=[],d=[],p=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,n=0;for(t=0;t<256;t++){var h=n^n<<1^n<<2^n<<3^n<<4;h=h>>>8^255&h^99,o[r]=h,i[h]=r;var m=e[r],_=e[m],g=e[_],v=257*e[h]^16843008*h;a[r]=v<<24|v>>>8,s[r]=v<<16|v>>>16,c[r]=v<<8|v>>>24,u[r]=v,v=16843009*g^65537*_^257*m^16843008*r,l[h]=v<<24|v>>>8,d[h]=v<<16|v>>>16,p[h]=v<<8|v>>>24,f[h]=v,r?(r=m^e[e[e[g^m]]],n^=e[e[n]]):r=n=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],m=r.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,n=4*((this._nRounds=r+6)+1),i=this._keySchedule=[],a=0;a<n;a++)if(a<r)i[a]=t[a];else{var s=i[a-1];a%r?r>6&&a%r==4&&(s=o[s>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s]):(s=o[(s=s<<8|s>>>24)>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s],s^=h[a/r|0]<<24),i[a]=i[a-r]^s}for(var c=this._invKeySchedule=[],u=0;u<n;u++)a=n-u,s=u%4?i[a]:i[a-4],c[u]=u<4||a<=4?s:l[o[s>>>24]]^d[o[s>>>16&255]]^p[o[s>>>8&255]]^f[o[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,c,u,o)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,l,d,p,f,i),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,o,i,a,s){for(var c=this._nRounds,u=e[t]^r[0],l=e[t+1]^r[1],d=e[t+2]^r[2],p=e[t+3]^r[3],f=4,h=1;h<c;h++){var m=n[u>>>24]^o[l>>>16&255]^i[d>>>8&255]^a[255&p]^r[f++],_=n[l>>>24]^o[d>>>16&255]^i[p>>>8&255]^a[255&u]^r[f++],g=n[d>>>24]^o[p>>>16&255]^i[u>>>8&255]^a[255&l]^r[f++],v=n[p>>>24]^o[u>>>16&255]^i[l>>>8&255]^a[255&d]^r[f++];u=m,l=_,d=g,p=v}m=(s[u>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^r[f++],_=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&u])^r[f++],g=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[u>>>8&255]<<8|s[255&l])^r[f++],v=(s[p>>>24]<<24|s[u>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^r[f++],e[t]=m,e[t+1]=_,e[t+2]=g,e[t+3]=v},keySize:8});e.AES=t._createHelper(m)}(),n.AES)},function(e,t,r){var n;e.exports=(n=r(0),r(6),r(7),r(5),r(2),function(){var e=n,t=e.lib,r=t.WordArray,o=t.BlockCipher,i=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=i.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],r=0;r<56;r++){var n=a[r]-1;t[r]=e[n>>>5]>>>31-n%32&1}for(var o=this._subKeys=[],i=0;i<16;i++){var u=o[i]=[],l=c[i];for(r=0;r<24;r++)u[r/6|0]|=t[(s[r]-1+l)%28]<<31-r%6,u[4+(r/6|0)]|=t[28+(s[r+24]-1+l)%28]<<31-r%6;for(u[0]=u[0]<<1|u[0]>>>31,r=1;r<7;r++)u[r]=u[r]>>>4*(r-1)+3;u[7]=u[7]<<5|u[7]>>>27}var d=this._invSubKeys=[];for(r=0;r<16;r++)d[r]=o[15-r]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,r){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),p.call(this,1,1431655765);for(var n=0;n<16;n++){for(var o=r[n],i=this._lBlock,a=this._rBlock,s=0,c=0;c<8;c++)s|=u[c][((a^o[c])&l[c])>>>0];this._lBlock=a,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,p.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var r=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=r,this._lBlock^=r<<e}function f(e,t){var r=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=r,this._rBlock^=r<<e}e.DES=o._createHelper(d);var h=i.TripleDES=o.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(r.create(e.slice(0,2))),this._des2=d.createEncryptor(r.create(e.slice(2,4))),this._des3=d.createEncryptor(r.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=o._createHelper(h)}(),n.TripleDES)},function(e,t,r){var n;e.exports=(n=r(0),r(6),r(7),r(5),r(2),function(){var e=n,t=e.lib.StreamCipher,r=e.algo,o=r.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,r=e.sigBytes,n=this._S=[],o=0;o<256;o++)n[o]=o;o=0;for(var i=0;o<256;o++){var a=o%r,s=t[a>>>2]>>>24-a%4*8&255;i=(i+n[o]+s)%256;var c=n[o];n[o]=n[i],n[i]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,r=this._j,n=0,o=0;o<4;o++){r=(r+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[r],e[r]=i,n|=e[(e[t]+e[r])%256]<<24-8*o}return this._i=t,this._j=r,n}e.RC4=t._createHelper(o);var a=r.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(a)}(),n.RC4)},function(e,t,r){var n;e.exports=(n=r(0),r(6),r(7),r(5),r(2),function(){var e=n,t=e.lib.StreamCipher,r=e.algo,o=[],i=[],a=[],s=r.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,r=0;r<4;r++)e[r]=16711935&(e[r]<<8|e[r]>>>24)|4278255360&(e[r]<<24|e[r]>>>8);var n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,r=0;r<4;r++)c.call(this);for(r=0;r<8;r++)o[r]^=n[r+4&7];if(t){var i=t.words,a=i[0],s=i[1],u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=u>>>16|4294901760&l,p=l<<16|65535&u;for(o[0]^=u,o[1]^=d,o[2]^=l,o[3]^=p,o[4]^=u,o[5]^=d,o[6]^=l,o[7]^=p,r=0;r<4;r++)c.call(this)}},_doProcessBlock:function(e,t){var r=this._X;c.call(this),o[0]=r[0]^r[5]>>>16^r[3]<<16,o[1]=r[2]^r[7]>>>16^r[5]<<16,o[2]=r[4]^r[1]>>>16^r[7]<<16,o[3]=r[6]^r[3]>>>16^r[1]<<16;for(var n=0;n<4;n++)o[n]=16711935&(o[n]<<8|o[n]>>>24)|4278255360&(o[n]<<24|o[n]>>>8),e[t+n]^=o[n]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,r=0;r<8;r++)i[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,r=0;r<8;r++){var n=e[r]+t[r],o=65535&n,s=n>>>16,c=((o*o>>>17)+o*s>>>15)+s*s,u=((4294901760&n)*n|0)+((65535&n)*n|0);a[r]=c^u}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(s)}(),n.Rabbit)},function(e,t,r){var n;e.exports=(n=r(0),r(6),r(7),r(5),r(2),function(){var e=n,t=e.lib.StreamCipher,r=e.algo,o=[],i=[],a=[],s=r.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)c.call(this);for(o=0;o<8;o++)n[o]^=r[o+4&7];if(t){var i=t.words,a=i[0],s=i[1],u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=u>>>16|4294901760&l,p=l<<16|65535&u;for(n[0]^=u,n[1]^=d,n[2]^=l,n[3]^=p,n[4]^=u,n[5]^=d,n[6]^=l,n[7]^=p,o=0;o<4;o++)c.call(this)}},_doProcessBlock:function(e,t){var r=this._X;c.call(this),o[0]=r[0]^r[5]>>>16^r[3]<<16,o[1]=r[2]^r[7]>>>16^r[5]<<16,o[2]=r[4]^r[1]>>>16^r[7]<<16,o[3]=r[6]^r[3]>>>16^r[1]<<16;for(var n=0;n<4;n++)o[n]=16711935&(o[n]<<8|o[n]>>>24)|4278255360&(o[n]<<24|o[n]>>>8),e[t+n]^=o[n]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,r=0;r<8;r++)i[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,r=0;r<8;r++){var n=e[r]+t[r],o=65535&n,s=n>>>16,c=((o*o>>>17)+o*s>>>15)+s*s,u=((4294901760&n)*n|0)+((65535&n)*n|0);a[r]=c^u}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(s)}(),n.RabbitLegacy)},function(e,t){e.exports={aes_secret:">|Z2i580Py*4C3r"}},function(e,t,r){"use strict";var n=r(13),o=r(85),i=r(89),a=r(90)||0;function s(){return o(a)}e.exports=s,e.exports.generate=s,e.exports.seed=function(t){return n.seed(t),e.exports},e.exports.worker=function(t){return a=t,e.exports},e.exports.characters=function(e){return void 0!==e&&n.characters(e),n.shuffled()},e.exports.isValid=i},function(e,t,r){"use strict";var n=1;e.exports={nextValue:function(){return(n=(9301*n+49297)%233280)/233280},seed:function(e){n=e}}},function(e,t,r){"use strict";var n,o,i=r(86);r(13);e.exports=function(e){var t="",r=Math.floor(.001*(Date.now()-1567752802062));return r===o?n++:(n=0,o=r),t+=i(7),t+=i(e),n>0&&(t+=i(n)),t+=i(r)}},function(e,t,r){"use strict";var n=r(13),o=r(87),i=r(88);e.exports=function(e){for(var t,r=0,a="";!t;)a+=i(o,n.get(),1),t=e<Math.pow(16,r+1),r++;return a}},function(e,t,r){"use strict";var n,o="object"==typeof window&&(window.crypto||window.msCrypto);n=o&&o.getRandomValues?function(e){return o.getRandomValues(new Uint8Array(e))}:function(e){for(var t=[],r=0;r<e;r++)t.push(Math.floor(256*Math.random()));return t},e.exports=n},function(e,t){e.exports=function(e,t,r){for(var n=(2<<Math.log(t.length-1)/Math.LN2)-1,o=-~(1.6*n*r/t.length),i="";;)for(var a=e(o),s=o;s--;)if((i+=t[a[s]&n]||"").length===+r)return i}},function(e,t,r){"use strict";var n=r(13);e.exports=function(e){return!(!e||"string"!=typeof e||e.length<6)&&!new RegExp("[^"+n.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(e)}},function(e,t,r){"use strict";e.exports=0},function(e,t,r){"use strict";var n;window.jscolor||(window.jscolor=((n={register:function(){n.attachDOMReadyEvent(n.init),n.attachEvent(document,"mousedown",n.onDocumentMouseDown),n.attachEvent(document,"touchstart",n.onDocumentTouchStart),n.attachEvent(window,"resize",n.onWindowResize)},init:function(){n.jscolor.lookupClass&&n.jscolor.installByClassName(n.jscolor.lookupClass)},tryInstallOnElements:function(e,t){for(var r=new RegExp("(^|\\s)("+t+")(\\s*(\\{[^}]*\\})|\\s|$)","i"),o=0;o<e.length;o+=1){var i;if((void 0===e[o].type||"color"!=e[o].type.toLowerCase()||!n.isColorAttrSupported)&&!e[o].jscolor&&e[o].className&&(i=e[o].className.match(r))){var a=e[o],s=null,c=n.getDataAttr(a,"jscolor");null!==c?s=c:i[4]&&(s=i[4]);var u={};if(s)try{u=new Function("return ("+s+")")()}catch(e){n.warn("Error parsing jscolor options: "+e+":\n"+s)}a.jscolor=new n.jscolor(a,u)}}},isColorAttrSupported:function(){var e=document.createElement("input");return!(!e.setAttribute||(e.setAttribute("type","color"),"color"!=e.type.toLowerCase()))}(),isCanvasSupported:function(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}(),fetchElement:function(e){return"string"==typeof e?document.getElementById(e):e},isElementType:function(e,t){return e.nodeName.toLowerCase()===t.toLowerCase()},getDataAttr:function(e,t){var r="data-"+t,n=e.getAttribute(r);return null!==n?n:null},attachEvent:function(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent&&e.attachEvent("on"+t,r)},detachEvent:function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent&&e.detachEvent("on"+t,r)},_attachedGroupEvents:{},attachGroupEvent:function(e,t,r,o){n._attachedGroupEvents.hasOwnProperty(e)||(n._attachedGroupEvents[e]=[]),n._attachedGroupEvents[e].push([t,r,o]),n.attachEvent(t,r,o)},detachGroupEvents:function(e){if(n._attachedGroupEvents.hasOwnProperty(e)){for(var t=0;t<n._attachedGroupEvents[e].length;t+=1){var r=n._attachedGroupEvents[e][t];n.detachEvent(r[0],r[1],r[2])}delete n._attachedGroupEvents[e]}},attachDOMReadyEvent:function(e){var t=!1,r=function(){t||(t=!0,e())};"complete"!==document.readyState?document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),r())})),window.attachEvent("onload",r),document.documentElement.doScroll&&window==window.top)&&function e(){if(document.body)try{document.documentElement.doScroll("left"),r()}catch(t){setTimeout(e,1)}}():setTimeout(r,1)},warn:function(e){window.console&&window.console.warn&&window.console.warn(e)},preventDefault:function(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1},captureTarget:function(e){e.setCapture&&(n._capturedTarget=e,n._capturedTarget.setCapture())},releaseTarget:function(){n._capturedTarget&&(n._capturedTarget.releaseCapture(),n._capturedTarget=null)},fireEvent:function(e,t){if(e)if(document.createEvent)(r=document.createEvent("HTMLEvents")).initEvent(t,!0,!0),e.dispatchEvent(r);else if(document.createEventObject){var r=document.createEventObject();e.fireEvent("on"+t,r)}else e["on"+t]&&e["on"+t]()},classNameToList:function(e){return e.replace(/^\s+|\s+$/g,"").split(/\s+/)},hasClass:function(e,t){return!!t&&-1!=(" "+e.className.replace(/\s+/g," ")+" ").indexOf(" "+t+" ")},setClass:function(e,t){for(var r=n.classNameToList(t),o=0;o<r.length;o+=1)n.hasClass(e,r[o])||(e.className+=(e.className?" ":"")+r[o])},unsetClass:function(e,t){for(var r=n.classNameToList(t),o=0;o<r.length;o+=1){var i=new RegExp("^\\s*"+r[o]+"\\s*|\\s*"+r[o]+"\\s*$|\\s+"+r[o]+"(\\s+)","g");e.className=e.className.replace(i,"$1")}},getStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle},setStyle:function(){var e=document.createElement("div"),t=function(t){for(var r=0;r<t.length;r+=1)if(t[r]in e.style)return t[r]},r={borderRadius:t(["borderRadius","MozBorderRadius","webkitBorderRadius"]),boxShadow:t(["boxShadow","MozBoxShadow","webkitBoxShadow"])};return function(e,t,n){switch(t.toLowerCase()){case"opacity":var o=Math.round(100*parseFloat(n));e.style.opacity=n,e.style.filter="alpha(opacity="+o+")";break;default:e.style[r[t]]=n}}}(),setBorderRadius:function(e,t){n.setStyle(e,"borderRadius",t||"0")},setBoxShadow:function(e,t){n.setStyle(e,"boxShadow",t||"none")},getElementPos:function(e,t){var r=0,o=0,i=e.getBoundingClientRect();if(r=i.left,o=i.top,!t){var a=n.getViewPos();r+=a[0],o+=a[1]}return[r,o]},getElementSize:function(e){return[e.offsetWidth,e.offsetHeight]},getAbsPointerPos:function(e){e||(e=window.event);var t=0,r=0;return void 0!==e.changedTouches&&e.changedTouches.length?(t=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(t=e.clientX,r=e.clientY),{x:t,y:r}},getRelPointerPos:function(e){e||(e=window.event);var t=(e.target||e.srcElement).getBoundingClientRect(),r=0,n=0;return void 0!==e.changedTouches&&e.changedTouches.length?(r=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(r=e.clientX,n=e.clientY),{x:r-t.left,y:n-t.top}},getViewPos:function(){var e=document.documentElement;return[(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0),(window.pageYOffset||e.scrollTop)-(e.clientTop||0)]},getViewSize:function(){var e=document.documentElement;return[window.innerWidth||e.clientWidth,window.innerHeight||e.clientHeight]},redrawPosition:function(){if(n.picker&&n.picker.owner){var e,t,r=n.picker.owner;r.fixed?(e=n.getElementPos(r.targetElement,!0),t=[0,0]):(e=n.getElementPos(r.targetElement),t=n.getViewPos());var o,i,a,s=n.getElementSize(r.targetElement),c=n.getViewSize(),u=n.getPickerOuterDims(r);switch(r.position.toLowerCase()){case"left":o=1,i=0,a=-1;break;case"right":o=1,i=0,a=1;break;case"top":o=0,i=1,a=-1;break;default:o=0,i=1,a=1}var l=(s[i]+u[i])/2;if(r.smartPosition)d=[-t[o]+e[o]+u[o]>c[o]&&-t[o]+e[o]+s[o]/2>c[o]/2&&e[o]+s[o]-u[o]>=0?e[o]+s[o]-u[o]:e[o],-t[i]+e[i]+s[i]+u[i]-l+l*a>c[i]?-t[i]+e[i]+s[i]/2>c[i]/2&&e[i]+s[i]-l-l*a>=0?e[i]+s[i]-l-l*a:e[i]+s[i]-l+l*a:e[i]+s[i]-l+l*a>=0?e[i]+s[i]-l+l*a:e[i]+s[i]-l-l*a];else var d=[e[o],e[i]+s[i]-l+l*a];var p=d[o],f=d[i],h=r.fixed?"fixed":"absolute",m=(d[0]+u[0]>e[0]||d[0]<e[0]+s[0])&&d[1]+u[1]<e[1]+s[1];n._drawPosition(r,p,f,h,m)}},_drawPosition:function(e,t,r,o,i){var a=i?0:e.shadowBlur;n.picker.wrap.style.position=o,n.picker.wrap.style.left=t+"px",n.picker.wrap.style.top=r+"px",n.setBoxShadow(n.picker.boxS,e.shadow?new n.BoxShadow(0,a,e.shadowBlur,0,e.shadowColor):null)},getPickerDims:function(e){var t=!!n.getSliderComponent(e);return[2*e.insetWidth+2*e.padding+e.width+(t?2*e.insetWidth+n.getPadToSliderPadding(e)+e.sliderSize:0),2*e.insetWidth+2*e.padding+e.height+(e.closable?2*e.insetWidth+e.padding+e.buttonHeight:0)]},getPickerOuterDims:function(e){var t=n.getPickerDims(e);return[t[0]+2*e.borderWidth,t[1]+2*e.borderWidth]},getPadToSliderPadding:function(e){return Math.max(e.padding,1.5*(2*e.pointerBorderWidth+e.pointerThickness))},getPadYComponent:function(e){switch(e.mode.charAt(1).toLowerCase()){case"v":return"v"}return"s"},getSliderComponent:function(e){if(e.mode.length>2)switch(e.mode.charAt(2).toLowerCase()){case"s":return"s";case"v":return"v"}return null},onDocumentMouseDown:function(e){e||(e=window.event);var t=e.target||e.srcElement;t._jscLinkedInstance?t._jscLinkedInstance.showOnClick&&t._jscLinkedInstance.show():t._jscControlName?n.onControlPointerStart(e,t,t._jscControlName,"mouse"):n.picker&&n.picker.owner&&n.picker.owner.hide()},onDocumentTouchStart:function(e){e||(e=window.event);var t=e.target||e.srcElement;t._jscLinkedInstance?t._jscLinkedInstance.showOnClick&&t._jscLinkedInstance.show():t._jscControlName?n.onControlPointerStart(e,t,t._jscControlName,"touch"):n.picker&&n.picker.owner&&n.picker.owner.hide()},onWindowResize:function(e){n.redrawPosition()},onParentScroll:function(e){n.picker&&n.picker.owner&&n.picker.owner.hide()},_pointerMoveEvent:{mouse:"mousemove",touch:"touchmove"},_pointerEndEvent:{mouse:"mouseup",touch:"touchend"},_pointerOrigin:null,_capturedTarget:null,onControlPointerStart:function(e,t,r,o){var i=t._jscInstance;n.preventDefault(e),n.captureTarget(t);var a=function(i,a){n.attachGroupEvent("drag",i,n._pointerMoveEvent[o],n.onDocumentPointerMove(e,t,r,o,a)),n.attachGroupEvent("drag",i,n._pointerEndEvent[o],n.onDocumentPointerEnd(e,t,r,o))};if(a(document,[0,0]),window.parent&&window.frameElement){var s=window.frameElement.getBoundingClientRect(),c=[-s.left,-s.top];a(window.parent.window.document,c)}var u=n.getAbsPointerPos(e),l=n.getRelPointerPos(e);switch(n._pointerOrigin={x:u.x-l.x,y:u.y-l.y},r){case"pad":switch(n.getSliderComponent(i)){case"s":0===i.hsv[1]&&i.fromHSV(null,100,null);break;case"v":0===i.hsv[2]&&i.fromHSV(null,null,100)}n.setPad(i,e,0,0);break;case"sld":n.setSld(i,e,0)}n.dispatchFineChange(i)},onDocumentPointerMove:function(e,t,r,o,i){return function(e){var o=t._jscInstance;switch(r){case"pad":e||(e=window.event),n.setPad(o,e,i[0],i[1]),n.dispatchFineChange(o);break;case"sld":e||(e=window.event),n.setSld(o,e,i[1]),n.dispatchFineChange(o)}}},onDocumentPointerEnd:function(e,t,r,o){return function(e){var r=t._jscInstance;n.detachGroupEvents("drag"),n.releaseTarget(),n.dispatchChange(r)}},dispatchChange:function(e){e.valueElement&&n.isElementType(e.valueElement,"input")&&n.fireEvent(e.valueElement,"change")},dispatchFineChange:function(e){e.onFineChange&&("string"==typeof e.onFineChange?new Function(e.onFineChange):e.onFineChange).call(e)},setPad:function(e,t,r,o){var i=n.getAbsPointerPos(t),a=r+i.x-n._pointerOrigin.x-e.padding-e.insetWidth,s=o+i.y-n._pointerOrigin.y-e.padding-e.insetWidth,c=a*(360/(e.width-1)),u=100-s*(100/(e.height-1));switch(n.getPadYComponent(e)){case"s":e.fromHSV(c,u,null,n.leaveSld);break;case"v":e.fromHSV(c,null,u,n.leaveSld)}},setSld:function(e,t,r){var o=100-(r+n.getAbsPointerPos(t).y-n._pointerOrigin.y-e.padding-e.insetWidth)*(100/(e.height-1));switch(n.getSliderComponent(e)){case"s":e.fromHSV(null,o,null,n.leavePad);break;case"v":e.fromHSV(null,null,o,n.leavePad)}},_vmlNS:"jsc_vml_",_vmlCSS:"jsc_vml_css_",_vmlReady:!1,initVML:function(){if(!n._vmlReady){var e=document;if(e.namespaces[n._vmlNS]||e.namespaces.add(n._vmlNS,"urn:schemas-microsoft-com:vml"),!e.styleSheets[n._vmlCSS]){var t=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","rect","roundrect","oval","arc","image"],r=e.createStyleSheet();r.owningElement.id=n._vmlCSS;for(var o=0;o<t.length;o+=1)r.addRule(n._vmlNS+"\\:"+t[o],"behavior:url(#default#VML);")}n._vmlReady=!0}},createPalette:function(){var e={elm:null,draw:null};if(n.isCanvasSupported){var t=document.createElement("canvas"),r=t.getContext("2d"),o=function(e,n,o){t.width=e,t.height=n,r.clearRect(0,0,t.width,t.height);var i=r.createLinearGradient(0,0,t.width,0);i.addColorStop(0,"#F00"),i.addColorStop(1/6,"#FF0"),i.addColorStop(2/6,"#0F0"),i.addColorStop(.5,"#0FF"),i.addColorStop(4/6,"#00F"),i.addColorStop(5/6,"#F0F"),i.addColorStop(1,"#F00"),r.fillStyle=i,r.fillRect(0,0,t.width,t.height);var a=r.createLinearGradient(0,0,0,t.height);switch(o.toLowerCase()){case"s":a.addColorStop(0,"rgba(255,255,255,0)"),a.addColorStop(1,"rgba(255,255,255,1)");break;case"v":a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)")}r.fillStyle=a,r.fillRect(0,0,t.width,t.height)};e.elm=t,e.draw=o}else{n.initVML();var i=document.createElement("div");i.style.position="relative",i.style.overflow="hidden";var a=document.createElement(n._vmlNS+":fill");a.type="gradient",a.method="linear",a.angle="90",a.colors="16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0";var s=document.createElement(n._vmlNS+":rect");s.style.position="absolute",s.style.left="-1px",s.style.top="-1px",s.stroked=!1,s.appendChild(a),i.appendChild(s);var c=document.createElement(n._vmlNS+":fill");c.type="gradient",c.method="linear",c.angle="180",c.opacity="0";var u=document.createElement(n._vmlNS+":rect");u.style.position="absolute",u.style.left="-1px",u.style.top="-1px",u.stroked=!1,u.appendChild(c),i.appendChild(u),o=function(e,t,r){switch(i.style.width=e+"px",i.style.height=t+"px",s.style.width=u.style.width=e+1+"px",s.style.height=u.style.height=t+1+"px",a.color="#F00",a.color2="#F00",r.toLowerCase()){case"s":c.color=c.color2="#FFF";break;case"v":c.color=c.color2="#000"}},e.elm=i,e.draw=o}return e},createSliderGradient:function(){var e={elm:null,draw:null};if(n.isCanvasSupported){var t=document.createElement("canvas"),r=t.getContext("2d"),o=function(e,n,o,i){t.width=e,t.height=n,r.clearRect(0,0,t.width,t.height);var a=r.createLinearGradient(0,0,0,t.height);a.addColorStop(0,o),a.addColorStop(1,i),r.fillStyle=a,r.fillRect(0,0,t.width,t.height)};e.elm=t,e.draw=o}else{n.initVML();var i=document.createElement("div");i.style.position="relative",i.style.overflow="hidden";var a=document.createElement(n._vmlNS+":fill");a.type="gradient",a.method="linear",a.angle="180";var s=document.createElement(n._vmlNS+":rect");s.style.position="absolute",s.style.left="-1px",s.style.top="-1px",s.stroked=!1,s.appendChild(a),i.appendChild(s),o=function(e,t,r,n){i.style.width=e+"px",i.style.height=t+"px",s.style.width=e+1+"px",s.style.height=t+1+"px",a.color=r,a.color2=n},e.elm=i,e.draw=o}return e},leaveValue:1,leaveStyle:2,leavePad:4,leaveSld:8,BoxShadow:function(){var e=function(e,t,r,n,o,i){this.hShadow=e,this.vShadow=t,this.blur=r,this.spread=n,this.color=o,this.inset=!!i};return e.prototype.toString=function(){var e=[Math.round(this.hShadow)+"px",Math.round(this.vShadow)+"px",Math.round(this.blur)+"px",Math.round(this.spread)+"px",this.color];return this.inset&&e.push("inset"),e.join(" ")},e}(),jscolor:function(e,t){function r(e,t,r){var n=r/100*255;if(null===e)return[n,n,n];e/=60,t/=100;var o=Math.floor(e),i=n*(1-t),a=n*(1-t*(o%2?e-o:1-(e-o)));switch(o){case 6:case 0:return[n,a,i];case 1:return[a,n,i];case 2:return[i,n,a];case 3:return[i,a,n];case 4:return[a,i,n];case 5:return[n,i,a]}}function o(){d._processParentElementsInDOM(),n.picker||(n.picker={owner:null,wrap:document.createElement("div"),box:document.createElement("div"),boxS:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),padPal:n.createPalette(),cross:document.createElement("div"),crossBY:document.createElement("div"),crossBX:document.createElement("div"),crossLY:document.createElement("div"),crossLX:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),sldGrad:n.createSliderGradient(),sldPtrS:document.createElement("div"),sldPtrIB:document.createElement("div"),sldPtrMB:document.createElement("div"),sldPtrOB:document.createElement("div"),btn:document.createElement("div"),btnT:document.createElement("span")},n.picker.pad.appendChild(n.picker.padPal.elm),n.picker.padB.appendChild(n.picker.pad),n.picker.cross.appendChild(n.picker.crossBY),n.picker.cross.appendChild(n.picker.crossBX),n.picker.cross.appendChild(n.picker.crossLY),n.picker.cross.appendChild(n.picker.crossLX),n.picker.padB.appendChild(n.picker.cross),n.picker.box.appendChild(n.picker.padB),n.picker.box.appendChild(n.picker.padM),n.picker.sld.appendChild(n.picker.sldGrad.elm),n.picker.sldB.appendChild(n.picker.sld),n.picker.sldB.appendChild(n.picker.sldPtrOB),n.picker.sldPtrOB.appendChild(n.picker.sldPtrMB),n.picker.sldPtrMB.appendChild(n.picker.sldPtrIB),n.picker.sldPtrIB.appendChild(n.picker.sldPtrS),n.picker.box.appendChild(n.picker.sldB),n.picker.box.appendChild(n.picker.sldM),n.picker.btn.appendChild(n.picker.btnT),n.picker.box.appendChild(n.picker.btn),n.picker.boxB.appendChild(n.picker.box),n.picker.wrap.appendChild(n.picker.boxS),n.picker.wrap.appendChild(n.picker.boxB));var e=n.picker,t=!!n.getSliderComponent(d),r=n.getPickerDims(d),o=2*d.pointerBorderWidth+d.pointerThickness+2*d.crossSize,s=n.getPadToSliderPadding(d),c=Math.min(d.borderRadius,Math.round(d.padding*Math.PI));e.wrap.style.clear="both",e.wrap.style.width=r[0]+2*d.borderWidth+"px",e.wrap.style.height=r[1]+2*d.borderWidth+"px",e.wrap.style.zIndex=d.zIndex,e.box.style.width=r[0]+"px",e.box.style.height=r[1]+"px",e.boxS.style.position="absolute",e.boxS.style.left="0",e.boxS.style.top="0",e.boxS.style.width="100%",e.boxS.style.height="100%",n.setBorderRadius(e.boxS,c+"px"),e.boxB.style.position="relative",e.boxB.style.border=d.borderWidth+"px solid",e.boxB.style.borderColor=d.borderColor,e.boxB.style.background=d.backgroundColor,n.setBorderRadius(e.boxB,c+"px"),e.padM.style.background=e.sldM.style.background="#FFF",n.setStyle(e.padM,"opacity","0"),n.setStyle(e.sldM,"opacity","0"),e.pad.style.position="relative",e.pad.style.width=d.width+"px",e.pad.style.height=d.height+"px",e.padPal.draw(d.width,d.height,n.getPadYComponent(d)),e.padB.style.position="absolute",e.padB.style.left=d.padding+"px",e.padB.style.top=d.padding+"px",e.padB.style.border=d.insetWidth+"px solid",e.padB.style.borderColor=d.insetColor,e.padM._jscInstance=d,e.padM._jscControlName="pad",e.padM.style.position="absolute",e.padM.style.left="0",e.padM.style.top="0",e.padM.style.width=d.padding+2*d.insetWidth+d.width+s/2+"px",e.padM.style.height=r[1]+"px",e.padM.style.cursor="crosshair",e.cross.style.position="absolute",e.cross.style.left=e.cross.style.top="0",e.cross.style.width=e.cross.style.height=o+"px",e.crossBY.style.position=e.crossBX.style.position="absolute",e.crossBY.style.background=e.crossBX.style.background=d.pointerBorderColor,e.crossBY.style.width=e.crossBX.style.height=2*d.pointerBorderWidth+d.pointerThickness+"px",e.crossBY.style.height=e.crossBX.style.width=o+"px",e.crossBY.style.left=e.crossBX.style.top=Math.floor(o/2)-Math.floor(d.pointerThickness/2)-d.pointerBorderWidth+"px",e.crossBY.style.top=e.crossBX.style.left="0",e.crossLY.style.position=e.crossLX.style.position="absolute",e.crossLY.style.background=e.crossLX.style.background=d.pointerColor,e.crossLY.style.height=e.crossLX.style.width=o-2*d.pointerBorderWidth+"px",e.crossLY.style.width=e.crossLX.style.height=d.pointerThickness+"px",e.crossLY.style.left=e.crossLX.style.top=Math.floor(o/2)-Math.floor(d.pointerThickness/2)+"px",e.crossLY.style.top=e.crossLX.style.left=d.pointerBorderWidth+"px",e.sld.style.overflow="hidden",e.sld.style.width=d.sliderSize+"px",e.sld.style.height=d.height+"px",e.sldGrad.draw(d.sliderSize,d.height,"#000","#000"),e.sldB.style.display=t?"block":"none",e.sldB.style.position="absolute",e.sldB.style.right=d.padding+"px",e.sldB.style.top=d.padding+"px",e.sldB.style.border=d.insetWidth+"px solid",e.sldB.style.borderColor=d.insetColor,e.sldM._jscInstance=d,e.sldM._jscControlName="sld",e.sldM.style.display=t?"block":"none",e.sldM.style.position="absolute",e.sldM.style.right="0",e.sldM.style.top="0",e.sldM.style.width=d.sliderSize+s/2+d.padding+2*d.insetWidth+"px",e.sldM.style.height=r[1]+"px",e.sldM.style.cursor="default",e.sldPtrIB.style.border=e.sldPtrOB.style.border=d.pointerBorderWidth+"px solid "+d.pointerBorderColor,e.sldPtrOB.style.position="absolute",e.sldPtrOB.style.left=-(2*d.pointerBorderWidth+d.pointerThickness)+"px",e.sldPtrOB.style.top="0",e.sldPtrMB.style.border=d.pointerThickness+"px solid "+d.pointerColor,e.sldPtrS.style.width=d.sliderSize+"px",e.sldPtrS.style.height=f+"px",e.btn.style.display=d.closable?"block":"none",e.btn.style.position="absolute",e.btn.style.left=d.padding+"px",e.btn.style.bottom=d.padding+"px",e.btn.style.padding="0 15px",e.btn.style.height=d.buttonHeight+"px",e.btn.style.border=d.insetWidth+"px solid",function(){var t=d.insetColor.split(/\s+/),r=t.length<2?t[0]:t[1]+" "+t[0]+" "+t[0]+" "+t[1];e.btn.style.borderColor=r}(),e.btn.style.color=d.buttonColor,e.btn.style.font="12px sans-serif",e.btn.style.textAlign="center";try{e.btn.style.cursor="pointer"}catch(t){e.btn.style.cursor="hand"}e.btn.onmousedown=function(){d.hide()},e.btnT.style.lineHeight=d.buttonHeight+"px",e.btnT.innerHTML="",e.btnT.appendChild(document.createTextNode(d.closeText)),i(),a(),n.picker.owner&&n.picker.owner!==d&&n.unsetClass(n.picker.owner.targetElement,d.activeClass),n.picker.owner=d,n.isElementType(p,"body")?n.redrawPosition():n._drawPosition(d,0,0,"relative",!1),e.wrap.parentNode!=p&&p.appendChild(e.wrap),n.setClass(d.targetElement,d.activeClass)}function i(){switch(n.getPadYComponent(d)){case"s":var e=1;break;case"v":e=2}var t=Math.round(d.hsv[0]/360*(d.width-1)),o=Math.round((1-d.hsv[e]/100)*(d.height-1)),i=2*d.pointerBorderWidth+d.pointerThickness+2*d.crossSize,a=-Math.floor(i/2);switch(n.picker.cross.style.left=t+a+"px",n.picker.cross.style.top=o+a+"px",n.getSliderComponent(d)){case"s":var s=r(d.hsv[0],100,d.hsv[2]),c=r(d.hsv[0],0,d.hsv[2]),u="rgb("+Math.round(s[0])+","+Math.round(s[1])+","+Math.round(s[2])+")",l="rgb("+Math.round(c[0])+","+Math.round(c[1])+","+Math.round(c[2])+")";n.picker.sldGrad.draw(d.sliderSize,d.height,u,l);break;case"v":var p=r(d.hsv[0],d.hsv[1],100);u="rgb("+Math.round(p[0])+","+Math.round(p[1])+","+Math.round(p[2])+")",l="#000",n.picker.sldGrad.draw(d.sliderSize,d.height,u,l)}}function a(){var e=n.getSliderComponent(d);if(e){switch(e){case"s":var t=1;break;case"v":t=2}var r=Math.round((1-d.hsv[t]/100)*(d.height-1));n.picker.sldPtrOB.style.top=r-(2*d.pointerBorderWidth+d.pointerThickness)-Math.floor(f/2)+"px"}}function s(){return n.picker&&n.picker.owner===d}for(var c in this.value=null,this.valueElement=e,this.styleElement=e,this.required=!0,this.refine=!0,this.hash=!1,this.uppercase=!0,this.onFineChange=null,this.activeClass="jscolor-active",this.minS=0,this.maxS=100,this.minV=0,this.maxV=100,this.hsv=[0,0,100],this.rgb=[255,255,255],this.width=181,this.height=101,this.showOnClick=!0,this.mode="HSV",this.position="bottom",this.smartPosition=!0,this.sliderSize=16,this.crossSize=8,this.closable=!1,this.closeText="Close",this.buttonColor="#000000",this.buttonHeight=18,this.padding=12,this.backgroundColor="#FFFFFF",this.borderWidth=1,this.borderColor="#BBBBBB",this.borderRadius=8,this.insetWidth=1,this.insetColor="#BBBBBB",this.shadow=!0,this.shadowBlur=15,this.shadowColor="rgba(0,0,0,0.2)",this.pointerColor="#4C4C4C",this.pointerBorderColor="#FFFFFF",this.pointerBorderWidth=1,this.pointerThickness=2,this.zIndex=1e3,this.container=null,t)t.hasOwnProperty(c)&&(this[c]=t[c]);if(this.hide=function(){s()&&(n.unsetClass(d.targetElement,d.activeClass),n.picker.wrap.parentNode.removeChild(n.picker.wrap),delete n.picker.owner)},this.show=function(){o()},this.redraw=function(){s()&&o()},this.importColor=function(){this.valueElement&&n.isElementType(this.valueElement,"input")?this.refine?!this.required&&/^\s*$/.test(this.valueElement.value)?(this.valueElement.value="",this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(n.leaveValue|n.leaveStyle)):this.fromString(this.valueElement.value)||this.exportColor():this.fromString(this.valueElement.value,n.leaveValue)||(this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(n.leaveValue|n.leaveStyle)):this.exportColor()},this.exportColor=function(e){if(!(e&n.leaveValue)&&this.valueElement){var t=this.toString();this.uppercase&&(t=t.toUpperCase()),this.hash&&(t="#"+t),n.isElementType(this.valueElement,"input")?this.valueElement.value=t:this.valueElement.innerHTML=t}e&n.leaveStyle||this.styleElement&&(this.styleElement.style.backgroundImage="none",this.styleElement.style.backgroundColor="#"+this.toString(),this.styleElement.style.color=this.isLight()?"#000":"#FFF"),!(e&n.leavePad)&&s()&&i(),!(e&n.leaveSld)&&s()&&a()},this.fromHSV=function(e,t,n,o){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(360,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(100,this.maxS,t),this.minS)}if(null!==n){if(isNaN(n))return!1;n=Math.max(0,Math.min(100,this.maxV,n),this.minV)}this.rgb=r(null===e?this.hsv[0]:this.hsv[0]=e,null===t?this.hsv[1]:this.hsv[1]=t,null===n?this.hsv[2]:this.hsv[2]=n),this.exportColor(o)},this.fromRGB=function(e,t,n,o){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(255,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(255,t))}if(null!==n){if(isNaN(n))return!1;n=Math.max(0,Math.min(255,n))}var i=function(e,t,r){e/=255,t/=255,r/=255;var n=Math.min(Math.min(e,t),r),o=Math.max(Math.max(e,t),r),i=o-n;if(0===i)return[null,0,100*o];var a=e===n?3+(r-t)/i:t===n?5+(e-r)/i:1+(t-e)/i;return[60*(6===a?0:a),i/o*100,100*o]}(null===e?this.rgb[0]:e,null===t?this.rgb[1]:t,null===n?this.rgb[2]:n);null!==i[0]&&(this.hsv[0]=Math.max(0,Math.min(360,i[0]))),0!==i[2]&&(this.hsv[1]=null===i[1]?null:Math.max(0,this.minS,Math.min(100,this.maxS,i[1]))),this.hsv[2]=null===i[2]?null:Math.max(0,this.minV,Math.min(100,this.maxV,i[2]));var a=r(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=a[0],this.rgb[1]=a[1],this.rgb[2]=a[2],this.exportColor(o)},this.fromString=function(e,t){var r;if(r=e.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i))return 6===r[1].length?this.fromRGB(parseInt(r[1].substr(0,2),16),parseInt(r[1].substr(2,2),16),parseInt(r[1].substr(4,2),16),t):this.fromRGB(parseInt(r[1].charAt(0)+r[1].charAt(0),16),parseInt(r[1].charAt(1)+r[1].charAt(1),16),parseInt(r[1].charAt(2)+r[1].charAt(2),16),t),!0;if(r=e.match(/^\W*rgba?\(([^)]*)\)\W*$/i)){var n,o,i,a=r[1].split(","),s=/^\s*(\d*)(\.\d+)?\s*$/;if(a.length>=3&&(n=a[0].match(s))&&(o=a[1].match(s))&&(i=a[2].match(s))){var c=parseFloat((n[1]||"0")+(n[2]||"")),u=parseFloat((o[1]||"0")+(o[2]||"")),l=parseFloat((i[1]||"0")+(i[2]||""));return this.fromRGB(c,u,l,t),!0}}return!1},this.toString=function(){return(256|Math.round(this.rgb[0])).toString(16).substr(1)+(256|Math.round(this.rgb[1])).toString(16).substr(1)+(256|Math.round(this.rgb[2])).toString(16).substr(1)},this.toHEXString=function(){return"#"+this.toString().toUpperCase()},this.toRGBString=function(){return"rgb("+Math.round(this.rgb[0])+","+Math.round(this.rgb[1])+","+Math.round(this.rgb[2])+")"},this.isLight=function(){return.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]>127.5},this._processParentElementsInDOM=function(){if(!this._linkedElementsProcessed){this._linkedElementsProcessed=!0;var e=this.targetElement;do{var t=n.getStyle(e);t&&"fixed"===t.position.toLowerCase()&&(this.fixed=!0),e!==this.targetElement&&(e._jscEventsAttached||(n.attachEvent(e,"scroll",n.onParentScroll),e._jscEventsAttached=!0))}while((e=e.parentNode)&&!n.isElementType(e,"body"))}},"string"==typeof e){var u=e,l=document.getElementById(u);l?this.targetElement=l:n.warn("Could not find target element with ID '"+u+"'")}else e?this.targetElement=e:n.warn("Invalid target element: '"+e+"'");if(this.targetElement._jscLinkedInstance)n.warn("Cannot link jscolor twice to the same element. Skipping.");else{this.targetElement._jscLinkedInstance=this,this.valueElement=n.fetchElement(this.valueElement),this.styleElement=n.fetchElement(this.styleElement);var d=this,p=this.container?n.fetchElement(this.container):document.getElementsByTagName("body")[0],f=3;if(n.isElementType(this.targetElement,"button"))if(this.targetElement.onclick){var h=this.targetElement.onclick;this.targetElement.onclick=function(e){return h.call(this,e),!1}}else this.targetElement.onclick=function(){return!1};if(this.valueElement&&n.isElementType(this.valueElement,"input")){var m=function(){d.fromString(d.valueElement.value,n.leaveValue),n.dispatchFineChange(d)};n.attachEvent(this.valueElement,"keyup",m),n.attachEvent(this.valueElement,"input",m),n.attachEvent(this.valueElement,"blur",(function(){d.importColor()})),this.valueElement.setAttribute("autocomplete","off")}this.styleElement&&(this.styleElement._jscOrigStyle={backgroundImage:this.styleElement.style.backgroundImage,backgroundColor:this.styleElement.style.backgroundColor,color:this.styleElement.style.color}),this.value?this.fromString(this.value)||this.exportColor():this.importColor()}}}).jscolor.lookupClass="jscolor",n.jscolor.installByClassName=function(e){var t=document.getElementsByTagName("input"),r=document.getElementsByTagName("button");n.tryInstallOnElements(t,e),n.tryInstallOnElements(r,e)},n.register(),n.jscolor))},function(e,t,r){"use strict";var n=r(3),o=r(30),i=r(94),a=r(20);function s(e){var t=new i(e),r=o(i.prototype.request,t);return n.extend(r,i.prototype,t),n.extend(r,t),r}var c=s(a);c.Axios=i,c.create=function(e){return s(n.merge(a,e))},c.Cancel=r(34),c.CancelToken=r(107),c.isCancel=r(33),c.all=function(e){return Promise.all(e)},c.spread=r(108),e.exports=c,e.exports.default=c},function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,r){"use strict";var n=r(20),o=r(3),i=r(102),a=r(103);function s(e){this.defaults=e,this.interceptors={request:new i,response:new i}}s.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(n,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},o.forEach(["delete","get","head","options"],(function(e){s.prototype[e]=function(t,r){return this.request(o.merge(r||{},{method:e,url:t}))}})),o.forEach(["post","put","patch"],(function(e){s.prototype[e]=function(t,r,n){return this.request(o.merge(n||{},{method:e,url:t,data:r}))}})),e.exports=s},function(e,t,r){"use strict";var n=r(3);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},function(e,t,r){"use strict";var n=r(32);e.exports=function(e,t,r){var o=r.config.validateStatus;r.status&&o&&!o(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},function(e,t,r){"use strict";e.exports=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e}},function(e,t,r){"use strict";var n=r(3);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(n.isURLSearchParams(t))i=t.toString();else{var a=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))})))})),i=a.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t,r){"use strict";var n=r(3),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,a={};return e?(n.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),r=n.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}})),a):a}},function(e,t,r){"use strict";var n=r(3);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=o(window.location.href),function(t){var r=n.isString(t)?o(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},function(e,t,r){"use strict";var n=r(3);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,o,i,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(o)&&s.push("path="+o),n.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,r){"use strict";var n=r(3);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},function(e,t,r){"use strict";var n=r(3),o=r(104),i=r(33),a=r(20),s=r(105),c=r(106);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!s(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(u(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,r){"use strict";var n=r(3);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,r){"use strict";var n=r(34);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new k(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===l)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,a),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function d(){}function p(){}function f(){}var h={};h[o]=function(){return this};var m=Object.getPrototypeOf,_=m&&m(m(C([])));_&&_!==t&&r.call(_,o)&&(h=_);var g=f.prototype=d.prototype=Object.create(h);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){var n;this._invoke=function(o,i){function a(){return new t((function(n,a){!function n(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}(o,i,n,a)}))}return n=n?n.then(a,a):a()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=g.constructor=f,f.constructor=p,p.displayName=s(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},v(y.prototype),y.prototype[i]=function(){return this},e.AsyncIterator=y,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new y(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(g),s(g,a,"Generator"),g[o]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=C,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=110},function(e,t,r){var n,o,i=r(35),a=r(36),s=0,c=0;e.exports=function(e,t,r){var u=t&&r||0,l=t||[],d=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==p){var f=i();null==d&&(d=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=o=16383&(f[6]<<8|f[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,_=h-s+(m-c)/1e4;if(_<0&&void 0===e.clockseq&&(p=p+1&16383),(_<0||h>s)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=m,o=p;var g=(1e4*(268435455&(h+=122192928e5))+m)%4294967296;l[u++]=g>>>24&255,l[u++]=g>>>16&255,l[u++]=g>>>8&255,l[u++]=255&g;var v=h/4294967296*1e4&268435455;l[u++]=v>>>8&255,l[u++]=255&v,l[u++]=v>>>24&15|16,l[u++]=v>>>16&255,l[u++]=p>>>8|128,l[u++]=255&p;for(var y=0;y<6;++y)l[u+y]=d[y];return t||a(l)}},function(e,t,r){var n=r(35),o=r(36);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t,r){var n=r(37),o=r(10)("socket.io-client:url");e.exports=function(e,t){var r=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),r=n(e));r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443"));r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port,r.href=r.protocol+"://"+i+(t&&t.port===r.port?"":":"+r.port),r}},function(e,t,r){function n(e){var r;function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;c++;var o=t.formatters[n];if("function"==typeof o){var i=a[c];r=o.call(e,i),a.splice(c,1),c--}return r})),t.formatArgs.call(e,a);var u=n.log||t.log||console.log.bind(console);u.apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var i=t.instances[r];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(38),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,r){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,r){var n=r(39),o=r(40),i=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.deconstructPacket=function(e){var t=[],r=e.data,i=e;return i.data=function e(t,r){if(!t)return t;if(o(t)){var i={_placeholder:!0,num:r.length};return r.push(t),i}if(n(t)){for(var a=new Array(t.length),s=0;s<t.length;s++)a[s]=e(t[s],r);return a}if("object"==typeof t&&!(t instanceof Date)){a={};for(var c in t)a[c]=e(t[c],r);return a}return t}(r,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,r){if(!t)return t;if(t&&t._placeholder)return r[t.num];if(n(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],r);else if("object"==typeof t)for(var i in t)t[i]=e(t[i],r);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var r=0,i=e;!function e(c,u,l){if(!c)return c;if(a&&c instanceof Blob||s&&c instanceof File){r++;var d=new FileReader;d.onload=function(){l?l[u]=this.result:i=this.result,--r||t(i)},d.readAsArrayBuffer(c)}else if(n(c))for(var p=0;p<c.length;p++)e(c[p],p,c);else if("object"==typeof c&&!o(c))for(var f in c)e(c[f],f,c)}(i),r||t(i)}},function(e,t,r){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=u(e),a=n[0],s=n[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),l=0,d=s>0?a-4:a;for(r=0;r<d;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,c[l++]=255&t);1===s&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=0,s=r-o;a<s;a+=16383)i.push(l(e,a,a+16383>s?s:a+16383));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)n[s]=a[s],o[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,r){for(var o,i,a=[],s=t;s<r;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,o){var i,a,s=8*o-n-1,c=(1<<s)-1,u=c>>1,l=-7,d=r?o-1:0,p=r?-1:1,f=e[t+d];for(d+=p,i=f&(1<<-l)-1,f>>=-l,l+=s;l>0;i=256*i+e[t+d],d+=p,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=n;l>0;a=256*a+e[t+d],d+=p,l-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),i-=u}return(f?-1:1)*a*Math.pow(2,i-n)},t.write=function(e,t,r,n,o,i){var a,s,c,u=8*i-o-1,l=(1<<u)-1,d=l>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,h=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?p/c:p*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*c-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[r+f]=255&s,f+=h,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;e[r+f]=255&a,f+=h,a/=256,u-=8);e[r+f-h]|=128*m}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){e.exports=r(121),e.exports.parser=r(8)},function(e,t,r){var n=r(42),o=r(11),i=r(17)("engine.io-client:socket"),a=r(46),s=r(8),c=r(37),u=r(15);function l(e,t){if(!(this instanceof l))return new l(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=l,l.priorWebsocketSuccess=!1,o(l.prototype),l.protocol=s.protocol,l.Socket=l,l.Transport=r(25),l.transports=r(42),l.parser=r(8),l.prototype.createTransport=function(e){i('creating transport "%s"',e);var t=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var r=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new n[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative})},l.prototype.open=function(){var e;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},l.prototype.setTransport=function(e){i("setting transport %s",e.name);var t=this;this.transport&&(i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},l.prototype.probe=function(e){i('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),r=!1,n=this;function o(){if(n.onlyBinaryUpgrades){var o=!this.supportsBinary&&n.transport.supportsBinary;r=r||o}r||(i('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!r)if("pong"===o.type&&"probe"===o.data){if(i('probe transport "%s" pong',e),n.upgrading=!0,n.emit("upgrading",t),!t)return;l.priorWebsocketSuccess="websocket"===t.name,i('pausing current transport "%s"',n.transport.name),n.transport.pause((function(){r||"closed"!==n.readyState&&(i("changing transport and sending upgrade packet"),p(),n.setTransport(t),t.send([{type:"upgrade"}]),n.emit("upgrade",t),t=null,n.upgrading=!1,n.flush())}))}else{i('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name,n.emit("upgradeError",a)}})))}function a(){r||(r=!0,p(),t.close(),t=null)}function s(r){var o=new Error("probe error: "+r);o.transport=t.name,a(),i('probe transport "%s" failed because of error: %s',e,r),n.emit("upgradeError",o)}function c(){s("transport closed")}function u(){s("socket closed")}function d(e){t&&e.name!==t.name&&(i('"%s" works - aborting "%s"',e.name,t.name),a())}function p(){t.removeListener("open",o),t.removeListener("error",s),t.removeListener("close",c),n.removeListener("close",u),n.removeListener("upgrading",d)}l.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",s),t.once("close",c),this.once("close",u),this.once("upgrading",d),t.open()},l.prototype.onOpen=function(){if(i("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){i("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},l.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(i('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},l.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},l.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){i("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},l.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},l.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(i("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this},l.prototype.sendPacket=function(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var o={type:e,data:t,options:r};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},l.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?n():t()})):this.upgrading?n():t()}function t(){e.onClose("forced close"),i("socket closing - telling transport to close"),e.transport.close()}function r(){e.removeListener("upgrade",r),e.removeListener("upgradeError",r),t()}function n(){e.once("upgrade",r),e.once("upgradeError",r)}return this},l.prototype.onError=function(e){i("socket error %j",e),l.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},l.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){i('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},l.prototype.filterUpgrades=function(e){for(var t=[],r=0,n=e.length;r<n;r++)~a(this.transports,e[r])&&t.push(e[r]);return t}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,r){var n=r(24),o=r(43),i=r(11),a=r(16),s=r(17)("engine.io-client:polling-xhr");function c(){}function u(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,r=location.port;r||(r=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=l,a(u,o),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new l(e)},u.prototype.doWrite=function(e,t){var r="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:r}),o=this;n.on("success",t),n.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=n},u.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},i(l.prototype),l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new n(e),r=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");r.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout((function(){r.onError(t.status)}),0))},s("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){r.onError(e)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},l.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",p);else if("function"==typeof addEventListener){var d="onpagehide"in self?"pagehide":"unload";addEventListener(d,p,!1)}function p(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}},function(e,t){e.exports=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&t.push(n);return t}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){e.exports=function(e,t,r){var n=e.byteLength;if(t=t||0,r=r||n,e.slice)return e.slice(t,r);if(t<0&&(t+=n),r<0&&(r+=n),r>n&&(r=n),t>=n||t>=r||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(r-t),a=t,s=0;a<r;a++,s++)i[s]=o[a];return i.buffer}},function(e,t){function r(){}e.exports=function(e,t,n){var o=!1;return n=n||r,i.count=e,0===e?t():i;function i(e,r){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}}},function(e,t){var r,n,o,i=String.fromCharCode;function a(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function s(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return i(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return i(e);var r="";return 0==(4294965248&e)?r=i(e>>6&31|192):0==(4294901760&e)?(s(e,t)||(e=65533),r=i(e>>12&15|224),r+=c(e,6)):0==(4292870144&e)&&(r=i(e>>18&7|240),r+=c(e,12),r+=c(e,6)),r+=i(63&e|128)}function l(){if(o>=n)throw Error("Invalid byte index");var e=255&r[o];if(o++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function d(e){var t,i;if(o>n)throw Error("Invalid byte index");if(o==n)return!1;if(t=255&r[o],o++,0==(128&t))return t;if(192==(224&t)){if((i=(31&t)<<6|l())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&t)){if((i=(15&t)<<12|l()<<6|l())>=2048)return s(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(i=(7&t)<<18|l()<<12|l()<<6|l())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var r=!1!==(t=t||{}).strict,n=a(e),o=n.length,i=-1,s="";++i<o;)s+=u(n[i],r);return s},decode:function(e,t){var s=!1!==(t=t||{}).strict;r=a(e),n=r.length,o=0;for(var c,u=[];!1!==(c=d(s));)u.push(c);return function(e){for(var t,r=e.length,n=-1,o="";++n<r;)(t=e[n])>65535&&(o+=i((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=i(t);return o}(u)}}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<e.length;n++)r[e.charCodeAt(n)]=n;t.encode=function(t){var r,n=new Uint8Array(t),o=n.length,i="";for(r=0;r<o;r+=3)i+=e[n[r]>>2],i+=e[(3&n[r])<<4|n[r+1]>>4],i+=e[(15&n[r+1])<<2|n[r+2]>>6],i+=e[63&n[r+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,n,o,i,a,s=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),d=new Uint8Array(l);for(t=0;t<c;t+=4)n=r[e.charCodeAt(t)],o=r[e.charCodeAt(t+1)],i=r[e.charCodeAt(t+2)],a=r[e.charCodeAt(t+3)],d[u++]=n<<2|o>>4,d[u++]=(15&o)<<4|i>>2,d[u++]=(3&i)<<6|63&a;return l}}()},function(e,t){var r=void 0!==r?r:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),o=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),i=r&&r.prototype.append&&r.prototype.getBlob;function a(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var r=new Uint8Array(e.byteLength);r.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=r.buffer}return t}return e}))}function s(e,t){t=t||{};var n=new r;return a(e).forEach((function(e){n.append(e)})),t.type?n.getBlob(t.type):n.getBlob()}function c(e,t){return new Blob(a(e),t||{})}"undefined"!=typeof Blob&&(s.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=n?o?Blob:c:i?s:void 0},function(e,t,r){function n(e){var r;function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;c++;var o=t.formatters[n];if("function"==typeof o){var i=a[c];r=o.call(e,i),a.splice(c,1),c--}return r})),t.formatArgs.call(e,a);var u=n.log||t.log||console.log.bind(console);u.apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var i=t.instances[r];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(38),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,r){(function(t){var n=r(43),o=r(16);e.exports=l;var i,a=/\n/g,s=/\\n/g;function c(){}function u(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function l(e){if(n.call(this,e),this.query=this.query||{},!i){var t=u();i=t.___eio=t.___eio||[]}this.index=i.length;var r=this;i.push((function(e){r.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){r.script&&(r.script.onerror=c)}),!1)}o(l,n),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),n.prototype.doClose.call(this)},l.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},l.prototype.doWrite=function(e,t){var r=this;if(!this.form){var n,o=document.createElement("form"),i=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}function u(){l(),t()}function l(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';n=document.createElement(e)}catch(e){(n=document.createElement("iframe")).name=r.iframeId,n.src="javascript:0"}n.id=r.iframeId,r.form.appendChild(n),r.iframe=n}this.form.action=this.uri(),l(),e=e.replace(s,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,r(14))},function(e,t,r){(function(t){var n,o,i=r(25),a=r(8),s=r(15),c=r(16),u=r(45),l=r(17)("engine.io-client:websocket");if("undefined"!=typeof WebSocket)n=WebSocket;else if("undefined"!=typeof self)n=self.WebSocket||self.MozWebSocket;else try{o=r(134)}catch(e){}var d=n||o;function p(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=n&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(d=o),i.call(this,e)}e.exports=p,c(p,i),p.prototype.name="websocket",p.prototype.supportsBinary=!0,p.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new d(e,t):new d(e):new d(e,t,r)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},p.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},p.prototype.write=function(e){var r=this;this.writable=!1;for(var n=e.length,o=0,i=n;o<i;o++)!function(e){a.encodePacket(e,r.supportsBinary,(function(o){if(!r.usingBrowserWebSocket){var i={};if(e.options&&(i.compress=e.options.compress),r.perMessageDeflate)("string"==typeof o?t.byteLength(o):o.length)<r.perMessageDeflate.threshold&&(i.compress=!1)}try{r.usingBrowserWebSocket?r.ws.send(o):r.ws.send(o,i)}catch(e){l("websocket closed before onclose event")}--n||s()}))}(e[o]);function s(){r.emit("flush"),setTimeout((function(){r.writable=!0,r.emit("drain")}),0)}},p.prototype.onClose=function(){i.prototype.onClose.call(this)},p.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},p.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=s.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e},p.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===p.prototype.name)}}).call(this,r(23).Buffer)},function(e,t){},function(e,t){e.exports=function(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}},function(e,t){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";r.r(t);var n=function(e){return{type:"SET_CURRENT_PANE",currentPane:e}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_TV_BOX_OPEN",isTvBoxOpen:e}};function i(e){"touchstart"===e.type?(window.tvInitialX=e.touches[0].clientX-window.tvXOffset,window.tvInitialY=e.touches[0].clientY-window.tvYOffset):(window.tvInitialX=e.clientX-window.tvXOffset,window.tvInitialY=e.clientY-window.tvYOffset);var t=document.querySelector("#tv_box__header"),r=document.querySelector("#tv_box__title"),n=document.querySelector("#tv_box__body");e.target!==t&&e.target!==r&&e.target!==n||(window.tvDragActive=!0)}function a(e){window.tvInitialX=window.tvCurrentX,window.tvInitialY=window.tvCurrentY,window.tvDragActive=!1}function s(e){var t,r;window.tvDragActive&&(e.preventDefault(),"touchmove"===e.type?(window.tvCurrentX=e.touches[0].clientX-window.tvInitialX,window.tvCurrentY=e.touches[0].clientY-window.tvInitialY):(window.tvCurrentX=e.clientX-window.tvInitialX,window.tvCurrentY=e.clientY-window.tvInitialY),window.tvXOffset=window.tvCurrentX,window.tvYOffset=window.tvCurrentY,t=window.tvCurrentX,r=window.tvCurrentY,document.querySelector("#tv_box").style.transform="translate3d("+t+"px, "+r+"px, 0)")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"register",value:function(){var e=document.querySelector("#chat");window.tvDragActive=!1,window.tvXOffset=window.tvXOffset?window.tvXOffset:0,window.tvYOffset=window.tvYOffset?window.tvYOffset:0,e.addEventListener("touchstart",i,!1),e.addEventListener("touchend",a,!1),e.addEventListener("touchmove",s,!1),e.addEventListener("mousedown",i,!1),e.addEventListener("mouseup",a,!1),e.addEventListener("mousemove",s,!1)}},{key:"unregister",value:function(){var e=document.querySelector("#chat");e.removeEventListener("touchstart",i,!1),e.removeEventListener("touchend",a,!1),e.removeEventListener("touchmove",s,!1),e.removeEventListener("mousedown",i,!1),e.removeEventListener("mouseup",a,!1),e.removeEventListener("mousemove",s,!1)}}],(r=null)&&c(t.prototype,r),n&&c(t,n),e}();function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onClose(t)}},{key:"onClose",value:function(t){$("#tv_box__close").unbind().on("click",(function(r){e.close(t)}))}},{key:"close",value:function(e){e.dispatch(o(!1)),u.unregister(),$("#tv_box").html("")}},{key:"open",value:function(t){t.getState().isTvBoxOpen||($("#tv_box").html(e.render(t)),t.dispatch(o(!0)),e.onClose(t),u.register())}},{key:"update",value:function(t){var r=t.getState().settings.tv_box_title?t.getState().settings.tv_box_title:"",n=e.parseURL(t.getState().settings.tv_box_url);$("#tv_box__title").text(r),$("#tv_box__body iframe").attr("src")!=n&&$("#tv_box__body iframe").attr("src",n)}},{key:"parseURL",value:function(e){if(!e)return"";var t=function(e){try{if(e.includes("youtube")){var t=e.split("v=")[1];if(!t)return null;var r=t.indexOf("&");return-1!=r?t.substring(0,r):t}if(!e.includes("youtu.be/"))return null;var n=e.split("youtu.be/"),o=n[0],i=n[1];if(o&&11==o.length)return o;if(i&&11==i.length)return i}catch(e){return null}}(e);return t?"https://www.youtube.com/embed/"+t+"?playsinline=1":e}},{key:"render",value:function(t){var r="<div>";return r+="<header id='tv_box__header' class='label label-primary'>",r+="<span id='tv_box__title'>"+(t.getState().settings.tv_box_title?t.getState().settings.tv_box_title:"")+"</span>",r+="<button id='tv_box__close' class='fa fa-close btn btn-danger'></button>",r+="</header>",r+="<div id='tv_box__body' class='fl'>",r+="<iframe src='"+e.parseURL(t.getState().settings.tv_box_url)+"' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' ></iframe>",r+="</div>",r+="</div>"}}],(r=null)&&l(t.prototype,r),n&&l(t,n),e}();function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onClose(t)}},{key:"onClose",value:function(e){$(".chat_pane__header button").on("click",(function(t){e.dispatch(n(null)),pr.togglePane(e,!0)}))}},{key:"render",value:function(e,t){var r="<div class='chat_pane__header label label-primary '>";return r+="<h3 "+(t?"style='text-align: center;'":"")+" class='label label-primary chat_pane__header__title'>"+e+"</h3>",r+="<button class='btn btn-danger fa fa-times chat_pane__header__close'></button>",r+="</div>"}}],(r=null)&&p(t.prototype,r),o&&p(t,o),e}(),h=r(50),m=r.n(h);function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"keys",value:function(e){var t=e.getState().faces,r=[];for(var n in t)r.push(t[n].key);return r}},{key:"icons",value:function(e){var t=e.getState().faces,r=[];for(var n in t)r.push(t[n].icon);return r}},{key:"findKeys",value:function(t,r){for(var n=[],o=e.keys(r).map((function(e){return"("+e+")"})).sort((function(e,t){return e.length>t.length?-1:1})).toString().replace(/,/g,"|"),i=new RegExp("("+o+")"),a=null,s=0;s<10;s++){var c=i.exec(t);c&&(a=m.a.generate(),n.push({id:a,key:c[0]}),t=t.replace(i,a))}return{data:t,detectedFaces:n}}},{key:"renderImage",value:function(t,r){var n=e.keys(r).indexOf(t);if(n>=0){var o=e.icons(r)[n];return"?test"==location.search?"<img src='/images/floating_heart1.png' alt='' />":"<img src='/uploads/faces/"+o+"?v=1' alt='' />"}}},{key:"render",value:function(t,r){if(!t)return"";if(!e.keys(r).length)return"<span>"+t+"</span>";var n=e.findKeys(t,r);if(!n.detectedFaces.length)return"<span>"+n.data+"</span>";var o=n.data,i="";for(var a in n.detectedFaces){var s=n.detectedFaces[a];if(void 0!==o){var c=o.split(s.id);void 0!==(o=c[1])&&(c[0]?i+="<span><span>"+c[0]+"</span>"+e.renderImage(s.key,r)+"</span>":i+="<span>"+e.renderImage(s.key,r)+"</span>")}}return"<span>"+i+"<span>"+(o=o||"")+"</span></span>"}}],(r=null)&&_(t.prototype,r),n&&_(t,n),e}();function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onSelect()}},{key:"onSelect",value:function(){$(".emoji_picker img.emoji_picker__item").unbind("click").on("click",(function(e){var t=e.target.dataset.key,r=document.querySelector($(this).parent().data("input"));r&&(r.value=r.value.trim()+" "+t+" ",r.focus())}))}},{key:"toggle",value:function(e){e&&(e.getState().isPublicMessagesFacePickerOpen?$(".emoji_picker.public_messages").show():$(".emoji_picker.public_messages").hide(),e.getState().isPrivateMessagesFacePickerOpen?$(".emoji_picker.private_messages").show():$(".emoji_picker.private_messages").hide(),e.getState().isWallFacePickerOpen?$(".emoji_picker.wall").show():$(".emoji_picker.wall").hide(),e.getState().isWallCommentsFacePickerOpen?$(".emoji_picker.wall-comments").show():$(".emoji_picker.wall-comments").hide())}},{key:"render",value:function(e,t,r){var n="<div class='emoji_picker "+e+"' data-input='"+t+"' style='display: none'>";return r.getState().faces.map((function(e){"?test"==location.search?n+="<img src='/images/floating_heart1.png' height='22' data-key='"+e.key+"' class='emoji_picker__item' alt='emoji' />":n+="<img src='/uploads/faces/"+e.icon+"' height='22' data-key='"+e.key+"' class='emoji_picker__item' alt='emoji' />"})),n+="</div>"}}],(r=null)&&v(t.prototype,r),n&&v(t,n),e}(),b=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_PUBLIC_MESSAGES_FACE_PICKER",isPublicMessagesFacePickerOpen:e}};function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"onNameClicked",value:function(e){$(".Username").unbind("click").on("click",(function(e){alert("name clicked")}))}},{key:"render",value:function(e){var t="<span class='username'>";return"?test"==location.search?t+=e.icon?"<img src='/images/floating_ad1.png' class='username__icon fl' alt='' style='max-height: 16px' />":"":t+=e.icon?"<img src='"+e.icon+"?v=1' class='username__icon fl' alt='' style='max-height: 16px' />":"",t+="<span class='username__wrapper' style='background-color: "+e.nameBgColor+"; color: "+e.nameColor+"'>"+e.name+"</span>",t+="</span>"}}],(r=null)&&w(t.prototype,r),n&&w(t,n),e}();function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.clearGift(t),e.onSelect(t),e.close(t)}},{key:"clearGift",value:function(e){$(".gifts_picker__contianer__clear").unbind("click").on("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_REMOVE_GIFT",data:{userID:r}}),(function(e){"string"==typeof(e=Sr(e))&&alert(e)}))}))}},{key:"onSelect",value:function(e){$(".gifts_picker__contianer__img").unbind("click").on("click",(function(t){var r=e.getState().requestedUser,n=$(this).data("id"),o=r.id;r.icon!=$(this).attr("src")&&e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_GIFT",data:{userID:o,giftID:n}}),(function(e){"string"==typeof(e=Sr(e))&&alert(e)}))}))}},{key:"close",value:function(e){$(".gifts_picker__contianer__close").unbind("click").on("click",(function(e){$("#user_profile .gifts_picker").hide(),$("#user_profile .user_profile__body__avatar").show()}))}},{key:"render",value:function(e){var t="<div class='gifts_picker' style='display: none'>";return t+="<div class='gifts_picker__contianer'>",e.getState().gifts.forEach((function(e){t+="<img data-id='"+e.id+"' src='"+e.icon+"' class='gifts_picker__contianer__img' />"})),t+="</div>",t+="<button class='gifts_picker__contianer__clear btn btn-primary fa fa-times fl'> </button>",t+="<button class='gifts_picker__contianer__close btn btn-danger fa fa-times fr'> </button>",t+="<div class='clear'></div>",t+="</div>"}}],(r=null)&&k(t.prototype,r),n&&k(t,n),e}(),E=function(e){return{type:"SET_CURRENT_CONVERSATION",user:e}},T=function(e){return{type:"REMOVE_CONVERSATION",id:e}},P=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return{type:"ADD_MESSAGE_TO_CONVERSATION",conversation_id:e,me:t,him:r,seen:n,message:o}},A=function(e){return{type:"REMOVE_CONVERSATION_BY_USER",him_id:e}};function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var O=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.getProfile(t),e.photoClicked(),e.youtubeVideoClicked()}},{key:"updateUser",value:function(e,t){if(t.getState().currentConversation){var r=t.getState().users.filter((function(t){return t.id==e}))[0];if(r){var n=$(".private_message[data-user-id='"+e+"']");n&&(n.find(".private_message__avatar img").attr("src",r.avatar),n.find(".private_message__title").html(S.render(r)),n.find(".private_message__body").css("color",r.fontColor))}}}},{key:"getProfile",value:function(e){$("#chat_box .private_message .private_message__avatar img").unbind("click").on("click",(function(t){var r=$(this).closest(".private_message").data("user-id");xt.show(r,e)}))}},{key:"getBaseDir",value:function(){return"/uploads/private/"}},{key:"photoClicked",value:function(){$(".private_message__body__image").unbind("click").on("click",(function(e){e.stopPropagation(),window.open($(this).attr("src"),"_blank").focus()}))}},{key:"youtubeVideoClicked",value:function(){$(".private_message .yt-btn").unbind("click").on("click",(function(e){e.stopPropagation();try{var t=$(this).data("msg-id"),r="https://www.youtube.com/embed/"+$(this).data("yid")+"?autoplay=1&playsinline=1",n=document.getElementById("yt-btn-"+t);n&&(n.insertAdjacentHTML("afterend",'<iframe width="95%" style="max-width:240px;" height="200" src="'+r+'" frameborder="0"></iframe><br />'),n.remove())}catch(e){}}))}},{key:"renderMessageBody",value:function(t,r){switch(t.type){case"text":return g.render(t.body,r);case"photo":return"<img src='"+e.getBaseDir()+t.body+"' alt='' class='private_message__body__image private_message__body__media' />";case"sound":return"<audio controls class='private_message__body__media'><source src='"+e.getBaseDir()+t.body+"' /></audio>";case"video":return"<video controls class='private_message__body__media'><source src='"+e.getBaseDir()+t.body+"' /></video>";case"youtube":return"<button id='yt-btn-"+t.id+"' class='yt-btn' data-msg-id='"+t.id+"' data-yid='"+t.body+"'><img src='images/youtube.png'/><img style='width: 80px' alt='[YouTube]' src='https://img.youtube.com/vi/"+t.body+"/0.jpg' /></button>";default:return""}}},{key:"render",value:function(t,r,n){var o="<div class='private_message linen' data-user-id='"+r.id+"'>";return o+="<p class='private_message__avatar'><img class='radius' width='28' height='28' src='"+r.avatar+"' /></p>",o+="<div>",o+="<h5 class='private_message__title'>",o+=S.render(r),o+="</h5>",o+="<h5 class='private_message__body' style='color: "+r.fontColor+"'>",o+=e.renderMessageBody(t,n),o+="</h5>",o+="</div>",o+="<span class='private_message__time fr time' data-time='"+t.time+"'>"+kr(t.time)+"</span>",o+="<div class='clear'></div>",o+="</div>"}}],(r=null)&&R(t.prototype,r),n&&R(t,n),e}(),x=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_PRIVATE_MESSAGES_FACE_PICKER",isPrivateMessagesFacePickerOpen:e}},M=(r(91),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_USER",user:e}}),D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_CURRENT_USER",updates:e}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_REQUESTED_USER",user:e}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_REQUESTED_USER",user:e}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_USER",user:e}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"REMOVE_USER",user:e}};function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.editRoom(t),e.deleteRoom(t)}},{key:"editRoom",value:function(t){$("#editRoomModal form").on("submit",(function(r){r.preventDefault();var n=r.target.name.value.trim(),o=r.target.description.value.trim(),i=r.target.welcome.value.trim(),a=r.target.password.value.trim(),s=r.target.required_likes.value,c=r.target.capacity.value,u=$(this).data("id");return n.length?n.length<2?e.showErrorMessage("       "):n!=t.getState().mUser.room.name&&t.getState().rooms.filter((function(e){return e.name==n})).length?e.showErrorMessage("  ,    "):c<2||c>50?e.showErrorMessage("      2  50"):void t.getState().socket.emit("req",wr({type:"EDIT_ROOM",data:{room:{id:u,name:n,description:o,welcome:i,password:a,required_likes:s,capacity:c,is_voice_room:t.getState().mUser.room.is_voice_room,is_video_room:t.getState().mUser.room.is_video_room}}}),(function(t){if("string"==typeof(t=Sr(t)))return alert(t);t&&"object"==j(t)&&(!1===t.error?e.showSuccessMessage("   "):!0===t.error&&e.showErrorMessage(t.message))})):e.showErrorMessage("   ")}))}},{key:"deleteRoom",value:function(t){$("#room_modal__body__form__delete").on("click",(function(r){t.getState().socket.emit("req",wr({type:"REMOVE_ROOM",data:{room:{id:t.getState().mUser.room.id}}}),(function(t){if("string"==typeof(t=Sr(t)))return alert(t);t&&"object"==j(t)&&(!1===t.error?e.showSuccessMessage("  ,     "):!0===t.error&&e.showErrorMessage(t.message))}))}))}},{key:"showErrorMessage",value:function(e){$("#editRoomModal .alert-success").hide(),$("#editRoomModal .alert-danger").text(e).show()}},{key:"showSuccessMessage",value:function(e){$("#editRoomModal .alert-success").text(e).show(),$("#editRoomModal .alert-danger").hide()}},{key:"render",value:function(t,r){var n=t.description?t.description:"",o=t.welcome?t.welcome:"",i=t.required_likes?t.required_likes:0,a="<div class='modal fade room_modal' id='editRoomModal' tabindex='-1' role='dialog' aria-hidden='true'>";a+="<div class='modal-dialog' role='document'>",a+="<div class='modal-content'>",a+="<div class='room_modal__header modal-header label label-primary'>",a+="<div class='modal-title'>",a+="<p class='room_modal__header__name ellipsis'> </p>",a+="<button data-dismiss='modal' class='btn btn-danger room_modal__header__close fa fa-times'></button>",a+="</div>",a+="</div>",a+="<div class='room_modal__body modal-body'>",a+="<p class='alert alert-danger' style='display: none'></p>",a+="<p class='alert alert-success' style='display: none'></p>",a+="<form data-id='"+t.id+"' id='room_modal__body__form'>",a+="<div>",a+="<div><input type='text' name='name' value='"+t.name+"' placeholder=' ' /></div>",a+="<div><input type='text' name='description' value='"+n+"' placeholder='' /></div>",a+="<div><input type='text' name='welcome' value='"+o+"' placeholder=' ' /></div>",a+="<div><input type='text' name='password' placeholder=' ' /></div>",a+="<div><input type='number' name='required_likes' value='"+i+"' placeholder=' ' /></div>",a+="<div><input type='number' name='capacity' value='"+t.capacity+"' placeholder='   2  50' /></div>",a+="<button class='btn btn-success pull-left'><span class='fa fa-save'></span> &nbsp;</button>",a+="<button id='room_modal__body__form__delete' type='button' class='btn btn-danger pull-right'><span class='fa fa-remove'></span> </button>",a+="</div>",a+="</form>",a+="</div>",a+="</div>",a+="</div>",a+="</div>",$("#room_modal__body__form__delete").unbind("click"),$("#editRoomModal form").unbind("submit"),$("#edit_room_container").html(a),e.registerEvents(r)}}],(r=null)&&F(t.prototype,r),n&&F(t,n),e}(),q=r(9),G=r.n(q);function V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var W=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onFormSubmited(t)}},{key:"onFormSubmited",value:function(t){$("#bot_brb_modal__body__form").unbind("submit").on("submit",(function(r){r.preventDefault(),r.originalEvent.submitter.classList.contains("btn-success")?e.start(t,$(this)):r.originalEvent.submitter.classList.contains("btn-warning")?e.pause(t,$(this)):r.originalEvent.submitter.classList.contains("btn-danger")?e.stop(t,$(this)):r.originalEvent.submitter.classList.contains("btn-info")&&e.update(t,$(this))}))}},{key:"start",value:function(t,r){var n=r.find("input[name='num_rounds']").val(),o=r.find("input[name='bot_brb_modal__body__form__speed']").val(),i=r.find("input[name='bot_brb_modal__body__form__excpel']").prop("checked"),a={type:"BOT_BRB_CREATE",data:{room_id:t.getState().mUser.room.id,num_rounds:n,excpel:i,speed:o}};t.getState().socket.emit("req",wr(a),(function(t){e.setBot(t.bot),$("#manageBotBrbModal .bot_brb_modal__header__close").click()}))}},{key:"pause",value:function(t,r){var n={type:"BOT_BRB_PAUSE",data:{room_id:t.getState().mUser.room.id}};t.getState().socket.emit("req",wr(n),(function(t){e.setBot(t.bot)}))}},{key:"stop",value:function(t,r){var n={type:"BOT_BRB_STOP",data:{room_id:t.getState().mUser.room.id}};t.getState().socket.emit("req",wr(n),(function(t){e.setBot(t.bot)}))}},{key:"update",value:function(t,r){var n=r.find("input[name='bot_brb_modal__body__form__speed']").val(),o={type:"BOT_BRB_UPDATE",data:{room_id:t.getState().mUser.room.id,speed:n}};t.getState().socket.emit("req",wr(o),(function(t){e.setBot(t.bot)}))}},{key:"setBot",value:function(e){if(!e)return $("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),void $("#bot_brb_modal__body__form__button--stop").attr("disabled","disabled");e.isPaused?($("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--stop").removeAttr("disabled")):e.isStopped?($("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--stop").attr("disabled","disabled")):e.isStarted&&($("#bot_brb_modal__body__form__button--start").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--pause").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--stop").removeAttr("disabled")),e.isStarted||e.isPaused?$("#bot_num_rounds, #bot_brb_modal__body__form__excpel").attr("disabled","disabled"):$("#bot_num_rounds, #bot_brb_modal__body__form__excpel").removeAttr("disabled"),$("#bot_num_rounds").val(e.num_rounds),$("#bot_brb_modal__body__form__speed").val(e.speed),e.excpel?$("#bot_brb_modal__body__form__excpel").attr("checked","checked"):$("#bot_brb_modal__body__form__excpel").removeAttr("checked")}},{key:"render",value:function(t){var r="<div class='modal fade bot_brb_modal' id='manageBotBrbModal' tabindex='-1' role='dialog' aria-hidden='true'>";r+="<div class='modal-dialog' role='document'>",r+="<div class='modal-content'>",r+="<div class='bot_brb_modal__header modal-header label label-primary'>",r+="<div class='modal-title'>",r+="<p class='bot_brb_modal__header__name ellipsis'>"+t.getState().mUser.room.name+"</p>",r+="<button data-dismiss='modal' class='btn btn-danger bot_brb_modal__header__close fa fa-times'></button>",r+="</div>",r+="</div>",r+="<div class='bot_brb_modal__body modal-body'>",r+="<p class='alert alert-danger' style='display: none'></p>",r+="<p class='alert alert-success' style='display: none'></p>",r+="<form id='bot_brb_modal__body__form'>",r+="<div>",r+="<div><input type='number' id='bot_num_rounds' min='2' max='10' name='num_rounds' value='5' placeholder=' ' /></div>",r+='<div class="form-group">',r+='<input type="checkbox" id="bot_brb_modal__body__form__excpel" name="bot_brb_modal__body__form__excpel"/>',r+='<label for="bot_brb_modal__body__form__excpel"> </label>',r+="</div>",r+='<div class="form-group">',r+='<label for="bot_brb_modal__body__form__speed"> </label><br>',r+="<input type='number' id='bot_brb_modal__body__form__speed' min='100' max='5000' name='bot_brb_modal__body__form__speed' value='1000' placeholder='  100  5000' style='width: 50%' />",r+="<button id='bot_brb_modal__body__form__button--update' class='btn btn-info pull-right'><span class='fa fa-refresh'></span> &nbsp;</button>",r+="</div>",r+="<div class='bot_brb_modal__body__form__buttons'>",r+="<button id='bot_brb_modal__body__form__button--start' class='btn btn-success'><span class='fa fa-play'></span>&nbsp;</button>",r+="<button id='bot_brb_modal__body__form__button--pause' class='btn btn-warning'><span class='fa fa-pause'></span> &nbsp;</button>",r+="<button id='bot_brb_modal__body__form__button--stop' class='btn btn-danger'><span class='fa fa-stop'></span>&nbsp;</button>",r+="</div>",r+="</div>",r+="</form>",r+="</div>",r+="</div>",r+="</div>",r+="</div>",$("#manage_bot_brb_container").html(r),e.registerEvents(t),e.setBot(null)}}],(r=null)&&V(t.prototype,r),n&&V(t,n),e}(),H=r(26),z=r.n(H),J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_POPUP",popup:e}},Y=function(e){return{type:"TRUST_USER_POPUP",user_id:e}};function X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var K=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.close(t),e.acceptLudo(t),e.refuseLudo(t),e.trustUser(t),e.acceptCam(t),e.refuseCam(t)}},{key:"close",value:function(e){$(".popup").unbind("click").on("click",(function(t){var r=$(this).data("id"),n=e.getState().popups.filter((function(e){return e.id=r}));e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"REMOVE_POPUP",popup:e}}(n)),$(this).remove()}))}},{key:"trustUser",value:function(e){$(".popup__message__body__trust_user").unbind("click").on("click",(function(t){var r=this;t.stopPropagation(),e.getState().socket.emit("req",wr({type:"TRUST_USER",data:{id:$(this).data("user-id"),name:$(this).data("user-name"),decoration:$(this).data("user-decoration")}}),(function(t){if(t=Sr(t),$(r).closest(".popup").click(),"string"==typeof t)return alert(t);if(t&&t.message&&alert(t.message),!t.error){var n=$(r).data("user-id");e.dispatch(Y(n))}}))}))}},{key:"acceptCam",value:function(e){$(".popup__request_cam_accept").unbind("click").on("click",(function(t){var r=this;t.stopPropagation(),e.getState().socket.emit("req",wr({type:"CAMERA_REQUEST_ACCEPT",data:{id:$(this).data("user-id")}}),(function(e){if(e=Sr(e),$(r).closest(".popup").click(),"string"==typeof e)return alert(e);e&&e.message&&alert(e.message)}))}))}},{key:"refuseCam",value:function(e){$(".popup__request_cam_refuse").unbind("click").on("click",(function(t){var r=this;t.stopPropagation(),e.getState().socket.emit("req",wr({type:"CAMERA_REQUEST_REFUSE",data:{id:$(this).data("user-id")}}),(function(e){if(e=Sr(e),$(r).closest(".popup").click(),"string"==typeof e)return alert(e);e&&e.message&&alert(e.message)}))}))}},{key:"acceptLudo",value:function(e){$(".popup__request_ludo_accept").unbind("click").on("click",(function(t){var r=this;t.stopPropagation(),e.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_REQUEST_ACCEPT",data:{id:$(this).data("user-id"),color:$(this).data("color")}}),(function(e){if(e=Sr(e),$(r).closest(".popup").click(),"string"==typeof e)return alert(e);e&&e.message&&alert(e.message)}))}))}},{key:"refuseLudo",value:function(e){$(".popup__request_ludo_refuse").unbind("click").on("click",(function(t){var r=this;t.stopPropagation(),e.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_REQUEST_REFUSE",data:{id:$(this).data("user-id"),color:$(this).data("color")}}),(function(e){if(e=Sr(e),$(r).closest(".popup").click(),"string"==typeof e)return alert(e);e&&e.message&&alert(e.message)}))}))}},{key:"getMarginLeft",value:function(e){return 2*e.getState().popups.length+30+"px"}},{key:"renderMessage",value:function(e,t){switch(e.type){case"like":return"<span>  <span style='color: red' class='fa fa-heart'></span></span>";case"gift":return"<span>  <img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"remove_gift":return"<span>  <img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"room_excpel":case"change_room":return"<p dir='rtl'>"+e.message+" <span>"+jt.render(e.room,!0,t)+"</span></p>";case"post_comment_like":case"post_commented":return"<p dir='rtl'>"+e.message+" <span><p class='popup__message__body'>"+e.comment+"</p></span></p>";case"login_banned":var r="<p>"+e.data.name+" ---- "+e.data.decoration+"</p>";return r+="<p>"+e.data.role+"</p>",r+="<p>"+e.data.ip+" <img src='/images/flags/"+e.data.country.toLowerCase()+".png' /></p>",r+="<p dir='rtl'>"+e.data.device+"</p>",e.data.isGuest||e.data.is_trusted||(r+="<p style='text-align: center'><button data-user-name='"+e.data.name+"' data-user-decoration='"+e.data.decoration+"' data-user-id='"+e.data.user_id+"' class='popup__message__body__trust_user btn btn-success'> </button></p>"),r;case"world_filter_notification":return"<p dir='rtl'>"+e.word.word+" <span><p class='popup__message__body'>"+e.word.text+"</p></span></p>";case"cam_request":var n="<span>      </span>";return n+="<p style='text-align: center'><button data-user-id='"+e.user.id+"' class='popup__request_cam_accept btn btn-success'></button><button data-user-id='"+e.user.id+"' class='popup__request_cam_refuse btn btn-danger'></button></p>";case"cam_request_accepted":return"<span>   </span>";case"cam_request_refused":return"<span>   </span>";case"ludo_request":var o="<span>       </span>";return o+="<p style='text-align: center'><button data-color='"+e.color+"' data-user-id='"+e.user.id+"' class='popup__request_ludo_accept btn btn-success'></button><button data-color='"+e.color+"' data-user-id='"+e.user.id+"' class='popup__request_ludo_refuse btn btn-danger'></button></p>";case"ludo_request_accepted":return"<span>   </span>";case"ludo_request_refused":return"<span>   </span>";case"ludo_ended":return"<span>  </span>";case"photo_like":return;default:return"<span>"+g.render(e.message,t)+"</span>"}}},{key:"render",value:function(t,r){var n="<div style='marginLeft: "+e.getMarginLeft(r)+"' data-id='"+t.id+"' class='popup'>";n+="<p class='popup__title label label-primary'>"+t.title+"</p>",t.user&&(n+="<div class='popup__sender fl'>",n+="<img src='"+t.user.avatar+"' width='24' height='24' class='popup__sender__avatar fl' />",n+="<p class='popup__sender__name'>"+S.render(t.user)+"</p>",n+="</div>"),n+="<div class='popup__message fl'>",n+=e.renderMessage(t,r),n+="</div>",n+="</div>",$("#popup_container").append(n),e.registerEvents(r)}}],(r=null)&&X(t.prototype,r),n&&X(t,n),e}();function Q(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ee(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onPlayerClicked(t),e.onDiceClicked(t),e.onClose(t),e.onHide(t)}},{key:"startGame",value:function(t,r,n){for(var o in window.ludoPlayers=[],window.isLudoWaitingForMove=!1,r){var i=r[o];i.user_id&&window.ludoPlayers.push(i)}t.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_START_GAME",data:{players:window.ludoPlayers,turn:window.ludoPlayers[0].color,isPublic:n}}),(function(r){if("string"==typeof(r=Sr(r)))return alert(r);window.ludoCurrentTurn=window.ludoPlayers[0].color,$(".pre_youcam_ludo_modal__header__close").trigger("click"),setTimeout((function(){$("#youcam_ludo_container").html(""),e.render(t,t.getState().mUser.id)}),500)}))}},{key:"onPlayerClicked",value:function(t){$(".player").unbind("click").on("click",(function(r){window.isLudoWaitingForMove=!1,e.movePlayer($(this),window.currentDiceValue,t,window.mUserLudoColor)}))}},{key:"parseGameState",value:function(){var e=[];return window.ludoPlayers.forEach((function(t){e.push({color:t.color,user_id:t.user_id,coin1:$("#"+t.color+"-player-1").data("cp"),coin2:$("#"+t.color+"-player-2").data("cp"),coin3:$("#"+t.color+"-player-3").data("cp"),coin4:$("#"+t.color+"-player-4").data("cp")})})),e}},{key:"onDiceClicked",value:function(t){$("#"+window.mUserLudoColor+"-dice").unbind("click").on("click",(function(r){var n=this;if(window.ludoCurrentTurn==window.mUserLudoColor&&!window.isLudoPlayerMoving&&!window.isDiceRolling&&!window.isLudoWaitingForMove&&window.ludoPlayers&&!(window.ludoPlayers.filter((function(e){return!e.winner})).length<2)){window.currentDiceValue=1+Math.floor(6*Math.random()),window.numberOfNonSixTries||(window.numberOfNonSixTries=0),window.numberOfNonSixTries>=10+Math.floor(6*Math.random())&&(window.currentDiceValue=6),6!=window.currentDiceValue?++window.numberOfNonSixTries:window.numberOfNonSixTries=0,window.hackedDiceValue&&(window.currentDiceValue=window.hackedDiceValue),t.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_DICE_CLICKED",data:{value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){})),$(this).attr("disabled","disabled"),e.isLudoMinimized()||(e.stopAllSounds(),window.dice_sound.play());var o=setInterval((function(){var e=1+Math.floor(6*Math.random());$(n).css("background-image","url(/images/dice"+e+".png)")}),50);window.isDiceRolling=!0,setTimeout((function(){$(n).css("background-image","url(/images/dice"+window.currentDiceValue+".png)"),$(n).removeAttr("disabled"),clearInterval(o),window.isDiceRolling=!1,window.isLudoWaitingForMove=!0;var r=e.autoMovePlayer(t);if(6!=window.currentDiceValue&&0==$(".bg-"+window.mUserLudoColor+"[data-status='active']").length)e.updateTurn(window.currentDiceValue,t),t.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_UPDATE_TURN",data:{currentTurn:window.ludoCurrentTurn,value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){}));else if(6!=window.currentDiceValue&&$(".bg-"+window.mUserLudoColor+"[data-status='active']").length>0){var i=!1;$(".bg-"+window.mUserLudoColor+"[data-status='active']").each((function(t,r){e.getRedPath().length-r.dataset.cp>=window.currentDiceValue&&(i=!0)})),i||r||(e.updateTurn(window.currentDiceValue,t),t.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_UPDATE_TURN",data:{currentTurn:window.ludoCurrentTurn,value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){})))}}),2e3)}}))}},{key:"rollDice",value:function(t,r){e.isLudoMinimized()||(e.stopAllSounds(),window.dice_sound.play());var n=$("#"+t+"-dice"),o=setInterval((function(){var e=1+Math.floor(6*Math.random());n.css("background-image","url(/images/dice"+e+".png)")}),50);setTimeout((function(){n.css("background-image","url(/images/dice"+r+".png)"),clearInterval(o)}),2e3)}},{key:"autoMovePlayer",value:function(t){var r=!1;if(6==window.currentDiceValue)if(0==$(".player.bg-"+window.mUserLudoColor+"[data-status='active']").length)$(".player.bg-"+window.mUserLudoColor+"[data-status='home']").first().trigger("click");else{var n=$(".player.bg-"+window.mUserLudoColor+"[data-status='active']"),o=$(".player.bg-"+window.mUserLudoColor+"[data-status='home']");if(n.length&&!o.length){var i=[];if(n.each((function(t,r){e.getRedPath().length-r.dataset.cp>=window.currentDiceValue&&i.push(r)})),1==i.length)e.getRedPath().length==window.currentDiceValue+parseInt(i[0].dataset.cp)&&(r=!0),$("#"+i[0].id).trigger("click");else if(i.length>1){var a=i[0].dataset.cp,s=0;i.forEach((function(e){e.dataset.cp==a&&s++})),i.length==s&&(e.getRedPath().length==window.currentDiceValue+parseInt(i[0].dataset.cp)&&(r=!0),$("#"+i[0].id).trigger("click"))}else i.length||(window.isLudoWaitingForMove=!1)}else if(o.length){var c=[];n.each((function(t,r){e.getRedPath().length-r.dataset.cp>=window.currentDiceValue&&c.push(r)})),c.length||o.first().trigger("click")}}else{var u=$(".player.bg-"+window.mUserLudoColor+"[data-status='active']");if(u.length){var l=[];if(u.each((function(t,r){e.getRedPath().length-r.dataset.cp>=window.currentDiceValue&&l.push(r)})),1==l.length)e.getRedPath().length==window.currentDiceValue+parseInt(l[0].dataset.cp)&&(r=!0),$("#"+l[0].id).trigger("click");else if(l.length>1){var d=l[0].dataset.cp,p=0;l.forEach((function(e){e.dataset.cp==d&&p++})),l.length==p&&(e.getRedPath().length==window.currentDiceValue+parseInt(l[0].dataset.cp)&&(r=!0),$("#"+l[0].id).trigger("click"))}}}return e.focusCurrentTurn(t),r}},{key:"getWinPlayers",value:function(t){return $(".player.bg-"+t+"[data-status='win'][data-cp='"+e.getRedPath().length+"']").length}},{key:"updateTurn",value:function(t,r){if(6!=t)if(window.isLudoWaitingForMove=!1,"red"==window.ludoCurrentTurn){if(window.ludoPlayers.filter((function(e){return"green"==e.color}))[0]&&e.getWinPlayers("green")<4)return window.ludoCurrentTurn="green",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0]&&e.getWinPlayers("yellow")<4)return window.ludoCurrentTurn="yellow",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0]&&e.getWinPlayers("blue")<4)return window.ludoCurrentTurn="blue",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"red"==e.color}))[0]&&e.getWinPlayers("red")<4)return window.ludoCurrentTurn="red",void e.focusCurrentTurn(r)}else if("green"==window.ludoCurrentTurn){if(window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0]&&e.getWinPlayers("yellow")<4)return window.ludoCurrentTurn="yellow",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0]&&e.getWinPlayers("blue")<4)return window.ludoCurrentTurn="blue",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"red"==e.color}))[0]&&e.getWinPlayers("red")<4)return window.ludoCurrentTurn="red",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"green"==e.color}))[0]&&e.getWinPlayers("green")<4)return window.ludoCurrentTurn="green",void e.focusCurrentTurn(r)}else if("yellow"==window.ludoCurrentTurn){if(window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0]&&e.getWinPlayers("blue")<4)return window.ludoCurrentTurn="blue",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"red"==e.color}))[0]&&e.getWinPlayers("red")<4)return window.ludoCurrentTurn="red",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"green"==e.color}))[0]&&e.getWinPlayers("green")<4)return window.ludoCurrentTurn="green",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0]&&e.getWinPlayers("yellow")<4)return window.ludoCurrentTurn="yellow",void e.focusCurrentTurn(r)}else if("blue"==window.ludoCurrentTurn){if(window.ludoPlayers.filter((function(e){return"red"==e.color}))[0]&&e.getWinPlayers("red")<4)return window.ludoCurrentTurn="red",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"green"==e.color}))[0]&&e.getWinPlayers("green")<4)return window.ludoCurrentTurn="green",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0]&&e.getWinPlayers("yellow")<4)return window.ludoCurrentTurn="yellow",void e.focusCurrentTurn(r);if(window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0]&&e.getWinPlayers("blue")<4)return window.ludoCurrentTurn="blue",void e.focusCurrentTurn(r)}}},{key:"movePlayer",value:function(t,r,n,o){if(r>6&&(r=6),r<0&&(r=1),!window.isLudoPlayerMoving&&!window.isDiceRolling&&r&&window.ludoCurrentTurn==o&&t.hasClass("bg-"+o)&&!(6!=r&&"home"==t.data("status")||"win"==t.data("status")||e.getRedPath().length-t.data("cp")<r)){o==window.mUserLudoColor&&n.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_PLAYER_CLICKED",data:{value:r,players:window.ludoPlayers,color:window.mUserLudoColor,id:t.attr("id")}}),(function(e){}));var i=t.attr("data-cp"),a=r;if(6==r&&"home"==t.data("status")){t.attr("data-status","active");var s=$("."+o+"-home .white-box .player-room").html();$("."+o+"-home .white-box .player-room").html(s.replace(t.get(0).outerHTML,"")),a=1}for(var c=[],u=0;u<a;u++)c.push(1);(function(){var r,a=(r=z.a.mark((function r(){var a,s,u,l,d,p,f,h,m,_,g;return z.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:window.isLudoPlayerMoving=!0,a=Q(c),r.prev=2,a.s();case 4:if((s=a.n()).done){r.next=32;break}if(s.value,"win"!=e.getPath(o)[i]){r.next=25;break}return e.isLudoMinimized()||window.winner_sound.play(),u=t.get(0).outerHTML,(l=window.ludoSteps[e.getPath(o)[i-1]]).innerHTML=l.innerHTML.replace(u,""),t.attr("data-status","win"),t.attr("data-cp",++i),d="","red"==o&&(d=".rwh"),"green"==o&&(d=".gwh"),"yellow"==o&&(d=".ywh"),"blue"==o&&(d=".bwh"),$(".winner-home "+d).html($(".winner-home "+d).html()+t.get(0).outerHTML),e.getWinPlayers(o)>3&&((p=$("."+o+"-home")).addClass("home-win"),p.find(".white-box").css("background-image","url(/images/crown"+$(".home-win").length+".png)"),p.css("opacity","1"),window.ludoPlayers=window.ludoPlayers.map((function(e){return e.color==o&&(e.winner=!0),e})),o==window.mUserLudoColor&&(f=window.ludoPlayers.filter((function(e){return e.winner})).length<2,n.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_WIN_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor,gameEnded:f}}),(function(e){})),f&&e.resetData(!1))),r.next=22,e.sleep(150);case 22:return r.abrupt("return",0);case 25:h=window.ludoSteps[e.getPath(o)[i]],0!=i?(m=t.get(0).outerHTML,(_=window.ludoSteps[e.getPath(o)[i-1]]).innerHTML=_.innerHTML.replace(m,""),i++,t.attr("data-cp",i),m=t.get(0).outerHTML,h.innerHTML=h.innerHTML+m):(i++,t.attr("data-cp",i),g=t.get(0).outerHTML,h.innerHTML=h.innerHTML+g),e.isLudoMinimized()||(e.stopAllSounds(),window.step_sound.play());case 28:return r.next=30,e.sleep(150);case 30:r.next=4;break;case 32:r.next=37;break;case 34:r.prev=34,r.t0=r.catch(2),a.e(r.t0);case 37:return r.prev=37,a.f(),r.finish(37);case 40:case"end":return r.stop()}}),r,null,[[2,34,37,40]])})),function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){ee(i,n,o,a,s,"next",e)}function s(e){ee(i,n,o,a,s,"throw",e)}a(void 0)}))});return function(){return a.apply(this,arguments)}})()().then((function(){if(i<e.getPath(o).length){var t=[],a=0,s=window.ludoSteps[e.getPath(o)[i-1]];if(s.children.length>1&&!e.getSafeStops().includes(e.getPath(o)[i-1])){for(u=0;u<s.children.length;u++){var c=s.children[u],l="red";c.classList.contains("bg-green")&&(l="green"),c.classList.contains("bg-yellow")&&(l="yellow"),c.classList.contains("bg-blue")&&(l="blue"),c&&c.classList.contains("player")&&l!=o&&(c.dataset.cp="0",c.dataset.status="home",$("."+l+"-home .white-box .player-room").append(c.outerHTML),t.push(c),e.isLudoMinimized()||window.dead_sound.play(),window.isLudoPlayerMoving=!1,window.currentDiceValue=0,e.onPlayerClicked(n))}if(t.forEach((function(e){e.remove(),a++})),a>0)return 0}}window.isLudoPlayerMoving=!1,window.currentDiceValue=0,o==window.mUserLudoColor&&n.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_UPDATE_GAME_STATE",data:{players:window.ludoPlayers,currentTurn:window.ludoCurrentTurn,color:window.mUserLudoColor,state:e.parseGameState()}}),(function(e){})),e.onPlayerClicked(n),e.updateTurn(r,n)}))}}},{key:"focusCurrentTurn",value:function(t){$(".step").css("z-index","0"),$(".super-center").removeClass("active"),$(".super-center."+window.ludoCurrentTurn+"-home").addClass("active"),e.getSafeStops().forEach((function(e){if(e){var t=window.ludoSteps[e];if(t.children.length>1){var r,n=Q(t.children);try{for(n.s();!(r=n.n()).done;){var o=r.value;o.classList.contains("bg-"+window.ludoCurrentTurn)?o.style.zIndex="1":o.style.zIndex="0"}}catch(e){n.e(e)}finally{n.f()}}else 1==t.children.length&&(t.children[0].style.zIndex="1")}})),window.ludoCurrentTurn==window.mUserLudoColor&&$("#show_ludo").addClass("active"),t&&window.ludoCurrentTurn==window.mUserLudoColor&&t.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_SET_TURN",data:{currentTurn:window.ludoCurrentTurn}}),(function(e){}))}},{key:"getSafeStops",value:function(){return[19,6,5,27,52,65,66,44]}},{key:"sleep",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"stopAllSounds",value:function(){window.step_sound.pause(),window.step_sound.currentTime=0,window.dead_sound.pause(),window.dead_sound.currentTime=0,window.inout_sound.pause(),window.inout_sound.currentTime=0,window.dice_sound.pause(),window.dice_sound.currentTime=0}},{key:"getPath",value:function(e){return"red"==e?[19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,31,32,33,34,35,"win"]:"green"==e?[5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,4,7,10,13,16,"win"]:"yellow"==e?[52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,40,39,38,37,36,"win"]:"blue"==e?[66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,67,64,61,58,55,"win"]:void 0}},{key:"getRedPath",value:function(){return[19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,31,32,33,34,35,"win"]}},{key:"getGreenPath",value:function(){return[5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,4,7,10,13,16,"win"]}},{key:"getYellowPath",value:function(){return[52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,40,39,38,37,36,"win"]}},{key:"getBluePath",value:function(){return[66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,67,64,61,58,55,"win"]}},{key:"setSizes",value:function(){var e=$(".winner-home").prop("clientHeight"),t=Math.round(Or(50,e)),r=Math.round(Or(40,e)),n=Math.round(Or(28,e));if($(".winner-home .stack").css("border-width",t),$("#red-dice, #green-dice, #yellow-dice, #blue-dice").css("width",r).css("height",r),$(".player-room").css("gap",n),document.body.clientWidth<750){$(".ludo-board").css("width","100vw").css("height","100vw");var o=Math.round(Or(17,e));$(".player").css("width",o).css("height",o)}else{$(".ludo-board").css("width","80vh").css("height","80vh");var i=Math.round(Or(20,e));$(".player").css("width",i).css("height",i)}document.body.clientWidth>900?$("main").css("padding-top","10vh"):$("main").css("padding-top","0"),e=$(".winner-home").prop("clientHeight"),t=Math.round(Or(50,e)),$(".winner-home .stack").css("border-width",t)}},{key:"onClose",value:function(t){$("#ludo-board__close").unbind("click").on("click",(function(r){$(this).closest(".ludo-board").data("u")==t.getState().mUser.id?e.endGame(t):e.exit(t)}))}},{key:"onHide",value:function(t){$("#ludo-board__hide").unbind("click").on("click",(function(r){$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),e.onShowLudo(t)}))}},{key:"onShowLudo",value:function(e){$("#show_ludo").unbind("click").on("click",(function(t){$("#show_ludo").remove(),$("#youcam_ludo_container main").show(),e.dispatch(n(null)),pr.togglePane(e,!0)}))}},{key:"exit",value:function(t){t.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_EXIT_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){})),e.resetData(!0)}},{key:"endGame",value:function(e){e.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_END_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){}))}},{key:"userOut",value:function(t,r){window.ludoPlayers=window.ludoPlayers.filter((function(e){return e.color!=r})),window.ludoCurrentTurn==r&&e.updateTurn(void 0,t),$(".ludo_user."+r).remove(),window.ludoPlayers.filter((function(e){return!e.winner})).length<2&&(window.mUserLudoColor&&t.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_END_PUBLIC_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){})),e.resetData(!window.mUserLudoColor))}},{key:"gameEnded",value:function(t,r){var n=window.ludoPlayers.filter((function(e){return e.color==r}))[0],o=t.getState().users.filter((function(e){return e.id==n.user_id}))[0];if(o){var i={id:Date.now(),user:o,data:o,type:"ludo_ended",title:" "};t.dispatch(J(i)),K.render(i,t)}e.resetData(!0)}},{key:"resetData",value:function(e){e&&$("#youcam_ludo_container").html(""),window.ludoCurrentTurn=void 0,window.mUserLudoColor=void 0,window.ludoPlayers=[],window.isLudoPlayerMoving=!1,window.isLudoWaitingForMove=!1,window.currentDiceValue=0}},{key:"renderUser",value:function(e){if(!e)return"";var t="<div class='ludo_user "+e.color+"' >";return t+="<img class='ludo_user--avatar' src='"+e.avatar+"' />",t+=S.render(e),t+="</div>"}},{key:"isLudoMinimized",value:function(){return!!$("#show_ludo").length}},{key:"setState",value:function(t,r){t.players.forEach((function(t){for(var r=1;r<=4;r++){var n=t["coin"+r];if(n>0){var o=window.ludoSteps[e.getPath(t.color)[n-1]],i=$("#"+t.color+"-player-"+r);if(i.attr("data-cp",n),n==e.getRedPath().length){i.attr("data-status","win");var a=i.get(0).outerHTML,s="";"red"==t.color&&(s=".rwh"),"green"==t.color&&(s=".gwh"),"yellow"==t.color&&(s=".ywh"),"blue"==t.color&&(s=".bwh"),$(".winner-home "+s).html($(".winner-home "+s).html()+a)}else{i.attr("data-status","active");var c=i.get(0).outerHTML;o.innerHTML=o.innerHTML+c}i.remove()}}})),e.onPlayerClicked(r)}},{key:"render",value:function(t,r,o){if(t.getState().mUser.room){r||(r="");var i=t.getState().users.filter((function(e){return e.room&&e.room.id==t.getState().mUser.room.id})),a=null,s=null,c=null,u=null,l=window.ludoPlayers.filter((function(e){return"red"==e.color}))[0];l&&((a=i.filter((function(e){return e.id==l.user_id}))[0]).color="red");var d=window.ludoPlayers.filter((function(e){return"green"==e.color}))[0];d&&((s=i.filter((function(e){return e.id==d.user_id}))[0]).color="green");var p=window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0];p&&((c=i.filter((function(e){return e.id==p.user_id}))[0]).color="yellow");var f=window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0];f&&((u=i.filter((function(e){return e.id==f.user_id}))[0]).color="blue");var h='<main class="container">';h+='<span id="ludo-board__top_buttons">',window.mUserLudoColor&&(h+="<button class='btn btn-danger fa fa-times' id='ludo-board__close'></button>"),h+="<button class='btn btn-warning fa fa-minus' id='ludo-board__hide'></button>",h+="</span>",h+='<div class="ludo-board" data-u="'+r+'">',h+='<div class="red-home red-home-bg bg-red super-center">',h+='<button id="red-dice" class="d0"></button>',h+='<div class="white-box super-center">',h+='<div class="player-room">',h+='<div data-status="home" data-cp="0" class="player bg-red movered1" id="red-player-1"></div>',h+='<div data-status="home" data-cp="0" class="player bg-red movered2" id="red-player-2"></div>',h+='<div data-status="home" data-cp="0" class="player bg-red movered3" id="red-player-3"></div>',h+='<div data-status="home" data-cp="0" class="player bg-red movered4" id="red-player-4"></div>',h+="</div>",h+="</div>",h+=e.renderUser(a),h+="</div>",h+='<div class="step"></div>',h+='<div class="step"><span class="fa fa-arrow-down green"><span></div>',h+='<div class="step"></div>',h+='<div class="green-home green-home-bg bg-green super-center">',h+='<button id="green-dice" class="d0"></button>',h+='<div class="white-box super-center">',h+='<div class="player-room">',h+='<div data-status="home" data-cp="0" class="player bg-green movegreen1" id="green-player-1"></div>',h+='<div data-status="home" data-cp="0" class="player bg-green movegreen2" id="green-player-2"></div>',h+='<div data-status="home" data-cp="0" class="player bg-green movegreen3" id="green-player-3"></div>',h+='<div data-status="home" data-cp="0" class="player bg-green movegreen4" id="green-player-4"></div>',h+="</div>",h+="</div>",h+=e.renderUser(s),h+="</div>",h+='<div class="step"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step red-stop"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-red">',h+="</div>",h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="winner-home">',h+='<div class="rwh stack"></div>',h+='<div class="gwh stack"></div>',h+='<div class="bwh stack"></div>',h+='<div class="ywh stack"></div>',h+="</div>",h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step green-stop"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"><span class="fa fa-arrow-right red"></span></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step"><span class="fa fa-arrow-left yellow"></span></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step blue-stop"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step"></div>',h+='<div class="blue-home bg-blue blue-home-bg super-center">',h+='<button id="blue-dice" class="d0"></button>',h+='<div class="white-box super-center">',h+='<div class="player-room">',h+='<div data-status="home" data-cp="0" class="player bg-blue moveblue1" id="blue-player-1"></div>',h+='<div data-status="home" data-cp="0" class="player bg-blue moveblue2" id="blue-player-2"></div>',h+='<div data-status="home" data-cp="0" class="player bg-blue moveblue3" id="blue-player-3"></div>',h+='<div data-status="home" data-cp="0" class="player bg-blue moveblue4" id="blue-player-4"></div>',h+="</div>",h+="</div>",h+=e.renderUser(u),h+="</div>",h+='<div class="step"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step"></div>',h+='<div class="yellow-home yellow-home-bg bg-yellow super-center">',h+='<button id="yellow-dice" class="d0"></button>',h+='<div class="white-box super-center">',h+='<div class="player-room">',h+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow1" id="yellow-player-1"></div>',h+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow2" id="yellow-player-2"></div>',h+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow3" id="yellow-player-3"></div>',h+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow4" id="yellow-player-4"></div>',h+="</div>",h+="</div>",h+=e.renderUser(c),h+="</div>",h+='<div class="step"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step yellow-stop"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"><span class="fa fa-arrow-up blue"></span></div>',h+='<div class="step"></div>',h+="</div>",h+="</main>",$("#youcam_ludo_container").html(h),t.dispatch(n(null)),pr.togglePane(t,!0),window.ludoSteps=document.getElementsByClassName("step"),window.step_sound=new Audio("/step.mp3"),window.dead_sound=new Audio("/dead.mp3"),window.inout_sound=new Audio("/inout.mp3"),window.dice_sound=new Audio("/dice3.mp3"),window.winner_sound=new Audio("/winner.mp3"),window.ludoPlayers&&window.ludoPlayers.length&&window.ludoPlayers.forEach((function(e){e&&$("#"+e.color+"-dice").show()})),o&&e.setState(o,t),e.setSizes(),e.focusCurrentTurn(t),e.registerEvents(t)}}}],(r=null)&&te(t.prototype,r),o&&te(t,o),e}();function ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var oe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.requestRed(t),e.requestGreen(t),e.requestYellow(t),e.requestBlue(t),e.startGame(t)}},{key:"requestRed",value:function(e){$("#pre_youcam_ludo_modal__body__form--request-red").unbind("click").on("click",(function(t){t.preventDefault();var r=$("#pre_youcam_ludo_modal__body__form--select-red").val(),n=$("#pre_youcam_ludo_modal__body__form--select-green").val(),o=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),i=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return r?(n==r&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),o==r&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),i==r&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-red__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-red").hide(),r==e.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-red__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-red").prop("disabled",!0)):(e.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_REQUEST",data:{user:r,color:"red"}}),(function(e){e=Sr(e)})),void setTimeout((function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-red__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-red__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-red").show())}),1e4))):alert("    ")}))}},{key:"requestGreen",value:function(e){$("#pre_youcam_ludo_modal__body__form--request-green").unbind("click").on("click",(function(t){t.preventDefault();var r=$("#pre_youcam_ludo_modal__body__form--select-red").val(),n=$("#pre_youcam_ludo_modal__body__form--select-green").val(),o=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),i=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return n?(r==n&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),o==n&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),i==n&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-green__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-green").hide(),n==e.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-green__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-green").prop("disabled",!0)):(e.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_REQUEST",data:{user:n,color:"green"}}),(function(e){e=Sr(e)})),void setTimeout((function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-green__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-green__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-green").show())}),1e4))):alert("    ")}))}},{key:"requestYellow",value:function(e){$("#pre_youcam_ludo_modal__body__form--request-yellow").unbind("click").on("click",(function(t){t.preventDefault();var r=$("#pre_youcam_ludo_modal__body__form--select-red").val(),n=$("#pre_youcam_ludo_modal__body__form--select-green").val(),o=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),i=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return o?(r==o&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),n==o&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),i==o&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-yellow__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-yellow").hide(),o==e.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-yellow__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-yellow").prop("disabled",!0)):(e.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_REQUEST",data:{user:o,color:"yellow"}}),(function(e){e=Sr(e)})),void setTimeout((function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-yellow__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-yellow__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-yellow").show())}),1e4))):alert("    ")}))}},{key:"requestBlue",value:function(e){$("#pre_youcam_ludo_modal__body__form--request-blue").unbind("click").on("click",(function(t){t.preventDefault();var r=$("#pre_youcam_ludo_modal__body__form--select-red").val(),n=$("#pre_youcam_ludo_modal__body__form--select-green").val(),o=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),i=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return i?(r==i&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),o==i&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),n==i&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),$("#pre_youcam_ludo_modal__body__form--request-blue__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-blue").hide(),i==e.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-blue__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-blue").prop("disabled",!0)):(e.getState().socket.emit("req",wr({type:"YOUCAM_LUDO_REQUEST",data:{user:i,color:"blue"}}),(function(e){e=Sr(e)})),void setTimeout((function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-blue__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-blue__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-blue").show())}),1e4))):alert("    ")}))}},{key:"startGame",value:function(e){$(".pre_youcam_ludo_modal__body__form__button--start").unbind("click").on("click",(function(t){t.preventDefault();var r=$(this).hasClass("public"),n=document.querySelector("#pre_youcam_ludo_modal__body__form--select-red").value,o=document.querySelector("#pre_youcam_ludo_modal__body__form--select-green").value,i=document.querySelector("#pre_youcam_ludo_modal__body__form--select-yellow").value,a=document.querySelector("#pre_youcam_ludo_modal__body__form--select-blue").value;n==e.getState().mUser.id&&(window.mUserLudoColor="red"),o==e.getState().mUser.id&&(window.mUserLudoColor="green"),i==e.getState().mUser.id&&(window.mUserLudoColor="yellow"),a==e.getState().mUser.id&&(window.mUserLudoColor="blue"),re.startGame(e,[{color:"red",user_id:n},{color:"green",user_id:o},{color:"yellow",user_id:i},{color:"blue",user_id:a}],r)}))}},{key:"render",value:function(t){if(t.getState().mUser.room){var r=t.getState().users.filter((function(e){return e.room&&e.room.id==t.getState().mUser.room.id})),n="<div class='modal fade pre_youcam_ludo_modal' id='preYoucamLudoModal' tabindex='-1' role='dialog' aria-hidden='true'>";n+="<div class='modal-dialog' role='document'>",n+="<div class='modal-content'>",n+="<div class='pre_youcam_ludo_modal__header modal-header label label-primary'>",n+="<div class='modal-title'>",n+="<p class='pre_youcam_ludo_modal__header__name ellipsis'> </p>",n+="<button data-dismiss='modal' class='btn btn-danger pre_youcam_ludo_modal__header__close fa fa-times'></button>",n+="</div>",n+="</div>",n+="<div class='pre_youcam_ludo_modal__body modal-body'>",n+="<p class='alert alert-danger' style='display: none'></p>",n+="<p class='alert alert-success' style='display: none'></p>",n+="<form id='pre_youcam_ludo_modal__body__form'>",n+="<div>",n+="<div><img height='30' class='pre_youcam_ludo_modal__body__form--player-icon' src='/images/ludo_red.png' />",n+="<select id='pre_youcam_ludo_modal__body__form--select-red' name='red' class='pre_youcam_ludo_modal__body__form--select'>",n+="<option dir='rtl' value=''>--</option>",r.forEach((function(e){n+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"})),n+="</select>",n+="<button id='pre_youcam_ludo_modal__body__form--request-red' class='btn btn-primary btn btn-default'></button>",n+="<img id='pre_youcam_ludo_modal__body__form--request-red__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",n+="<div><img height='30' src='/images/ludo_green.png' />",n+="<select id='pre_youcam_ludo_modal__body__form--select-green' name='green' class='pre_youcam_ludo_modal__body__form--select'>",n+="<option dir='rtl' value=''>--</option>",r.forEach((function(e){n+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"})),n+="</select>",n+="<button id='pre_youcam_ludo_modal__body__form--request-green' class='btn btn-primary btn btn-default'></button>",n+="<img id='pre_youcam_ludo_modal__body__form--request-green__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",n+="<div><img height='30' src='/images/ludo_yellow.png' />",n+="<select id='pre_youcam_ludo_modal__body__form--select-yellow' name='yellow' class='pre_youcam_ludo_modal__body__form--select'>",n+="<option dir='rtl' value=''>--</option>",r.forEach((function(e){n+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"})),n+="</select>",n+="<button id='pre_youcam_ludo_modal__body__form--request-yellow' class='btn btn-primary btn btn-default'></button>",n+="<img id='pre_youcam_ludo_modal__body__form--request-yellow__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",n+="<div><img height='30' src='/images/ludo_blue.png' />",n+="<select id='pre_youcam_ludo_modal__body__form--select-blue' name='blue' class='pre_youcam_ludo_modal__body__form--select'>",n+="<option dir='rtl' value=''>--</option>",r.forEach((function(e){n+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"})),n+="</select>",n+="<button id='pre_youcam_ludo_modal__body__form--request-blue' class='btn btn-primary btn btn-default'></button>",n+="<img id='pre_youcam_ludo_modal__body__form--request-blue__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",n+="<div class='pre_youcam_ludo_modal__body__form__buttons'>",n+="<button disabled class='pre_youcam_ludo_modal__body__form__button--start private btn btn-success'><span class='fa fa-play'></span>   &nbsp;</button>",n+="<button disabled class='pre_youcam_ludo_modal__body__form__button--start public btn btn-success'><span class='fa fa-users'></span>   &nbsp;</button>",n+="</div>",n+="</div>",n+="</form>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",$("#youcam_ludo_container").html(n),e.registerEvents(t)}}}],(r=null)&&ne(t.prototype,r),n&&ne(t,n),e}();function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ae=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.submit(t),e.initJSColor(),e.openAdmin(t),e.closeChat(t),e.onBotBrbClicked(t),e.openIngoredUsers(t),e.removeNameBgColor(t),e.openNotifications(t),e.changeFontSize(t),e.hideRoleIcon(t),e.triggerChangeAvatarInput(t),e.changeAvatar(t),e.removeAvatar(t),e.clearPublicMessages(t),e.togglePrivate(t),e.toggleNotifications(t),e.changePassword(t),e.sendAd(t),e.lockRoom(t),e.manageRoom(t),e.youcamLudo(t),e.setLockedMics(t)}},{key:"prependHash",value:function(e){return"string"!=typeof e?"":e.includes("#")?e:"#"+e}},{key:"initJSColor",value:function(){var e=document.getElementsByClassName("jscolor");for(var t in e)try{new jscolor(e[t]).importColor()}catch(e){}}},{key:"changeFontSize",value:function(e){$("#chat__body__settings_pane__container__button--change-font-size option[value='"+e.getState().mUser.fontSize+"']").attr("selected","selected"),document.querySelector("html").style.fontSize=e.getState().mUser.fontSize+"px",$("#chat__body__settings_pane__container__button--change-font-size").on("change",(function(t){var r={type:"USER_SETTINGS_SET_FONT_SIZE",data:{fontSize:t.target.value}};e.getState().socket.emit("req",wr(r),(function(t){t=Sr(t),e.getState().mUser.reg_id||yr("fontSize",wr(t,!0)),e.dispatch(D({fontSize:t})),document.querySelector("html").style.fontSize=t+"px"}))}))}},{key:"submit",value:function(t){$("#chat__body__settings_pane form").on("submit",(function(r){r.preventDefault();var n=r.target.decoration.value.substring(0,50),o=r.target.status.value.substring(0,150);if(t.getState().mUser.name!=n&&t.getState().mUser.likes<t.getState().settings.required_likes_to_change_name_status)return alert("    "+t.getState().settings.required_likes_to_change_name_status+"     ");if(t.getState().mUser.status!=o&&t.getState().mUser.likes<t.getState().settings.required_likes_to_change_name_status)return alert("    "+t.getState().settings.required_likes_to_change_name_status+"     ");var i={type:"USER_SETTINGS_SAVE",data:{decoration:n,status:o,fontColor:e.prependHash(r.target.fontColor.value.trim()),nameColor:e.prependHash(r.target.nameColor.value.trim()),nameBgColor:e.prependHash(r.target.nameBgColor.value.trim()),statusColor:e.prependHash(r.target.statusColor.value.trim())}};t.getState().socket.emit("req",wr(i),(function(e){e=Sr(e),t.getState().mUser.reg_id||Object.keys(e).forEach((function(t){yr(t="name"==t?"gun":t,wr(e["gun"==t?"name":t],!0))}))}))}))}},{key:"triggerChangeAvatarInput",value:function(e){$("#chat__body__settings_pane__container__button--change_avatar").on("click",(function(t){if(e.getState().mUser.likes<e.getState().settings.required_likes_to_change_avatar)return alert("    "+e.getState().settings.required_likes_to_change_avatar+"     ");if(!$(this).hasClass("is-loading")){var r=document.getElementById("change_avatar_input");r&&r.click()}}))}},{key:"changeAvatar",value:function(t){$("#change_avatar_input").on("change",(function(r){var n=new FormData;n.append("avatar",r.target.files[0]),$("#chat__body__settings_pane__container__button--change_avatar").addClass("disabled"),G.a.post("/change_avatar",n).then((function(r){if($("#chat__body__settings_pane__container__button--change_avatar").removeClass("disabled"),!1===r.data.error){var n={type:"USER_SETTINGS_CHANGE_AVATAR",data:{avatar:r.data.avatar}};t.getState().socket.emit("req",wr(n),(function(r){t.getState().mUser.reg_id||yr("avatar",wr(r,!0)),r=Sr(r),e.updateUserAttribute("avatar","/uploads/avatars/sm/"+r,t),$("#chat__body__settings_pane__container__button--change_avatar .avatar").attr("src","/uploads/avatars/sm/"+r)}))}})).catch((function(e){}))}))}},{key:"removeAvatar",value:function(t){$("#chat__body__settings_pane__container__button--remove-avatar").on("click",(function(r){confirm("     ")&&t.getState().socket.emit("req",wr({type:"USER_SETTINGS_REMOVE_AVATAR",data:{}}),(function(r){t.getState().mUser.reg_id||yr("avatar",null),r=Sr(r),e.updateUserAttribute("avatar",r,t),$("#chat__body__settings_pane__container__button--change_avatar .avatar").attr("src",r)}))}))}},{key:"clearPublicMessages",value:function(e){$("#chat__body__settings_pane__container__button--clear-public-messages").on("click",(function(t){e.getState().socket.emit("req",wr({type:"USER_SETTINGS_CLEAR_PUBLIC_MESSAGES",data:{}}),(function(e){}))}))}},{key:"updateUserAttribute",value:function(e,t,r){var n={};n[e]=t,r.dispatch(D(n))}},{key:"updateDecoration",value:function(e){$("#chat__body__settings_pane form input[name='decoration']").val(e.getState().mUser.name)}},{key:"openIngoredUsers",value:function(e){$("#chat__body__settings_pane__container__button--ignored_users").on("click",(function(t){e.dispatch(n("ignored_users")),pr.togglePane(e)}))}},{key:"openNotifications",value:function(e){$("#chat__body__settings_pane__container__button--notifications").on("click",(function(t){e.dispatch(n("notifications")),pr.togglePane(e)}))}},{key:"removeNameBgColor",value:function(t){$(".chat__body__settings_pane__container__rm_bg_color").on("click",(function(r){t.getState().socket.emit("req",wr({type:"USER_SETTINGS_REMOVE_NAME_BG_COLOR",data:{}}),(function(r){r=Sr(r),t.getState().mUser.reg_id||yr("nameBgColor",wr(r,!0)),e.updateUserAttribute("nameBgColor",r,t),$("input[name='nameBgColor']").val("FFFFFF"),e.initJSColor()}))}))}},{key:"hideRoleIcon",value:function(t){$("#chat__body__settings_pane__container__button--toggle-star").on("click",(function(r){t.getState().socket.emit("req",wr({type:"USER_SETTINGS_HIDE_ROLE_ICON",data:{}}),(function(r){r=Sr(r),e.updateUserAttribute("isRoleIconHidden",r,t),r?($("#chat__body__settings_pane__container__button--toggle-star .toggle_star__hide").removeClass("toggle_star--active"),$("#chat__body__settings_pane__container__button--toggle-star .toggle_star__show").addClass("toggle_star--active")):($("#chat__body__settings_pane__container__button--toggle-star .toggle_star__hide").addClass("toggle_star--active"),$("#chat__body__settings_pane__container__button--toggle-star .toggle_star__show").removeClass("toggle_star--active"))}))}))}},{key:"togglePrivate",value:function(t){$("#chat__body__settings_pane__container__button--toggle_private").on("click",(function(r){t.getState().socket.emit("req",wr({type:"USER_SETTINGS_TOGGLE_PRIVATE",data:{}}),(function(r){r=Sr(r),e.updateUserAttribute("isPrivateDisabled",r,t),r?($("#chat__body__settings_pane__container__button--toggle_private .toggle_private__disable").removeClass("toggle_private--active"),$("#chat__body__settings_pane__container__button--toggle_private .toggle_private__enable").addClass("toggle_private--active")):($("#chat__body__settings_pane__container__button--toggle_private .toggle_private__disable").addClass("toggle_private--active"),$("#chat__body__settings_pane__container__button--toggle_private .toggle_private__enable").removeClass("toggle_private--active"))}))}))}},{key:"toggleNotifications",value:function(t){$("#chat__body__settings_pane__container__button--toggle_notifications").on("click",(function(r){t.getState().socket.emit("req",wr({type:"USER_SETTINGS_TOGGLE_NOTIFICATIONS",data:{}}),(function(r){r=Sr(r),e.updateUserAttribute("isNotificationsDisabled",r,t),r?($("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__disable").removeClass("toggle_notifications--active"),$("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__enable").addClass("toggle_notifications--active")):($("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__disable").addClass("toggle_notifications--active"),$("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__enable").removeClass("toggle_notifications--active"))}))}))}},{key:"changePassword",value:function(e){$("#chat__body__settings_pane__container__button-change_password").on("click",(function(t){var r=prompt("    ");if(r){if(r.length<6)return alert("       6 ");var n={type:"USER_SETTINGS_CHANGE_PASSWORD",data:{password:r}};e.getState().socket.emit("req",wr(n),(function(e){(e=Sr(e)).error||yr("mup",wr(r,!0)),alert(e.message)}))}}))}},{key:"sendAd",value:function(e){$("#chat__body__settings_pane__container__button--send_ad").on("click",(function(t){var r=prompt("  :");if(r){var n={type:"USER_SETTINGS_SEND_AD",data:{message:r}};e.getState().socket.emit("req",wr(n),(function(e){}))}}))}},{key:"lockRoom",value:function(e){$("#chat__body__settings_pane__container__button--lock-room").on("click",(function(t){var r=prompt("   :");if(r){var n={type:"USER_SETTINGS_LOCK_ROOM",data:{password:r}};e.getState().socket.emit("req",wr(n),(function(e){}))}}))}},{key:"manageRoom",value:function(e){$("#chat__body__settings_pane__container__button--manage_room").on("click",(function(t){if(!e.getState().mUser.room)return alert("       ");N.render(e.getState().mUser.room,e)}))}},{key:"youcamLudo",value:function(e){$("#chat__body__settings_pane__container__button--youcam-ludo").on("click",(function(t){e.getState().mUser.isPlaying||oe.render(e)}))}},{key:"openAdmin",value:function(e){$("#chat__body__settings_pane__container__button--open_admin").on("click",(function(t){window.open("/fadmn/home/".concat(e.getState().grantedSettings.adminToken),"_blank").focus()}))}},{key:"onBotBrbClicked",value:function(e){$("#chat__body__settings_pane__container__button--bot-brb").on("click",(function(t){if(!e.getState().mUser.room)return alert("          ");W.render(e);var r={type:"BOT_BRB_OPEN",data:{room_id:e.getState().mUser.room.id}};e.getState().socket.emit("req",wr(r),(function(t){W.setBot(t.bot,e)}))}))}},{key:"closeChat",value:function(e){$("#chat__body__settings_pane__container__button--close-chat").on("click",(function(t){window.confirmOnExit=!1,e.getState().socket.disconnect()}))}},{key:"setLockedMics",value:function(e){if(e.getState().mUser.room&&e.getState().grantedSettings.lock_mics&&e.getState().mUser.room.is_voice_room){$("#lock-mic-speakers").show();for(var t=1;t<=5;t++)e.getState().mUser.room["is_mic_"+t+"_locked"]?$("#lock-mic-"+t).addClass("locked"):$("#lock-mic-"+t).removeClass("locked")}else $("#lock-mic-speakers").hide()}},{key:"render",value:function(e){var t="<div id='chat__body__settings_pane' class='chat_pane' style='background: "+Cr(e.getState().settings,!0)+"'>";return t+=f.render(""),t+="<div class='chat__body__settings_pane__container'>",t+="<div style='margin-bottom: 5px' >",t+="<label class='label label-primary'></label>",t+="<label class='label label-primary pull-right'> </label>",t+="<form>",t+="<input type='text' name='decoration' value='"+e.getState().mUser.name+"' class='form-control' />",t+="<div>",t+="<label class='label label-primary'></label>",t+="<input type='text' name='status' value='"+e.getState().mUser.status+"' class='form-control' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'> </label>",t+="<input type='text' name='statusColor' value='"+e.getState().mUser.statusColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'> </label>",t+="<input type='text' name='fontColor' value='"+e.getState().mUser.fontColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'> </label>",t+="<input type='text' name='nameColor' value='"+e.getState().mUser.nameColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'> </label>",t+="<input type='text' name='nameBgColor' value='"+e.getState().mUser.nameBgColor+"' class='jscolor form-input' />",t+="<button type='button' class='chat__body__settings_pane__container__rm_bg_color btn btn-danger fa fa-times'></button>",t+="</div>",t+="<button name='submit' class='chat__body__settings_pane__container__submit btn btn-success fa fa-save fr'></button>",t+="<div class='clear'></div>",t+="</form>",t+="</div>",t+="<select id='chat__body__settings_pane__container__button--change-font-size' class='form-control label-primary' value='"+e.getState().mUser.fontSize+"' style='height: auto' >",t+="<option value='18'>  10</option>",t+="<option value='20'>  11</option>",t+="<option value='22'>  12</option>",t+="<option value='24'>  13</option>",t+="<option value='26'>  14</option>",t+="<option value='28'>  15</option>",t+="<option value='30'>  16</option>",t+="</select>",e.getState().mUser.room&&e.getState().grantedSettings.lock_mics&&(t+="<div id='lock-mic-speakers'>",t+="<label class='form-control label label-primary'> </label>",t+="<div style='text-align: center;'>",t+="<span id='lock-mic-1' class='lock-mic mic-speakers--item' data-id='1'><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>1</span></span></span>",t+="<span id='lock-mic-2' class='lock-mic mic-speakers--item' data-id='2'><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>2</span></span></span>",t+="<span id='lock-mic-3' class='lock-mic mic-speakers--item' data-id='3'><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>3</span></span></span>",t+="<span id='lock-mic-4' class='lock-mic mic-speakers--item' data-id='4'><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>4</span></span></span>",t+="<span id='lock-mic-5' class='lock-mic mic-speakers--item' data-id='5'><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>5</span></span></span>",t+="</div>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--ignored_users' style='margin-top: 1rem' class='chat__body__settings_pane__container__button form-control warning'>",t+="<span><span class='fa fa-ban'></span> </span>",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--notifications' class='chat__body__settings_pane__container__button form-control info'>",t+="<span><span class='fa fa-bell'></span></span>",t+="</div>",e.getState().grantedSettings.hide_role_icon&&(t+="<div id='chat__body__settings_pane__container__button--toggle-star' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_star toggle_star__hide "+(e.getState().mUser.isRoleIconHidden?"":"toggle_star--active")+"'><span class='fa fa-eye-slash'></span> </span>",t+="<span class='toggle_star toggle_star__show "+(e.getState().mUser.isRoleIconHidden?"toggle_star--active":"")+"'><span class='fa fa-eye'></span> </span>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--change_avatar' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa'>",t+="<img class='avatar' src='"+e.getState().mUser.avatar+"' width='20' height='20' alt='' />",t+="<img class='loader' src='/images/loader.gif' width='20' height='20' alt=''/>",t+="</span> </span>",t+="<input accept='image/*' type='file' id='change_avatar_input' style='position: absolute; top: -1000px' />",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--remove-avatar' class='chat__body__settings_pane__container__button form-control danger'>",t+="<span><span class='fa fa-remove'></span> </span>",t+="</div>",e.getState().mUser.canRemovePublicMessages&&(t+="<div id='chat__body__settings_pane__container__button--clear-public-messages' class='chat__body__settings_pane__container__button form-control warning'>",t+="<span><span class='fa fa-remove'></span>  </span>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--toggle_private' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_private toggle_private__enable "+(e.getState().mUser.isPrivateDisabled?"toggle_private--active":"")+"'><span class='fa fa-check'></span>  </span>",t+="<span class='toggle_private toggle_private__disable "+(e.getState().mUser.isPrivateDisabled?"":"toggle_private--active")+"'><span class='fa fa-times'></span>  </span>",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--toggle_notifications' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_notifications toggle_notifications__enable "+(e.getState().mUser.isNotificationsDisabled?"toggle_notifications--active":"")+"'><span class='fa fa-check'></span> </span>",t+="<span class='toggle_notifications toggle_notifications__disable "+(e.getState().mUser.isNotificationsDisabled?"":"toggle_notifications--active")+"'><span class='fa fa-times'></span> </span>",t+="</div>",e.getState().grantedSettings.change_password&&(t+="<div id='chat__body__settings_pane__container__button-change_password' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-key'></span>  </span>",t+="</div>"),e.getState().grantedSettings.admin_rooms_edit&&(t+="<div data-toggle='modal' data-target='#editRoomModal' id='chat__body__settings_pane__container__button--manage_room' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-home'></span> </span>",t+="</div>"),e.getState().grantedSettings.send_ad&&(t+="<div id='chat__body__settings_pane__container__button--send_ad' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-send'></span>   </span>",t+="</div>"),e.getState().grantedSettings.lock_rooms&&(t+="<div id='chat__body__settings_pane__container__button--lock-room' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-gamepad' style='color: #FFFFFF'></span> </span>",t+="</div>"),e.getState().grantedSettings.bot_brb&&(t+="<div data-toggle='modal' data-target='#manageBotBrbModal' id='chat__body__settings_pane__container__button--bot-brb' class='chat__body__settings_pane__container__button form-control warning'>",t+="<span><span class='fa fa-dashboard'></span> </span>",t+="</div>"),e.getState().grantedSettings.youcam_ludo&&(t+="<div data-toggle='modal' data-target='#preYoucamLudoModal' id='chat__body__settings_pane__container__button--youcam-ludo' class='chat__body__settings_pane__container__button form-control' style='background-color: #980F5A; color: #FFFFFF;'>",t+="<span><span class='fa fa-gamepad' style='color: #FFFFFF'></span> </span>",t+="</div>"),e.getState().grantedSettings.admin&&(t+="<div id='chat__body__settings_pane__container__button--open_admin' class='chat__body__settings_pane__container__button form-control success'>",t+="<span><span class='fa fa-star'></span> </span>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--close-chat' class='chat__body__settings_pane__container__button form-control danger'>",t+="<span><span class='fa fa-sign-out'></span> </span>",t+="</div>",t+="</div>",t+="</div>"}}],(r=null)&&ie(t.prototype,r),o&&ie(t,o),e}(),se=r(51),ce=r.n(se),ue=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_CALL_DIALOG_OPEN",isCallDialogOpen:e}},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"SET_CURRENT_CALL",currentCall:e}},de=r(1),pe=r.n(de);function fe(e){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var me=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onMicButtonClicked(t),e.onMuteClicked(t)}},{key:"getIceServers",value:function(e){return e?[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]:{iceServers:[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]}}},{key:"getJanusServer",value:function(){return"wss://ws1.chat-host.net:8989"}},{key:"init",value:function(t){window.isMicSoundMuted=!1,window.isMicMuted=!1,window.incomingMicStreams={},window.currentMicCallObjct={},window.outgoingMicStream=null,window.janusSession=null,window.janusUserID=e.generateJanusUserID(t.getState().socket.id),window.opaqueId="videoroomtest-"+pe.a.randomString(12),window.reconnectionInterval=null,window.feeds=[],pe.a.init({debug:!1,dependencies:pe.a.useDefaultDependencies(),callback:function(){e.onJanusInitialized(t)},iceServers:e.getIceServers(!0)})}},{key:"onJanusInitialized",value:function(t){window.janusSession=new pe.a({server:e.getJanusServer(),success:function(){e.onJanusSessionSuccess(t,janusSession)},error:function(r){"Lost connection to the server (is it down?)"==r&&e.handleServerConnectionLost(t)},destroyed:function(){e.onJanusSessionDestroyed(t)}})}},{key:"handleServerConnectionLost",value:function(t){if(t.getState().mUser.room){var r=t.getState().mUser.room.micUsers.filter((function(e){return e.user_id==t.getState().mUser.id}))[0];r&&e.leaveMic(t,r.micId,t.getState().mUser),e.destroySession()}window.reconnectionInterval=setInterval((function(){pe.a.init({debug:!1,dependencies:pe.a.useDefaultDependencies(),callback:function(){e.onJanusInitialized(t)},iceServers:e.getIceServers(!0)})}),5e3)}},{key:"getJanusUserID",value:function(e){return e.replace(new URL(socketIOHost).hostname+".","")}},{key:"generateJanusUserID",value:function(e){return new URL(socketIOHost).hostname+"."+e}},{key:"onJanusSessionSuccess",value:function(t,r){window.reconnectionInterval&&(clearInterval(window.reconnectionInterval),window.reconnectionInterval=null),r.attach({plugin:"janus.plugin.videoroom",success:function(r){e.onJanusAttachSuccess(t,r)},error:function(e){},consentDialog:function(e){},onmessage:function(r,n){e.onJanusAttachMessage(r,n,t)},onlocalstream:function(r){e.onJanusAttachLocalStream(t,r)},onremotestream:function(e){},webrtcState:function(e){pe.a.log("WebRTC PeerConnection is "+(e?"up":"down")+" now")},oncleanup:function(){},detached:function(){}})}},{key:"onJanusSessionDestroyed",value:function(t){t.getState().mUser.room&&t.getState().mUser.room.is_voice_room&&e.onJanusInitialized(t)}},{key:"onJanusAttachSuccess",value:function(t,r){console.log("onMicAttachSuccess"),window.pluginHandle=r,e.joinRoom(t)}},{key:"onJanusAttachMessage",value:function(t,r,n){var o=t.videoroom,i=!(!n.getState().mUser.room||!n.getState().mUser.room.is_video_room);if(o){if("joined"===o&&t.id){var a={request:"publish",video:i,data:!1};if(window.pluginHandle.send({message:a}),t.publishers){var s=t.publishers;for(var c in pe.a.debug("Got a list of available publishers/feeds:",s),s){var u=s[c].id,l=s[c].display,d=s[c].audio_codec,p=s[c].video_codec;pe.a.debug("  >> ["+u+"] "+l+" (audio: "+d+", video: "+p+")"),e.newRemoteFeed(n,u,l,d,p)}}e.enableMicButtons()}if("created"===o);else if("destroyed"===o)pe.a.warn("The room has been destroyed!");else if("roomchanged"===o)window.myJanusID=t.id;else if("event"===o)if(t.publishers)for(var c in s=t.publishers)u=s[c].id,l=s[c].display,d=s[c].audio_codec,p=s[c].video_codec,e.newRemoteFeed(n,u,l,d,p);else t.leaving||t.unpublished||t.error&&426===t.error_code&&e.createRoom(n)}r&&window.pluginHandle.handleRemoteJsep({jsep:r})}},{key:"onJanusAttachLocalStream",value:function(t,r){window.outgoingMicStream=r,r.getVideoTracks().length&&e.playStream(t,r,t.getState().mUser.id,!0)}},{key:"onJanusAttachRemoteStream",value:function(e,t){}},{key:"detachFeed",value:function(t,r){window.feeds.filter((function(t){return t.rfdisplay==e.generateJanusUserID(r)}))[0].detach()}},{key:"newRemoteFeed",value:function(t,r,n,o,i){var a=null,s=!(!t.getState().mUser.room||!t.getState().mUser.room.is_video_room);window.janusSession.attach({plugin:"janus.plugin.videoroom",opaqueId:window.opaqueId,success:function(n){(a=n).simulcastStarted=!1,a.audioCodec=o;var i={request:"join",room:e.generateJanusRoomID(t),ptype:"subscriber",feed:r,offer_video:s,offer_data:!1};a.send({message:i})},error:function(e){pe.a.error("  -- Error attaching plugin...",e)},onmessage:function(r,n){var o=r.videoroom;if(r.error);else if(o&&"attached"===o){for(var i=1;i<6;i++)if(!window.feeds[i]){window.feeds[i]=a,a.rfindex=i;break}a.rfid=r.id,a.rfdisplay=r.display}n&&a.createAnswer({jsep:n,media:{audioSend:!1,videoSend:!1},success:function(r){pe.a.debug("Got SDP!",r);var n={request:"start",room:e.generateJanusRoomID(t)};a.send({message:n,jsep:r})},error:function(e){pe.a.error("WebRTC error:",e)}})},iceState:function(e){},webrtcState:function(e){pe.a.log(" WebRTC PeerConnection (feed #"+a.rfindex+") is "+(e?"up":"down")+" now")},onlocalstream:function(r){r.getVideoTracks().length&&e.playStream(t,r,e.getJanusUserID(window.pluginHandle.rfdisplay))},onremotestream:function(r){e.playStream(t,r,e.getJanusUserID(a.rfdisplay))},oncleanup:function(){}})}},{key:"toggle",value:function(t,r){var n=$("#mic-speakers");if(t.getState().mUser.room&&t.getState().mUser.room.is_video_room?($("#chat__body__messages_container__messages, #chat__body__messages_container__videos").show(),$("#chat__body__messages_container .public_message:not(.video-room)").remove(),$("#mic-speakers--item-1, #mic-speakers--item-2").addClass("video"),$("#mic-speakers--item-1, #mic-speakers--item-2").find(".fa:not(.fa-lock)").removeClass("fa-microphone").addClass("fa-camera")):($("#chat__body__messages_container__messages, #chat__body__messages_container__videos").hide(),$("#mic-speakers--item-1, #mic-speakers--item-2").removeClass("video"),$("#mic-speakers--item-1, #mic-speakers--item-2").find(".fa:not(.fa-lock)").removeClass("fa-camera").addClass("fa-microphone")),r)n.show(),window.janusSession&&window.janusSession.isConnected()?e.destroySession():e.onJanusInitialized(t);else{if(n.hide(),t.getState().mUser.room){var o=t.getState().mUser.room.micUsers.filter((function(e){return e.user_id==t.getState().mUser.id}))[0];o&&e.leaveMic(t,o.micId,t.getState().mUser)}e.destroySession()}Tr(),e.addMicVideos(t),e.setLockedMics(t)}},{key:"onMicButtonClicked",value:function(t){$(".mic-speakers--item").on("click",(function(r){if(!$(this).hasClass("disabled")&&t.getState().mUser.room){var n=$(this).data("id"),o=t.getState().mUser.room.micUsers.filter((function(e){return e.micId==n}))[0];if($(this).hasClass("lock-mic"))return o&&e.pullMic(t,n,o.user_id),e.lockMic(t,n);$(this).hasClass("locked")||(o?e.openMicControls(t,n):e.requestMic(t,n))}}))}},{key:"lockMic",value:function(e,t){e.getState().socket.emit("req",wr({type:"MIC_LOCK",data:{micId:t}}),(function(e){"object"==fe(e=Sr(e))&&0==e.error&&(e.locked?$("#lock-mic-"+t).addClass("locked"):$("#lock-mic-"+t).removeClass("locked"))}))}},{key:"setLockedMics",value:function(e){if(e.getState().mUser.room&&e.getState().mUser.room.is_voice_room)for(var t=1;t<=5;t++)e.getState().mUser.room["is_mic_"+t+"_locked"]?$("#mic-speakers--item-"+t).addClass("locked"):$("#mic-speakers--item-"+t).removeClass("locked")}},{key:"setModalButtons",value:function(t,r){$(".mic-speakers--item__modal").html("").hide();var n=!1,o=t.getState().mUser.room.micUsers.filter((function(e){return e.micId==r}))[0];o&&o.user_id==t.getState().mUser.id&&(n=!0);var i=t.getState().users.filter((function(e){return e.id==o.user_id}))[0],a=$(".mic-speakers--item[data-id='"+r+"'] .mic-speakers--item__modal");a.css("background",Cr(t.getState().settings,!1));var s=a.closest(".mic-speakers--item").attr("user-id");n?(a.append("<button id='mic-speakers--item__modal--leave-mic' class='btn btn-primary'> </button>"),$("#mic-speakers--item__modal--leave-mic").unbind("click").on("click",(function(n){e.leaveMic(t,r,s)}))):i&&t.getState().grantedSettings.stop_radio&&t.getState().mUser.power>i.power&&(a.append("<button id='mic-speakers--item__modal--pull-mic' class='btn btn-primary'> </button>"),$("#mic-speakers--item__modal--pull-mic").unbind("click").on("click",(function(n){e.pullMic(t,r,i.id)}))),n?(window.isMicMuted?a.append("<button id='mic-speakers--item__modal--mute-mic' class='btn btn-primary'> </button>"):a.append("<button id='mic-speakers--item__modal--mute-mic' class='btn btn-primary'> </button>"),$("#mic-speakers--item__modal--mute-mic").unbind("click").on("click",(function(n){e.muteMic(t,r,s)}))):(e.isMicMuted(r)?a.append("<button id='mic-speakers--item__modal--mute' class='btn btn-primary'> </button>"):a.append("<button id='mic-speakers--item__modal--mute' class='btn btn-primary'> </button>"),$("#mic-speakers--item__modal--mute").unbind("click").on("click",(function(n){e.muteUser(t,r,!0)}))),a.append("<button id='mic-speakers--item__modal--show-profile' class='btn btn-primary'> </button>"),$("#mic-speakers--item__modal--show-profile").unbind("click").on("click",(function(n){e.showProfile(t,r,s)})),a.show()}},{key:"isMicMuted",value:function(e){var t=!1,r=window.incomingMicStreams[e];return r&&(t=!r.getTracks()[0].enabled),t}},{key:"leaveMic",value:function(t,r,n){t.getState().socket.emit("req",wr({type:"MIC_LEAVE",data:{micId:r}}),(function(e){})),e.closeModals()}},{key:"pullMic",value:function(t,r,n){t.getState().socket.emit("req",wr({type:"MIC_PULL",data:{micId:r,userId:n}}),(function(e){})),e.closeModals()}},{key:"muteMic",value:function(t,r,n){window.isMicMuted=!window.isMicMuted,t.getState().socket.emit("req",wr({type:"MIC_MUTE",data:{micId:r,userId:n,muted:window.isMicMuted}}),(function(e){})),window.isMicMuted?window.pluginHandle.muteAudio():window.pluginHandle.unmuteAudio(),e.setModalButtons(t,r)}},{key:"muteUser",value:function(t,r,n){if(window.incomingMicStreams[r]){var o=!1;window.incomingMicStreams[r].getTracks().forEach((function(e){e.enabled=!e.enabled,o=!e.enabled})),n&&e.setModalButtons(t,r),e.updateMicMutedStyle(o,r)}}},{key:"muteAllUsers",value:function(){for(var t in window.incomingMicStreams)window.incomingMicStreams[t].getTracks().forEach((function(e){return e.enabled=!1}));e.updateMicMutedStyle(!0)}},{key:"unmuteAllUsers",value:function(){for(var t in window.incomingMicStreams)window.incomingMicStreams[t].getTracks().forEach((function(e){return e.enabled=!0}));e.updateMicMutedStyle(!1)}},{key:"updateMicMutedStyle",value:function(e,t){if(t){var r=document.querySelector(".mic-speakers--item[data-id='"+t+"']");r&&(e?r.classList.add("muted"):r.classList.remove("muted"))}else document.querySelectorAll(".mic-speakers--item").forEach((function(t){t&&(e?t.classList.add("muted"):t.classList.remove("muted"))}))}},{key:"showProfile",value:function(e,t,r){xt.show(r,e)}},{key:"closeModals",value:function(){$(".mic-speakers--item__modal").html("").hide()}},{key:"openMicControls",value:function(t,r){$(".mic-speakers--item[data-id='"+r+"'] .mic-speakers--item__modal").show(),e.setModalButtons(t,r)}},{key:"requestMic",value:function(t,r){t.getState().socket.emit("req",wr({type:"MIC_REQUEST",data:{micId:r}}),(function(t){if("string"==typeof t)return alert(t);e.closeModals()}))}},{key:"setUserOnMic",value:function(e,t,r){if(t&&($(".mic-speakers--item[data-id='"+r+"']:not(.lock-mic)").addClass("is_speaking").attr("user-id",t.id),$(".mic-speakers--item[data-id='"+r+"']:not(.lock-mic) .mic-speakers--item__mic-wrapper").hide(),$(".mic-speakers--item[data-id='"+r+"']:not(.lock-mic) img").attr("src",t.avatar).show(),$(".mic-speakers--item[data-id='"+r+"']:not(.lock-mic) .mic-speakers--item__name").html(t.name).show(),window.currentMicCallObjct[r]={callId:t.id},e.getState().mUser.id==t.id)){var n=$(".mic-speakers--item[data-id='"+r+"']:not(.lock-mic)").hasClass("video");window.pluginHandle.createOffer({media:{video:n},success:function(e){var t={request:"configure",audio:!0,video:n,id:r};window.pluginHandle.send({message:t,jsep:e})},error:function(e){pe.a.error("WebRTC error:",e)}})}}},{key:"removeUserFromMic",value:function(t,r,n,o){$(".mic-speakers--item[data-id='"+n+"']").removeClass("is_speaking"),$(".mic-speakers--item[data-id='"+n+"'] img").attr("src",r.avatar).hide(),$(".mic-speakers--item[data-id='"+n+"'] img, .mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__name, .mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__modal").hide(),$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__mic-wrapper").show(),window.isMicSoundMuted||e.updateMicMutedStyle(!1,n),delete window.currentMicCallObjct[n],delete window.incomingMicStreams[n],r.id==t.getState().mUser.id?o&&e.destroySession():!t.getState().mUser.room||!r.room||(t.getState().mUser.room.id,r.room.id)}},{key:"closeCallAndStream",value:function(e){window.pluginHandle.createOffer({media:{video:!1,audio:!1},success:function(e){window.pluginHandle.send({message:{request:"configure",audio:!1,video:!1},jsep:e})},error:function(e){pe.a.error("WebRTC error:",e)}})}},{key:"resetAllMics",value:function(){for(var t in $(".mic-speakers--item").removeClass("is_speaking"),$(".mic-speakers--item img, .mic-speakers--item__name, .mic-speakers--item__modal").hide(),$(".mic-speakers--item .mic-speakers--item__mic-wrapper").show(),e.updateMicMutedStyle(!1,void 0),window.currentMicCallObjct)delete window.currentMicCallObjct[t];for(var t in window.incomingMicStreams)delete window.incomingMicStreams[t];window.incomingMicStreams={},window.currentMicCallObjct={}}},{key:"pushMusicStreamToOutgoingStreams",value:function(){}},{key:"callUser",value:function(e,t,r){}},{key:"gotUserMediaError",value:function(e){}},{key:"callNewUser",value:function(e,t){}},{key:"loopThrowUsersAndCallThem",value:function(e,t){}},{key:"onCallReceived",value:function(e){}},{key:"requestRecall",value:function(e,t){}},{key:"askForPlayingAudio",value:function(e,t){}},{key:"startListening",value:function(e){}},{key:"generateJanusRoomID",value:function(e){if(!e.getState().mUser.room)return-1;var t=new URL(socketIOHost);return parseInt(t.port+""+e.getState().mUser.room.id)+9999}},{key:"destroySession",value:function(){e.disableMicButtons(),window.outgoingMicStream&&window.outgoingMicStream.getTracks().forEach((function(e){return e.stop()})),window.janusSession&&window.janusSession.isConnected()&&(window.janusSession.destroy(),e.destroyAllFeeds())}},{key:"destroyAllFeeds",value:function(){window.feeds.forEach((function(e){}))}},{key:"disableMicButtons",value:function(){$(".mic-speakers--item").addClass("disabled")}},{key:"enableMicButtons",value:function(){$(".mic-speakers--item").removeClass("disabled")}},{key:"createRoom",value:function(t){window.pluginHandle&&window.pluginHandle.send({message:{request:"create",room:e.generateJanusRoomID(t),permanent:!0,bitrate:64e3,publishers:5,description:socketIOHost}})}},{key:"leaveRoom",value:function(t,r){if(t.getState().mUser.room){var n=t.getState().mUser.room.micUsers.filter((function(e){return e.user_id==r.id}))[0];n&&(t.getState().mUser.room.micUsers=t.getState().mUser.room.micUsers.filter((function(e){return e.user_id!=r.id})),e.removeUserFromMic(t,r,n.micId,!1))}window.pluginHandle&&(r.id,t.getState().mUser.id)}},{key:"joinRoom",value:function(t){var r=e.generateJanusRoomID(t);window.pluginHandle&&r>0&&window.pluginHandle.send({message:{request:"join",ptype:"publisher",room:r,display:window.janusUserID}})}},{key:"getMicIDFromUserID",value:function(e,t){var r=e.getState().mUser.room.micUsers.filter((function(e){return e.user_id==t}))[0];return r?r.micId:null}},{key:"playStream",value:function(t,r,n,o){var i=!(!t.getState().mUser.room||!t.getState().mUser.room.is_video_room),a=e.getMicIDFromUserID(t,n);if(a){window.isMicSoundMuted&&r.getTracks().forEach((function(e){return e.enabled=!1})),e.isMicMuted(a)&&r.getTracks().forEach((function(e){return e.enabled=!1})),window.incomingMicStreams[a]=r;var s=!i||1!=a&&2!=a?window["micAudio"+a]:window["micVideo"+a];if("srcObject"in s)try{s.srcObject=r}catch(e){if("TypeError"!=e.name)throw e;s.src=URL.createObjectURL(r)}else s.src=URL.createObjectURL(r);s.onloadedmetadata=function(r){if(s.paused){var n=s.play();n&&n.then((function(){})).catch((function(r){e.askForPlayingAudio(t,a)}))}e.isSafari()&&!o&&(s.muted=!1),s.muted=!1}}}},{key:"playVisualizer",value:function(e,t){var r=window.AudioContext||window.webkitAudioContext||!1;if(r){var n,o=document.getElementById("mic-speakers--item-"+t),i=new r,a=i.createAnalyser();i.createMediaStreamSource(e).connect(a),a.connect(i.destination),n=new Uint8Array(a.frequencyBinCount),requestAnimationFrame((function e(){a.getByteFrequencyData(n),n[2]&&n[2]>=20?o.classList.add("ripple"):o.classList.remove("ripple"),requestAnimationFrame(e)}))}else console.log("AudioContext not supported")}},{key:"addMicVideos",value:function(e){$("#mic-video-1").length||($("#chat__body__messages_container__videos").append('<video class="mic-video" autoplay playinline  id="mic-video-1"></video>'),window.micVideo1=document.querySelector("#mic-video-1"),window.micVideo1.muted=!0),$("#mic-video-2").length||($("#chat__body__messages_container__videos").append('<video class="mic-video" autoplay playinline id="mic-video-2"></video>'),window.micVideo2=document.querySelector("#mic-video-2"),window.micVideo2.muted=!0)}},{key:"addMidAudios",value:function(){$("#mic-audio-1").length||($("body").append('<audio id="mic-audio-1"></audio>'),window.micAudio1=document.querySelector("#mic-audio-1"),window.micAudio1.muted=!0),$("#mic-audio-2").length||($("body").append('<audio id="mic-audio-2"></audio>'),window.micAudio2=document.querySelector("#mic-audio-2"),window.micAudio2.muted=!0),$("#mic-audio-3").length||($("body").append('<audio id="mic-audio-3"></audio>'),window.micAudio3=document.querySelector("#mic-audio-3"),window.micAudio3.muted=!0),$("#mic-audio-4").length||($("body").append('<audio id="mic-audio-4"></audio>'),window.micAudio4=document.querySelector("#mic-audio-4"),window.micAudio4.muted=!0),$("#mic-audio-5").length||($("body").append('<audio id="mic-audio-5"></audio>'),window.micAudio5=document.querySelector("#mic-audio-5"),window.micAudio5.muted=!0)}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"onMuteClicked",value:function(t){$("#mic-speakers--mute").on("click",(function(t){var r=$("#mic-speakers--mute");window.isMicSoundMuted?(e.unmuteAllUsers(),window.isMicSoundMuted=!1,r.removeClass("muted")):(window.isMicSoundMuted=!0,e.muteAllUsers(),r.addClass("muted"))}))}},{key:"getRndInteger",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"setPublicBanner",value:function(e){var t=e.getState().settings.public_banner_1_img,r=e.getState().settings.public_banner_2_img;t?$("#mic-speakers--public-banner-1").attr("src","/uploads/"+t).show():$("#mic-speakers--public-banner-1").hide(),r?$("#mic-speakers--public-banner-2").attr("src","/uploads/"+r).show():$("#mic-speakers--public-banner-2").hide()}},{key:"setBackgroundColor",value:function(e){$("#mic-speakers").css("background-color",e.getState().settings.mic_bg_color)}},{key:"render",value:function(e){var t="<div id='mic-speakers' style='background-color: "+e.getState().settings.mic_bg_color+"'>";return e.getState().mUser.room&&e.getState().mUser.room.is_video_room?(t+="<span id='mic-speakers--item-1' class='video mic-speakers--item disabled' data-id='1'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-camera'></span><span class='fa fa-lock'></span><span class='number'>1</span></span></span>",t+="<span id='mic-speakers--item-2' class='video mic-speakers--item disabled' data-id='2'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-camera'></span><span class='fa fa-lock'></span><span class='number'>2</span></span></span>"):(t+="<span id='mic-speakers--item-1' class='mic-speakers--item disabled' data-id='1'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>1</span></span></span>",t+="<span id='mic-speakers--item-2' class='mic-speakers--item disabled' data-id='2'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>2</span></span></span>"),t+="<span id='mic-speakers--item-3' class='mic-speakers--item disabled' data-id='3'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>3</span></span></span>",t+="<span id='mic-speakers--item-4' class='mic-speakers--item disabled' data-id='4'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>4</span></span></span>",t+="<span id='mic-speakers--item-5' class='mic-speakers--item disabled' data-id='5'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='fa fa-lock'></span><span class='number'>5</span></span></span>",t+="<span id='mic-speakers--public-banners'>",t+="<img class='mic-speakers--public-banner' id='mic-speakers--public-banner-1' />",t+="<img class='mic-speakers--public-banner' id='mic-speakers--public-banner-2' />",t+="</span>",t+="<span id='mic-speakers--mute'></span>",t+="</div>"}}],(r=null)&&he(t.prototype,r),n&&he(t,n),e}(),_e=r(52),ge=r.n(_e);function ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ye=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onHide(t),e.onCancel(t),e.onAccept(t)}},{key:"getAudioConstraints",value:function(){return{autoGainControl:!1,channelCount:1,echoCancellation:!0,latency:0,noiseSuppression:!0,sampleRate:8e3,sampleSize:8,volume:1}}},{key:"onCallReceived",value:function(){window.callsPeer.on("call",(function(t){window.incomingCall=t,navigator.getUserMedia?navigator.getUserMedia({audio:e.getAudioConstraints()},(function(e){t.answer(e),window.outgoinCallStream=e}),e.gotUserMediaError):navigator.mediaDevices.getUserMedia({audio:e.getAudioConstraints()}).then((function(e){t.answer(e),window.outgoinCallStream=e})).catch(e.gotUserMediaError),t.on("stream",(function(t){window.incomingCallStream=t,e.playStream(t)})),t.on("error",(function(e){console.log("CallDialog.onCallReceived.call.on.error",e.type,e.message)}))}))}},{key:"startPeerCall",value:function(t){navigator.getUserMedia?navigator.getUserMedia({audio:e.getAudioConstraints()},(function(r){var n=window.callsPeer.call(t+"call",r);n&&(n.on("error",(function(e){console.log("callUser.outgoing.on.error",e.type,e.message)})),n.on("stream",(function(t){window.incomingCallStream=t,e.playStream(t)})),window.outgoinCall=n,window.outgoinCallStream=r,window.isCalling=!0)}),e.gotUserMediaError):navigator.mediaDevices.getUserMedia({audio:e.getAudioConstraints()}).then((function(r){var n=window.callsPeer.call(t,r);n&&(n.on("error",(function(e){console.log("callUser.outgoing.on.error",e.type,e.message)})),n.on("stream",(function(t){window.incomingCallStream=t,e.playStream(t)})),window.outgoinCall=n,window.outgoinCallStream=r,window.isCalling=!0)})).catch(e.gotUserMediaError)}},{key:"callUser",value:function(t){return navigator.mediaDevices?$("#call_container").html()?$("#call-dialog").show():void t.getState().socket.emit("req",wr({type:"CALL_REQUEST",data:{id:t.getState().currentConversation.id}}),(function(r){if("rigning"==r.message){t.dispatch(ue(!0));var n={user:r.user,dialogType:"call-sent",statusClass:"warning",status:"  ..."};for(var o in t.dispatch(le(n)),e.render(t,n,!0),currentMicCallObjct)currentMicCallObjct[o]&&currentMicCallObjct[o].callId==t.getState().mUser.id&&me.leaveMic(t,o,t.getState().mUser.id)}else"not ready"==r.message?t.dispatch(ue(!0)):alert(r.message)})):alert("       ")}},{key:"close",value:function(){$("#call_container").html(""),window.callsAudio.src=null,window.callsAudio.srcObject=null,window.isCalling=!1,window.callsPeer&&window.callsPeer.destroy(),window.outgoinCall&&window.outgoinCall.close(),window.outgoinCallStream&&window.outgoinCallStream.getTracks().forEach((function(e){return e.stop()})),window.incomingCall&&window.incomingCall.close(),window.incomingCallStream&&window.incomingCallStream.getTracks().forEach((function(e){return e.stop()}))}},{key:"onHide",value:function(e){$("#call-dialog-footer__hide").unbind("click").on("click",(function(t){e.dispatch(ue(!1)),$("#call-dialog").hide()}))}},{key:"onAccept",value:function(t){$("#call-dialog-footer__accept").unbind("click").on("click",(function(r){t.getState().socket.emit("req",wr({type:"CALL_REQUEST_ACCEPT",data:{id:t.getState().currentCall.user.id}}),(function(r){for(var n in e.startPeerCall(r),currentMicCallObjct)currentMicCallObjct[n]&&currentMicCallObjct[n].callId==t.getState().mUser.id&&me.leaveMic(t,n,t.getState().mUser.id);$("#call-dialog-footer__accept, #call-dialog__status").hide(),$("#call-dialog__status_start_call").show()}))}))}},{key:"onCallAccepted",value:function(){$("#call-dialog__status").hide(),$("#call-dialog__status_start_call").show()}},{key:"onCancel",value:function(t){$("#call-dialog-footer__cancel").unbind("click").on("click",(function(r){t.getState().socket.emit("req",wr({type:"CALL_REQUEST_CANCEL",data:{id:t.getState().currentCall.user.id}}),(function(r){e.close(),t.dispatch(ue(!1))}))}))}},{key:"gotUserMediaError",value:function(e){console.log("gotUserMediaError",e)}},{key:"playStream",value:function(t){try{window.callsAudio.srcObject=t}catch(e){window.callsAudio.src=window.URL.createObjectURL(t)}window.callsAudio.onloadedmetadata=function(t){window.callsAudio.paused&&window.callsAudio.play(),e.isSafari()&&(window.callsAudio.muted=!1)}}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"getIceServers",value:function(){return{iceServers:[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]}}},{key:"initPeer",value:function(t){window.outgoinCall=null,window.outgoinCallStream=null,window.incomingCall=null,window.incomingCallStream=null,window.callsPeer=new ge.a(t.getState().socket.id+"call",{host:"peerjs-server.herokuapp.com",port:443,secure:!0,config:e.getIceServers(),debug:1}),window.callsPeer.on("error",(function(e){console.log("initPeer.on.error",e.type,e.message)})),e.onCallReceived(t)}},{key:"render",value:function(t,r,n){var o="<div id='call-dialog' style='display: "+(t.getState().isCallDialogOpen?"block":"none")+"'>";o+="<p class='target-user-name'>"+r.user.username+"</p>",o+="<img class='target-user-avatar' src='"+r.user.avatar+"' alt='' />",o+="<p id='call-dialog__status_start_call' class='call-status success'> </p>",o+="<p id='call-dialog__status' class='call-status "+r.statusClass+"'>"+r.status+"</p>",o+="<p class='call-dialog-footer'>",o+="<button id='call-dialog-footer__cancel' class='btn btn-danger call-cancel'><i class='fa fa-phone'></i></button>","call-received"==r.dialogType&&(o+="<button id='call-dialog-footer__accept' class='btn btn-success call-accept'><i class='fa fa-phone'></i></button>"),o+="<button id='call-dialog-footer__hide' class='btn btn-warning pull-right call-dialog-hide'><i class='fa fa-minus'></i></button>",o+="</p>",o+="</div>",$("#call_container").append(o),e.registerEvents(t),e.initPeer(t)}}],(r=null)&&ve(t.prototype,r),n&&ve(t,n),e}();function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Se=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.close(t),e.mute(t),e.onCall(t),e.expand(),e.compress(),e.onSubmit(t),e.sendMedia(t),e.stopRecording(t),e.startRecording(t),e.openFacePicker(t),e.onChatBoxClicked(t),e.triggerSendMediaInput(t)}},{key:"onCall",value:function(e){$("#chat_box__footer__call").unbind("click").on("click",(function(t){ye.callUser(e)}))}},{key:"updateUser",value:function(e,t){if(t.getState().currentConversation&&e==t.getState().currentConversation.id){var r=t.getState().users.filter((function(t){return t.id==e}))[0];if(r){var n=$("#chat_box");n&&(n.find(".chat_box__header__avatar").attr("src",r.avatar),n.find(".chat_box__header__name").html(S.render(r)))}}}},{key:"openFacePicker",value:function(e){$("#chat_box #chat_box__footer__smile").unbind("click").on("click",(function(t){e.dispatch(x(!0)),y.registerEvents(e)}))}},{key:"onSubmit",value:function(t){$("#chat_box form").unbind("submit").on("submit",(function(r){r.preventDefault();var n=t.getState().currentConversation.id,o=r.target.message,i=o.value.trim();i&&(e.sendMessage({message:i,id:n,type:"text"},o,t),o&&(o.value=""))}))}},{key:"sendMessage",value:function(t,r,n){var o=t.message,i=t.id,a=t.type;!r||"text"!=a&&"youtube"!=a||r.focus(),n||(n=window.store),i||(i=n.getState().currentConversation.id),n.getState().socket.emit("req",wr({type:"NEW_PRIVATE_MESSAGE",data:{id:i,message:o,type:a}}),(function(t){if("string"==typeof(t=Sr(t)))return K.render({id:Date.now(),user:n.getState().users.filter((function(e){return e.id==i}))[0],type:null,message:t,title:""},n);if("object"==be(t)){var r=i,o=n.getState().mUser,a=n.getState().currentConversation,s=t,c=n.getState().currentConversation.id==r;n.dispatch(P(r,o,a,c,s)),e.insert(s,o,n)}}))}},{key:"triggerSendMediaInput",value:function(){$("#chat_box__footer__share").unbind("click").on("click",(function(e){if(!$(this).closest("form").hasClass("loading")){var t=document.getElementById("chat_box__footer_attach");t&&t.click()}}))}},{key:"sendMedia",value:function(t){$("#chat_box__footer_attach").unbind("change").on("change",(function(r){var n=this,o=new FormData;o.append("file",r.target.files[0]),t.getState().socket.emit("req",wr({type:"BEFORE_SEND_MEDIA",data:{id:t.getState().currentConversation.id}}),(function(r){if("string"==typeof(r=Sr(r)))return alert(r);if(!0!==r)return K.render({id:Date.now(),user:t.getState().users.filter((function(e){return e.id==t.getState().currentConversation.id}))[0],type:null,message:"   ",title:""},t);$(n).closest("form").addClass("loading");var i=$("#chat_box__footer__loading_percent");G.a.post("/send_private_media",o,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);i.text(t<10?"0"+t:t)}}).then((function(r){!1===r.data.error&&e.sendMessage({message:r.data.file,id:t.getState().currentConversation.id,type:r.data.type},void 0,t),$(n).closest("form").removeClass("loading"),i.text("00")})).catch((function(e){$(n).closest("form").removeClass("loading"),i.text("00")}))}))}))}},{key:"insert",value:function(t,r,n){$("#chat_box_container #chat_box__body").append(O.render(t,r,n)),e.scrollToBottom(),O.registerEvents(n)}},{key:"onChatBoxClicked",value:function(e){$("#chat_box").unbind("click").on("click",(function(t){e.dispatch(n(null)),pr.togglePane(e,!0)}))}},{key:"close",value:function(e){$("#chat_box__header__close").unbind("click").on("click",(function(t){$("#chat_box_container").html(""),e.dispatch(E(null))}))}},{key:"expand",value:function(){$("#chat_box__header__expand").unbind("click").on("click",(function(e){$("#chat_box").addClass("expanded")}))}},{key:"compress",value:function(){$("#chat_box__header__compress").unbind("click").on("click",(function(e){$("#chat_box").removeClass("expanded")}))}},{key:"mute",value:function(e){$("#chat_box__header__mute, #chat_box__header__unmute").unbind("click").on("click",(function(t){e.getState().socket.emit("req",wr({type:"TOGGLE_PRIVATE_BIP",data:{}}),(function(t){t=Sr(t),ae.updateUserAttribute("isPrivateBipEnabled",t,e),e.getState().mUser.reg_id||yr("isPrivateBipEnabled",wr(t,!0)),t?$("#chat_box").removeClass("muted"):$("#chat_box").addClass("muted")}))}))}},{key:"playNotification",value:function(e){if(e.getState().mUser.isPrivateBipEnabled){var t=document.getElementById("private-bip");t&&t.play()}}},{key:"renderMessages",value:function(e){var t=e.getState().currentConversation,r=e.getState().conversations.filter((function(e){return e.id==t.id}))[0],n="";return r&&r.messages.forEach((function(t){var o=r.me.id==t.by?r.me:r.him;n+=O.render(t,o,e)})),n}},{key:"scrollToBottom",value:function(){var e=document.getElementById("chat_box__body");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"startRecording",value:function(t){$("#chat_box__footer__start_recording").unbind("click").on("click",(function(r){$("#chat_box__footer__start_recording").hide(),$("#chat_box__footer__stop_recording").show(),window.isRecordingSound||(window.isRecordingSound=!0,window.store=t,navigator.mediaDevices.getUserMedia({audio:!0}).then(e.onMediaStreamSuccess).catch(e.onMediaStreamError))}))}},{key:"stopRecording",value:function(e){$("#chat_box__footer__stop_recording").unbind("click").on("click",(function(e){$("#chat_box__footer__stop_recording").hide(),$("#chat_box__footer__start_recording").show(),window.isRecordingSound=!1,null!=window.mediaRecorder&&(window.mediaRecorder.stop(),null!=window.mediaRecorder.stream&&window.mediaRecorder.stream.stop())}))}},{key:"uploadblob",value:function(e,t){if(e){var r=new FormData;r.append("file",e),r.append("_token",$("meta[name='csrf-token']").attr("content")),$.ajax({url:"/private_upload_blob",type:"POST",data:r,cache:!1,processData:!1,contentType:!1,success:function(e){(e=JSON.parse(e))&&!e.error&&e.src?t(e.src):alert("    ")},error:function(e){alert("    ")}})}}},{key:"onMediaStreamSuccess",value:function(t){try{window.mediaRecorder=new ce.a(t);var r=null;window.mediaRecorder.bufferSize=8192,window.mediaRecorder.stream=t,window.mediaRecorder.mimeType="audio/webm",window.mediaRecorder.dur=Date.now(),window.mediaRecorder.ondataavailable=function(t){if(!((Date.now()-window.mediaRecorder.dur)/1e3<1)){var n=$('<div class="audio-recorder"><audio type="audio/webm" controls></audio><button class="btn btn-success"></button>&nbsp;<button class="btn btn-danger"></button></div>');n.find("audio").attr("src",window.URL.createObjectURL(t)),e.uploadblob(t,(function(e){n.find("audio").attr("src","/uploads/private/"+e),r=e})),n.find(".btn-success").click((function(){r&&e.sendMessage({message:r,id:null,type:"sound"}),n.remove()})),n.find(".btn-danger").click((function(){n.remove(),e.removeBlob(r)})),$("#chat_box__body").append(n)}},window.mediaRecorder.start(3e4)}catch(e){console.log("onMediaStreamSuccess.error",e)}}},{key:"onMediaStreamError",value:function(e){window.isRecordingSound=!1,window.store=void 0,alert("     ,    ")}},{key:"removeBlob",value:function(e){window.store=void 0;var t=new FormData;t.append("file",e),t.append("_token",$("meta[name='csrf-token']").attr("content")),$.ajax({url:"/private_remove_blob",type:"POST",data:t,cache:!1,processData:!1,contentType:!1,success:function(e){},error:function(e){}})}},{key:"render",value:function(t){var r=t.getState().currentConversation;if(!r)return $("#chat_box_container").html("");var n="<div id='chat_box' class='"+(t.getState().mUser.isPrivateBipEnabled?"":"muted")+"'>";n+="<header class='chat_box__header label-primary'>",n+="<img class='chat_box__header__avatar' width='25' height='25' src='"+r.avatar+"' alt='' />",n+="<p class='chat_box__header__name ellipsis'>"+S.render(r)+"</p>",n+="<button id='chat_box__header__close' class='btn btn-danger fa fa-minus pull-right'></button>",n+="<button id='chat_box__header__expand' class='btn btn-info fa fa-expand pull-right'></button>",n+="<button id='chat_box__header__compress'class='btn btn-info fa fa-compress pull-right'></button>",n+="<button id='chat_box__header__mute' class='btn btn-success fa fa-bell-o pull-right'></button>",n+="<button id='chat_box__header__unmute' class='btn btn-success fa fa-bell-slash-o pull-right'></button>",n+="</header><div class='clear'></div>",n+="<div class='chat_box__body' id='chat_box__body' style='background: "+Cr(t.getState().settings)+"'>",n+=e.renderMessages(t),n+="</div>",n+="<footer class='chat_box__footer'>",n+=y.render("private_messages","#chat_box__footer__input",t),n+="<form>",n+="<button id='chat_box__footer__start_recording' type='button' class='btn btn-primary fa fa-microphone'></button>",n+="<button id='chat_box__footer__stop_recording' type='button' class='btn btn-primary fa fa-stop'></button>",n+="<button id='chat_box__footer__share' type='button' class='btn btn-primary fa fa-share-alt'></button>",n+="<span style='position: relative'><span id='chat_box__footer__loading_percent'>00</span><img id='chat_box__footer__loader' src='/images/loader.gif' width='30' height='30' alt=''/></span>",n+="<button type='button' id='chat_box__footer__call' class='btn btn-primary fa fa-phone'></button>",n+="<img style='cursor: pointer' src='/images/smile.gif' alt='' id='chat_box__footer__smile' class='chat_box__footer__smile' width='22' height='22' />",n+="<input class='chat_box__footer__input' id='chat_box__footer__input' dir='rtl' name='message' type='text' placeholder='  ...' autoComplete='off' />",n+="<button id='chat_box__footer__submit' class='btn btn-primary fa fa-send'></button>",n+="<input id='chat_box__footer_attach' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",n+="</form>",n+="</footer>",n+="</div>",$("#chat_box_container").html(n),t.dispatch({type:"READ_CONVERSATION",id:r.id}),e.registerEvents(t),e.scrollToBottom(),pr.updateConversationsCount(t),O.registerEvents(t)}}],(r=null)&&we(t.prototype,r),o&&we(t,o),e}();function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--private").unbind("click").click("click",(function(t){e.dispatch(E(e.getState().requestedUser)),e.dispatch(e.dispatch(n(null))),pr.togglePane(e,!0),$("#user_profile").modal("hide"),Se.render(e)}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--private' class='btn btn-default fa fa-comment'> </button></span>"}}],(r=null)&&ke(t.prototype,r),o&&ke(t,o),e}();function Ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Te=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--notify").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id,n=prompt("   ");(n=n?n.trim():null)&&(n=n.substring(0,100),e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_NOTIFY",data:{id:r,message:n}}),(function(e){alert(Sr(e))})))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--notify' class='btn btn-default fa fa-envelope-o'></button></span>"}}],(r=null)&&Ee(t.prototype,r),n&&Ee(t,n),e}();function Pe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ae=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--like").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_LIKE",data:{id:r}}),(function(t){!0===(t=Sr(t))&&($("#user_profile__footer__actions__item--like").parent().addClass("active"),$("#user_profile__footer__actions__item--like").find("span").text(e.getState().requestedUser.likes+1))}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item "+(e.getState().requestedUser.liked?"active":"")+"'>";return t+="<button id='user_profile__footer__actions__item--like' class='btn btn-default fa fa-heart red'><span>"+e.getState().requestedUser.likes+"</span></button>",t+="</span>"}}],(r=null)&&Pe(t.prototype,r),n&&Pe(t,n),e}();function Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Oe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--album").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_GET_ALBUM",data:{id:r}}),(function(t){if("string"==typeof(t=Sr(t)))return alert(t);e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"SET_ALBUM",album:e}}(t))}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item'>";return t+="<button id='user_profile__footer__actions__item--album' class='btn btn-default fa fa-image purple'><span dir='rtl'> ("+e.getState().requestedUser.albumLength+") </span><span></span></button>",t+="</span>"}}],(r=null)&&Re(t.prototype,r),n&&Re(t,n),e}();function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Me=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(){e.onAction()}},{key:"onAction",value:function(){$("#user_profile__footer__actions__item--gift").unbind("click").click("click",(function(e){$("#user_profile .gifts_picker").show(),$("#user_profile .user_profile__body__avatar").hide()}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--gift' class='btn btn-default fa fa-diamond blue'> </button></span>"}}],(r=null)&&xe(t.prototype,r),n&&xe(t,n),e}(),De=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_REVEAL_NAMES",isRevealNamesOpen:e}};function Ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ue=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.back(t)}},{key:"back",value:function(t){$("#reveal_names__header__back").unbind("click").on("click",(function(r){t.dispatch(De(!1)),e.close()}))}},{key:"renderName",value:function(e){if(!e)return"";var t="<div class='reveal_names__item'>";return t+="<p><span class='reveal_names__item__key'></span><span className='reveal_names__item__value'>"+e.username+"</span></p>",t+="<p><span class='reveal_names__item__key'></span><span className='reveal_names__item__value'>"+e.decoration+"</span></p>",t+="<p><span class='reveal_names__item__key'></span><span className='reveal_names__item__value'><img src='images/flags/"+e.country+".png' /></span></p>",t+="<p><span class='reveal_names__item__key'></span><span className='reveal_names__item__value'>"+e.ip+"</span></p>",t+="<p><span class='reveal_names__item__key'></span><span className='reveal_names__item__value'>"+e.device+"</span></p>",t+="</div>"}},{key:"renderNames",value:function(t){var r=$("#user_profile .reveal_names_body");r.html(""),t.getState().revealNames.forEach((function(t){r.append(e.renderName(t))}))}},{key:"open",value:function(t){$("#reveal_names__container").show(),$("#user_profile__body__user_details").hide(),$("#user_profile .user_profile__footer").hide(),e.renderNames(t),e.back(t)}},{key:"close",value:function(){$("#reveal_names__container").hide(),$("#user_profile__body__user_details").show(),$("#user_profile .user_profile__footer").show()}},{key:"render",value:function(t){var r="<div id='reveal_names__container' class='reveal_names' style='display: none;'>";return r+="<p class='reveal_names__header'>",r+="<button id='reveal_names__header__back' class='btn btn-success fa fa-arrow-left'></button>",r+="<span class='fr'> </span>",r+="</p>",r+="<div class='reveal_names_body'>"+e.renderNames(t)+"</div>",r+="</div>"}}],(r=null)&&Ie(t.prototype,r),n&&Ie(t,n),e}();function Be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--reveal-names").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_REVEAL_NAMES",data:{id:r}}),(function(t){if("string"==typeof(t=Sr(t)))return alert(t);Array.isArray(t)&&(e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_REVEAL_NAMES",names:e}}(t)),e.dispatch(De(!0)),Ue.open(e))}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--reveal-names' class='btn btn-default fa fa-search'> </button></span>"}}],(r=null)&&Be(t.prototype,r),n&&Be(t,n),e}();function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Fe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--remove-avatar").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_REMOVE_AVATAR",data:{id:r}}),(function(t){"string"==typeof(t=Sr(t))?alert(t):(e.dispatch(U(t)),xt.clearAvatar(e))}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--remove-avatar' class='btn btn-default fa fa-ban maroon'> </button></span>"}}],(r=null)&&je(t.prototype,r),n&&je(t,n),e}();function $e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--room-excpel").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_ROOM_EXCPEL",data:{id:r}}),(function(e){"string"==typeof(e=Sr(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--room-excpel' class='btn btn-default fa fa-sign-out magenta'>  </button></span>"}}],(r=null)&&$e(t.prototype,r),n&&$e(t,n),e}();function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ge=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--excpel").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_EXCPEL",data:{id:r}}),(function(e){"string"==typeof(e=Sr(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--excpel' class='btn btn-default fa fa-ban'></button></span>"}}],(r=null)&&qe(t.prototype,r),n&&qe(t,n),e}();function Ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var We=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--ban").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_BAN",data:{id:r}}),(function(e){"string"==typeof(e=Sr(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--ban' class='btn btn-default fa fa-ban'></button></span>"}}],(r=null)&&Ve(t.prototype,r),n&&Ve(t,n),e}();function He(e,t){"touchstart"===e.type?(window["camera-"+t+"-InitialX"]=e.touches[0].clientX-window["camera-"+t+"-XOffset"],window["camera-"+t+"-InitialY"]=e.touches[0].clientY-window["camera-"+t+"-YOffset"]):(window["camera-"+t+"-InitialX"]=e.clientX-window["camera-"+t+"-XOffset"],window["camera-"+t+"-InitialY"]=e.clientY-window["camera-"+t+"-YOffset"]);var r=document.querySelector("#camera__box-"+t+" .camera_box__header"),n=document.querySelector("#camera__box-"+t+" .camera_box__title"),o=document.querySelector("#camera__box-"+t+" .camera_box__body");e.target!==r&&e.target!==n&&e.target!==o||(window["camera-"+t+"-DragActive"]=!0)}function ze(e,t){window["camera-"+t+"-InitialX"]=window["camera-"+t+"-CurrentX"],window["camera-"+t+"-InitialY"]=window["camera-"+t+"-CurrentY"],window["camera-"+t+"-DragActive"]=!1}function Je(e,t){var r,n;window["camera-"+t+"-DragActive"]&&(e.preventDefault(),"touchmove"===e.type?(window["camera-"+t+"-CurrentX"]=e.touches[0].clientX-window["camera-"+t+"-InitialX"],window["camera-"+t+"-CurrentY"]=e.touches[0].clientY-window["camera-"+t+"-InitialY"]):(window["camera-"+t+"-CurrentX"]=e.clientX-window["camera-"+t+"-InitialX"],window["camera-"+t+"-CurrentY"]=e.clientY-window["camera-"+t+"-InitialY"]),window["camera-"+t+"-XOffset"]=window["camera-"+t+"-CurrentX"],window["camera-"+t+"-YOffset"]=window["camera-"+t+"-CurrentY"],r=window["camera-"+t+"-CurrentX"],n=window["camera-"+t+"-CurrentY"],document.querySelector("#camera__box-"+t).style.transform="translate3d("+r+"px, "+n+"px, 0)")}function Ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Xe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"register",value:function(e){var t=document.querySelector("#chat");window["camera-"+e+"-DragActive"]=!1,window["camera-"+e+"-XOffset"]=window["camera-"+e+"-XOffset"]?window["camera-"+e+"-XOffset"]:0,window["camera-"+e+"-YOffset"]=window["camera-"+e+"-YOffset"]?window["camera-"+e+"-YOffset"]:0,t.addEventListener("touchstart",(function(t){He(t,e)}),!1),t.addEventListener("touchend",(function(t){ze(0,e)}),!1),t.addEventListener("touchmove",(function(t){Je(t,e)}),!1),t.addEventListener("mousedown",(function(t){He(t,e)}),!1),t.addEventListener("mouseup",(function(t){ze(0,e)}),!1),t.addEventListener("mousemove",(function(t){Je(t,e)}),!1)}},{key:"unregister",value:function(e){var t=document.querySelector("#chat");t.removeEventListener("touchstart",(function(t){He(t,e)}),!1),t.removeEventListener("touchend",(function(t){ze(0,e)}),!1),t.removeEventListener("touchmove",(function(t){Je(t,e)}),!1),t.removeEventListener("mousedown",He,!1),t.removeEventListener("mouseup",(function(t){ze(0,e)}),!1),t.removeEventListener("mousemove",(function(t){Je(t,e)}),!1)}}],(r=null)&&Ye(t.prototype,r),n&&Ye(t,n),e}();function Ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Qe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onClose(t)}},{key:"onClose",value:function(t){$(".camera_box__close").unbind().on("click",(function(r){var n=$(this).closest(".camera_box");e.close(t,n),t.getState().socket.emit("req",wr({type:"CAMERA_BOX_CLOSED",data:{user:n.data("id")}}),(function(e){}))}))}},{key:"close",value:function(t,r){Xe.unregister(r.data("id")),r.remove(),r.data("id")==t.getState().mUser.id&&t.getState().socket.emit("req",wr({type:"CAMERA_CLOSE",data:{}}),(function(r){if("string"==typeof(r=Sr(r)))return alert(r);$("#chat__footer__menu__cam_item").removeClass("active"),e.destroySession(t,!0)}))}},{key:"closeAllCameraBoxes",value:function(t){$(".camera_box").each((function(r,n){Xe.unregister(n.dataset.id),n.remove(),e.destroySession(t,!1),t.getState().socket.emit("req",wr({type:"CAMERA_BOX_CLOSED",data:{user:n.dataset.id}}),(function(e){}))}))}},{key:"getIceServers",value:function(e){return e?[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]:{iceServers:[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]}}},{key:"getJanusServer",value:function(){return"wss://ws1.chat-host.net:8989"}},{key:"init",value:function(t,r,n){window.incomingCameraStreams={},window.outgoingCameraStream=null,window.janusCameraSession=null,window.cameraPluginHandle=null,window.janusCameraUserID=e.generateJanusUserID(t.getState().socket.id),window.cameraOpaqueId="videoroomtest-"+pe.a.randomString(15),window.cameraReconnectionInterval=null,window.CameraFeeds=[],pe.a.init({debug:!1,dependencies:pe.a.useDefaultDependencies(),callback:function(){e.onJanusInitialized(t,r,n)},iceServers:e.getIceServers(!0)})}},{key:"destroy",value:function(e){}},{key:"onJanusInitialized",value:function(t,r,n){window.janusCameraSession=new pe.a({server:e.getJanusServer(),success:function(){e.onJanusSessionSuccess(t,janusCameraSession,r,n)},error:function(r){"Lost connection to the server (is it down?)"==r&&e.handleServerConnectionLost(t)},destroyed:function(){e.onJanusSessionDestroyed(t)}})}},{key:"handleServerConnectionLost",value:function(t){t.getState().mUser.room&&$("#camera__box-"+t.getState().mUser.id).length&&(e.close(t,$("#camera__box-"+t.getState().mUser.id)),e.destroySession(t,!0)),window.cameraReconnectionInterval=setInterval((function(){pe.a.init({debug:!1,dependencies:pe.a.useDefaultDependencies(),callback:function(){e.onJanusInitialized(t)},iceServers:e.getIceServers(!0)})}),5e3)}},{key:"onJanusSessionSuccess",value:function(t,r,n,o){window.cameraReconnectionInterval&&(clearInterval(window.cameraReconnectionInterval),window.cameraReconnectionInterval=null),r.attach({plugin:"janus.plugin.videoroom",success:function(r){e.onJanusAttachSuccess(t,r,n,o)},error:function(e){},consentDialog:function(e){},onmessage:function(r,n){e.onJanusAttachMessage(r,n,t)},onlocalstream:function(r){e.onJanusAttachLocalStream(t,r)},onremotestream:function(e){},webrtcState:function(e){pe.a.log("WebRTC PeerConnection is "+(e?"up":"down")+" now")},oncleanup:function(){},detached:function(){}})}},{key:"onJanusAttachSuccess",value:function(t,r,n,o){window.cameraPluginHandle=r,n?e.createRoom(t):e.joinRoom(o)}},{key:"onJanusAttachMessage",value:function(t,r,n){var o=t.videoroom;if(o){if("joined"===o&&t.id&&(e.isRoomOwner(n,t.room)&&window.cameraPluginHandle.createOffer({media:{audio:!1,video:!0},success:function(e){var t={request:"configure",audio:!1,video:!0,id:n.getState().mUser.id};window.cameraPluginHandle.send({message:t,jsep:e})},error:function(e){pe.a.error("WebRTC error:",e)}}),window.cameraPluginHandle.send({message:{request:"publish",video:!0,data:!1}}),t.publishers)){var i=t.publishers;for(var a in pe.a.debug("Got a list of available publishers/feeds:",i),i){var s=i[a].id,c=i[a].display,u=i[a].audio_codec,l=i[a].video_codec;pe.a.debug("  >> ["+s+"] "+c+" (audio: "+u+", video: "+l+")"),e.newRemoteFeed(n,s,c,u,l,t.room)}}if("created"===o);else if("destroyed"===o)pe.a.warn("The room has been destroyed!");else if("roomchanged"===o)window.myJanusCameraID=t.id;else if("event"===o)if(t.publishers)for(var a in i=t.publishers)s=i[a].id,c=i[a].display,u=i[a].audio_codec,l=i[a].video_codec,e.newRemoteFeed(n,s,c,u,l);else t.leaving||t.unpublished||t.error&&426===t.error_code&&e.createRoom(n)}r&&window.cameraPluginHandle.handleRemoteJsep({jsep:r})}},{key:"newRemoteFeed",value:function(t,r,n,o,i,a){var s=null;window.janusCameraSession.attach({plugin:"janus.plugin.videoroom",opaqueId:window.cameraOpaqueId,success:function(e){(s=e).simulcastStarted=!1,s.audioCodec=o;var t={request:"join",room:a,ptype:"subscriber",feed:r,offer_video:!0,offer_data:!1};s.send({message:t})},error:function(e){pe.a.error("  -- Error attaching plugin...",e)},onmessage:function(e,t){var r=e.videoroom;if(e.error);else if(r&&"attached"===r){for(var n=1;n<6;n++)if(!window.CameraFeeds[n]){window.CameraFeeds[n]=s,s.rfindex=n;break}s.rfid=e.id,s.rfdisplay=e.display}t&&s.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1},success:function(e){pe.a.debug("Got SDP!",e);var t={request:"start",room:a};s.send({message:t,jsep:e})},error:function(e){pe.a.error("WebRTC error:",e)}})},iceState:function(e){},webrtcState:function(e){pe.a.log(" WebRTC PeerConnection (feed #"+s.rfindex+") is "+(e?"up":"down")+" now")},onlocalstream:function(r){r.getVideoTracks().length&&e.playLocalStream(t,r,e.getJanusUserID(window.cameraPluginHandle.rfdisplay))},onremotestream:function(r){e.playRemoteStream(t,r,e.getJanusUserID(s.rfdisplay))},oncleanup:function(){}})}},{key:"getJanusUserID",value:function(e){return e.replace(new URL(socketIOHost).hostname+".","")}},{key:"joinRoom",value:function(e){window.cameraPluginHandle&&e>0&&window.cameraPluginHandle.send({message:{request:"join",ptype:"publisher",room:e,display:window.janusCameraUserID}})}},{key:"createRoom",value:function(t){if(window.cameraPluginHandle){var r=e.generateJanusRoomID(t.getState().mUser.id);window.cameraPluginHandle.send({message:{request:"create",room:r,permanent:!1,bitrate:64e3,publishers:1,description:socketIOHost},success:function(t){"created"==t.videoroom?e.joinRoom(t.room):"event"==t.videoroom&&t.error&&427==t.error_code&&e.joinRoom(r)}})}}},{key:"isRoomOwner",value:function(t,r){return e.generateJanusRoomID(t.getState().mUser.id)==r}},{key:"generateJanusRoomID",value:function(e){for(var t=new URL(socketIOHost),r=0,n=0;n<e.length;n++)r+=e.charCodeAt(n);return r=t.port+""+t.port*r,parseInt(r)}},{key:"destroySession",value:function(t,r){window.outgoingCameraStream&&window.outgoingCameraStream.getTracks().forEach((function(e){return e.stop()})),window.janusCameraSession&&window.janusCameraSession.isConnected()&&(r?window.cameraPluginHandle.send({message:{request:"destroy",room:e.generateJanusRoomID(t.getState().mUser.id)},success:function(t){"destroyed"==t.videoroom&&(window.janusCameraSession.destroy(),e.destroyAllFeeds())}}):(window.janusCameraSession.destroy(),e.destroyAllFeeds()))}},{key:"onJanusSessionDestroyed",value:function(e){e.getState().mUser.room&&e.getState().mUser.room.is_users_cam_enabled}},{key:"destroyAllFeeds",value:function(){window.CameraFeeds.forEach((function(e){}))}},{key:"onJanusAttachLocalStream",value:function(t,r){window.outgoingCameraStream=r,r.getVideoTracks().length&&e.playLocalStream(t,r)}},{key:"playLocalStream",value:function(e,t){window.outgoingCameraStream=t;var r=document.querySelector("#camera__box-"+e.getState().mUser.id+" video");if("srcObject"in r)try{r.srcObject=t}catch(e){if("TypeError"!=e.name)throw e;r.src=URL.createObjectURL(t)}else r.src=URL.createObjectURL(t);r.onloadedmetadata=function(e){r.paused&&r.play(),r.muted=!1}}},{key:"playRemoteStream",value:function(e,t,r){window.incomingCameraStreams[r]=t;var n=document.querySelector("#camera__box-"+r+" video");if("srcObject"in n)try{n.srcObject=t}catch(e){if("TypeError"!=e.name)throw e;n.src=URL.createObjectURL(t)}else n.src=URL.createObjectURL(t);n.onloadedmetadata=function(e){n.paused&&n.play(),n.muted=!1}}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"generateJanusUserID",value:function(e){return new URL(socketIOHost).hostname+"."+e}},{key:"render",value:function(t,r){var n="<div class='camera_box' id='camera__box-"+r.id+"' data-id='"+r.id+"'>";n+="<header class='camera_box__header label label-primary'>",n+="<span class='camera_box__title'>"+S.render(r)+"</span>",n+="<button data-id='"+r.id+"' class='camera_box__close fa fa-close btn btn-danger'></button>",n+="</header>",n+="<div class='camera_box__body fl'>",n+="<video autoplay muted></video>",n+="</div>",n+="</div>",$("#cameras_container").append(n),e.registerEvents(t),Xe.register(r.id)}}],(r=null)&&Ke(t.prototype,r),n&&Ke(t,n),e}();function Ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var et=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.getProfile(t),e.tagUser(t),S.onNameClicked(t),e.requestCamera(t)}},{key:"getProfile",value:function(e){$(".chat_pane__user_item__avatar").unbind("click").on("click",(function(t){var r=$(this).closest(".chat_pane__user_item").data("id");xt.show(r,e)}))}},{key:"tagUser",value:function(e){$(".chat_pane__user_item__name").unbind("click").on("click",(function(t){var r=$(this).closest(".chat_pane__user_item").data("id");hr.tagUser(r,e)}))}},{key:"requestCamera",value:function(e){$(".chat_pane__user_item__cam.open").unbind("click").on("click",(function(){if(e.getState().mUser.room){var t=$(this).closest(".chat_pane__user_item"),r=t.closest(".chat_pane__user_item").data("id"),n=e.getState().users.filter((function(e){return e.id==r}))[0];if(!n)return alert("   ");if(e.getState().users.filter((function(e){return e.id==r}))[0].room.id!=e.getState().mUser.room.id)return alert("           ");if(!$("#camera__box-"+r).length)return r==e.getState().mUser.id?Qe.render(e,e.getState().mUser):n&&e.getState().grantedSettings.open_cam&&e.getState().mUser.power>n.power?(Qe.render(e,n),void Qe.init(e,!1,Qe.generateJanusRoomID(n.id))):void e.getState().socket.emit("req",wr({type:"CAMERA_REQUEST",data:{user:r}}),(function(e){"waiting"==(e=Sr(e))&&t.find(".chat_pane__user_item__loader").show()}))}}))}},{key:"render",value:function(e,t,r){var n=e.micStatus.onMic?"on-mic ":"",o=e.micStatus.onHand?"on-hand ":"",i=e.micStatus.soundOff?"on-sound-off ":"",a=e.micTime?e.micTime+Date.now():0,s=e.active?"active":"",c=e.isHidden?"hidden":"",u=e.isCameraOn?"camera-on":"",l="<div id='user-"+e.id+"' data-id='"+e.id+"' class='border chat_pane__user_item "+s+" "+c+" "+u+"'>";return l+="<p class='chat_pane__user_item__avatar'>","?test"==location.search?l+="<img class='"+e.state+"' width='36' height='36' alt='' src='/images/floating_rose2.png' />":l+="<img class='"+e.state+"' width='36' height='36' alt='' src='"+e.avatar+"?v=1' />",l+=t?"<span class='status "+e.state+"'></span>":"",l+="</p>",l+="<div>",l+="<h5 class='chat_pane__user_item__name'>",l+=S.render(e),l+="</h5>",l+="<h5 style='color: "+e.statusColor+"' class='chat_pane__user_item__status'>",l+=g.render(e.status,r),e.hashTag,l+="</h5>",l+="</div>",l+="<img class='chat_pane__user_item__flag' alt='' width='16' height='16' src='"+e.countryFlag+"' />",l+="<img class='chat_pane__user_item__cam closed' src='/images/cam_closed.gif' />",l+="<img class='chat_pane__user_item__cam open' src='/images/cam_open.gif' />",l+="<img class='chat_pane__user_item__loader' alt='' width='24' height='24' src='/images/loader.gif' />",l+="<div class='clear'></div>",t&&(l+="<p class='chat_pane__user_item__mic_status "+n+" "+o+" "+i+"' >",e.micStatus.onMic&&(l+="<span class='mic-time' data-time='"+a+"'>00:00</span>"),l+="<img class='mic' alt='' src='/images/mic.png' />",l+="<img class='hand' alt='' src='/images/hand.png' />",l+="<img class='sound-off' alt='' src='/images/sound-off.png' />",l+="</p>"),l+="</div>"}}],(r=null)&&Ze(t.prototype,r),n&&Ze(t,n),e}();function tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var rt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.filterUsersByName(t),e.onCameraBtnClicked(t)}},{key:"updateUser",value:function(e,t){var r=$("#chat__body__users-pane #user-"+e);if(r){var n=t.getState().users.filter((function(t){return t.id==e}))[0];if(n){var o=n.micStatus.onMic?"on-mic ":"",i=n.micStatus.onHand?"on-hand ":"",a=n.micStatus.soundOff?"on-sound-off ":"",s=n.micTime?n.micTime+Date.now():0;n.active?r.addClass("active"):r.removeClass("active"),n.isHidden?r.addClass("hidden"):r.removeClass("hidden"),n.isCameraOn?r.addClass("camera-on"):r.removeClass("camera-on"),r.find(".chat_pane__user_item__avatar img").attr("src",n.avatar).removeClass("state_active").removeClass("state_no_private").removeClass("state_idle").addClass(n.state),r.find(".chat_pane__user_item__avatar .status").removeClass("state_active").removeClass("state_no_private").removeClass("state_idle").addClass(n.state),r.find(".chat_pane__user_item__name").html(S.render(n)),r.find(".chat_pane__user_item__status").html(g.render(n.status,t)).css("color",n.statusColor),r.find(".chat_pane__user_item__mic_status").removeClass("on-mic").removeClass("on-hand").removeClass("on-sound-off").addClass(o).addClass(i).addClass(a),n.micStatus.onMic&&r.find(".chat_pane__user_item__mic_status .mic-time").data("time",s)}}}},{key:"filterUsersByName",value:function(t){$("#chat__body__users-pane input.chat_pane__search").on("keyup",(function(r){var n,o;0==r.target.value.trim().indexOf("#")?t.dispatch({type:"FILTER_USERS_BY_HASH_TAG",hashTag:(o=r.target.value.trim().replaceAll("#","")).trim()?o:null}):t.dispatch({type:"FILTER_USERS_BY_NAME",name:(n=r.target.value.trim()).trim()?n:null}),e.setUsers(t)}))}},{key:"updateCurrentRoomName",value:function(e){$(".chat_pane__container .chat_pane__container__room_name").text(e.getState().mUser.room?e.getState().mUser.room.name:"")}},{key:"setUsers",value:function(t){"users"==t.getState().currentPane&&(e.setUsersOnCurrentRoom(t),e.setUsersOnOtherRooms(t),e.updateCurrentRoomName(t),window.usersPane.find("img").on("contextmenu",(function(){return!1})))}},{key:"setUsersOnCurrentRoom",value:function(e){window.usersPane.find("#chat__body__users-pane__current_room .chat_pane__user_item").unbind("click");var t=window.usersPane.find("#chat__body__users-pane__current_room");t.html(""),e.getState().usersFilter?isNaN(e.getState().usersFilter)?e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&t.name.toLowerCase().includes(e.getState().usersFilter.toLowerCase())})).forEach((function(r){t.append(et.render(r,!0,e))})):e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&t.hashTag==e.getState().usersFilter})).forEach((function(r){t.append(et.render(r,!0,e))})):e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&!e.getState().ignoredUsers.includes(t.id)})).forEach((function(r){t.append(et.render(r,!0,e))})),et.registerEvents(e)}},{key:"setUsersOnOtherRooms",value:function(e){window.usersPane.find("#chat__body__users-pane__other_rooms .chat_pane__user_item").unbind("click");var t=window.usersPane.find("#chat__body__users-pane__other_rooms");t.html(""),e.getState().usersFilter?e.getState().users.filter((function(t){return(!t.room||!e.getState().mUser.room||t.room.id!=e.getState().mUser.room.id)&&t.name.toLowerCase().includes(e.getState().usersFilter.toLowerCase())})).forEach((function(r){t.append(et.render(r,!0,e))})):e.getState().users.filter((function(t){return!t.room||!e.getState().mUser.room||t.room.id!=e.getState().mUser.room.id&&!e.getState().ignoredUsers.includes(t.id)})).forEach((function(r){t.append(et.render(r,!0,e))})),et.registerEvents(e)}},{key:"scrollToTop",value:function(){window.usersPane.find(".chat_pane__container").scrollTop(0)}},{key:"onCameraBtnClicked",value:function(e){$("#chat__body__users-pane--cam").unbind("click").on("click",(function(t){var r=this,n=$(this).hasClass("active")?"CAMERA_CLOSE":"CAMERA_OPEN";e.getState().socket.emit("req",wr({type:n,data:{}}),(function(t){if("string"==typeof(t=Sr(t)))return alert(t);$(r).toggleClass("active"),"CAMERA_OPEN"==n?(Qe.init(e,!0),Qe.render(e,e.getState().mUser)):(Qe.destroySession(e,!0),Qe.close(e,$("#camera__box-"+e.getState().mUser.id)))}))}))}},{key:"toggleCamera",value:function(e){e.getState().mUser.room&&e.getState().mUser.room.is_users_cam_enabled?$("#chat__body__users-pane--cam").removeClass("d-none"):($("#chat__body__users-pane--cam").addClass("d-none"),Qe.destroySession(e))}},{key:"render",value:function(e){var t=" <div id='chat__body__users-pane' class='chat_pane' style='background: "+Cr(e.getState().settings,!0)+"'>";return t+=f.render(""),t+="<input type='text' name='user-name' class='form-control chat_pane__search' placeholder='...' />",t+="<div><button class='btn btn-success' id='chat__body__users-pane--cam'><img class='cam_closed' src='/images/cam_closed.gif' /><img class='cam_open' src='/images/cam_open.gif' /> </button></div>",t+="<div class='chat_pane__container border'>",t+="<h4 class='chat_pane__label label label-primary right'>  <span class='chat_pane__container__room_name'></span></h4>",t+="<div id='chat__body__users-pane__current_room'></div>",t+="<h4 class='chat_pane__label label label-primary'>   </h4>",t+="<div id='chat__body__users-pane__other_rooms'></div>",t+="</div>",t+="</div>"}}],(r=null)&&tt(t.prototype,r),n&&tt(t,n),e}();function nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ot=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.close(t),e.setUsers(t)}},{key:"close",value:function(e){$(".chat__body__ignored-users-pane__back button").unbind("click").on("click",(function(t){e.dispatch(n("settings")),pr.togglePane(e)}))}},{key:"setUsers",value:function(e){var t=$("#chat__body__ignored-users-pane .chat_pane__container");t.html(""),e.getState().users.forEach((function(r){e.getState().ignoredUsers.includes(r.id)&&t.append(et.render(r,!0,e))})),et.registerEvents(e)}},{key:"render",value:function(e){var t="<div id='chat__body__ignored-users-pane' class='chat_pane' style='background: "+Cr(e.getState().settings,!0)+"'>";return t+=f.render(" "),t+="<p class='chat__body__ignored-users-pane__back'>",t+="<button class='btn btn-success fa fa-arrow-left'></button>",t+="</p>",t+="<div class='chat_pane__container border'></div>",t+="</div>"}}],(r=null)&&nt(t.prototype,r),o&&nt(t,o),e}();function it(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var at=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.ignore(t),e.unignore(t)}},{key:"ignore",value:function(e){$("#user_profile__footer__actions__item--ignore").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().ignoredUsers.includes(r)||(e.dispatch({type:"IGNORE_USER",id:r}),$("#user_profile__footer__actions__item--ignore").closest(".user_profile__footer__actions__item").addClass("ignored"),pr.updateUsersCout(e),rt.setUsers(e),ot.setUsers(e))}))}},{key:"unignore",value:function(e){$("#user_profile__footer__actions__item--unignore").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().ignoredUsers.includes(r)&&(e.dispatch({type:"UNIGNORE_USER",id:r}),$("#user_profile__footer__actions__item--ignore").closest(".user_profile__footer__actions__item").removeClass("ignored"),pr.updateUsersCout(e),rt.setUsers(e),ot.setUsers(e))}))}},{key:"render",value:function(e){var t=e.getState().requestedUser.id,r="<span class='user_profile__footer__actions__item "+(e.getState().ignoredUsers.includes(t)?"ignored":"")+"'>";return r+="<button id='user_profile__footer__actions__item--ignore' class='btn btn-default fa fa-ban red'></button>",r+="<button id='user_profile__footer__actions__item--unignore' class='btn btn-default fa fa-ban red'> </button>",r+="</span>"}}],(r=null)&&it(t.prototype,r),n&&it(t,n),e}();function st(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ct=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--reg-user-events").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_REG_USER_EVENTS",data:{id:r}}),(function(t){"string"==typeof(t=Sr(t))&&alert(t),!0===t&&(e.getState().requestedUser.regEvents?$("#user_profile__footer__actions__item--reg-user-events").text(" "):$("#user_profile__footer__actions__item--reg-user-events").text(" "))}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item'>";return e.getState().requestedUser.regEvents?t+="<button id='user_profile__footer__actions__item--reg-user-events' class='btn btn-default fa fa-dot-circle'> </button>":t+="<button id='user_profile__footer__actions__item--reg-user-events' class='btn btn-default fa fa-dot-circle'> </button>",t+="</span>"}}],(r=null)&&st(t.prototype,r),n&&st(t,n),e}();function ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var lt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(){$("#user_profile__footer__actions__item--chat-app").unbind("click").click("click",(function(e){window.open("/app.apk")}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--chat-app' class='btn btn-default fa fa-android green'> </button></span>"}}],(r=null)&&ut(t.prototype,r),n&&ut(t,n),e}();function dt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var pt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--cancel-radio").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_CANCEL_RADIO",data:{id:r}}),(function(e){"string"==typeof(e=Sr(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--cancel-radio' class='btn btn-default fa fa-ban'> </button></span>"}}],(r=null)&&dt(t.prototype,r),n&&dt(t,n),e}();function ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ht=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.mute(t),e.unmute(t)}},{key:"mute",value:function(e){$("#user_profile__footer__actions__item--mute").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_MUTE",data:{id:r}}),(function(e){if("string"==typeof(e=Sr(e)))return alert(e);$("#user_profile__footer__actions__item--mute").closest(".user_profile__footer__actions__item").addClass("muted")}))}))}},{key:"unmute",value:function(e){$("#user_profile__footer__actions__item--unmute").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_UNMUTE",data:{id:r}}),(function(e){if("string"==typeof(e=Sr(e)))return alert(e);$("#user_profile__footer__actions__item--mute").closest(".user_profile__footer__actions__item").removeClass("muted")}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item "+(e.getState().requestedUser.isMuted?"muted":"")+"'>";return t+="<button id='user_profile__footer__actions__item--mute' class='btn btn-default fa fa-microphone'></button>",t+="<button id='user_profile__footer__actions__item--unmute' class='btn btn-default fa fa-microphone-slash'> </button>",t+="</span>"}}],(r=null)&&ft(t.prototype,r),n&&ft(t,n),e}();function mt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-decoration").unbind("submit").on("submit",(function(t){t.preventDefault();var r=e.getState().requestedUser.id,n=t.target.decoration.value;e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_CHANGE_DECORATION",data:{id:r,decoration:n}}),(function(e){"string"==typeof(e=Sr(e))&&alert(e)}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-decoration' >";return t+="<label for='user_profile__footer__actions__change_decoration' class='label label-primary user_profile__footer__actions__item_group__label'></label>",t+="<input type='text' id='user_profile__footer__actions__change_decoration' name='decoration' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.name+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'></button>",t+="</form>"}}],(r=null)&&mt(t.prototype,r),n&&mt(t,n),e}();function gt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var vt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--control-likes").unbind("submit").on("submit",(function(t){t.preventDefault();var r=e.getState().requestedUser.id,n=parseInt(t.target.likes.value);isNaN(n)||e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_CONTROL_LIKES",data:{id:r,likes:n}}),(function(e){if("string"==typeof(e=Sr(e)))return alert(e);$("#user_profile__footer__actions__item--like").find("span").text(n)}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--control-likes' >";return t+="<label for='user_profile__footer__actions__control_likes' class='label label-primary user_profile__footer__actions__item_group__label'></label>",t+="<input type='number' id='user_profile__footer__actions__control_likes' name='likes' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.likes+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'></button>",t+="</form>"}}],(r=null)&&gt(t.prototype,r),n&&gt(t,n),e}();function yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-room").unbind("submit").on("submit",(function(t){t.preventDefault();var r=e.getState().requestedUser,n=r.id,o=t.target.room.value;r.room&&r.room.id==o||e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_CHANGE_ROOM",data:{id:n,roomId:o}}),(function(e){alert(Sr(e))}))}))}},{key:"render",value:function(e){var t=e.getState().requestedUser.room?e.getState().requestedUser.room.id:null,r="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-room' >";return r+="<label for='user_profile__footer__actions__change_room' class='label label-primary user_profile__footer__actions__item_group__label'></label>",r+="<select id='user_profile__footer__actions__change_room' name='room' class='user_profile__footer__actions__item_group__input'>",e.getState().rooms.forEach((function(e){var n=e.id==t?"selected":"";r+="<option dir='rtl' "+n+" value='"+e.id+"'>"+e.name+"</option>"})),r+="</select>",r+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'></button>",r+="</form>"}}],(r=null)&&yt(t.prototype,r),n&&yt(t,n),e}();function wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var St=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-subscription-end").unbind("submit").on("submit",(function(t){t.preventDefault();var r=e.getState().requestedUser.id,n=parseInt(t.target.subscription_end.value);e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_CHANGE_SUBSCRIPTION_END",data:{id:r,end:n}}),(function(e){Sr(e)&&alert(Sr(e))}))}))}},{key:"toggle",value:function(e){e.getState().requestedUser&&(e.getState().requestedUser.isSuper&&!e.getState().requestedUser.isOwner?$("#user_profile__footer__actions__item_group--change-subscription-end").show():$("#user_profile__footer__actions__item_group--change-subscription-end").hide(),$("#user_profile__footer__actions__change_subscription_end").val(Rr(e.getState().requestedUser.subscription_end)))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-subscription-end' >";return t+="<label for='user_profile__footer__actions__change_subscription_end' class='label label-primary user_profile__footer__actions__item_group__label' style='width: 25%'> </label>",t+="<input type='number' id='user_profile__footer__actions__change_subscription_end' name='subscription_end' class='user_profile__footer__actions__item_group__input' style='width: 55%' value='"+Rr(e.getState().requestedUser.subscription_end)+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'></button>",t+="</form>"}}],(r=null)&&wt(t.prototype,r),n&&wt(t,n),e}();function kt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ct=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-role").unbind("submit").on("submit",(function(t){t.preventDefault();var r=e.getState().requestedUser,n=r.id,o=t.target.role.value;r.role!=o&&e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_CHANGE_ROLE",data:{id:n,roleId:o}}),(function(t){Sr(t)&&alert(Sr(t)),St.toggle(e)}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-role' >";return t+="<label for='user_profile__footer__actions__change_role' class='label label-primary user_profile__footer__actions__item_group__label'></label>",t+="<select id='user_profile__footer__actions__change_role' name='role' class='user_profile__footer__actions__item_group__input'>",e.getState().requestedUser.roles.forEach((function(r){var n=r.id==e.getState().requestedUser.role?"selected":"";t+="<option dir='rtl' "+n+" value='"+r.id+"'>"+r.name+"</option>"})),t+="</select>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'></button>",t+="</form>"}}],(r=null)&&kt(t.prototype,r),n&&kt(t,n),e}();function Et(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Tt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--report").unbind("click").click("click",(function(t){var r=e.getState().requestedUser.id,n=prompt("   ");(n=n?n.trim():null)&&(n=n.substring(0,100),e.getState().socket.emit("req",wr({type:"PROFILE_ACTION_REPORT",data:{id:r,message:n}}),(function(e){alert(Sr(e))})))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--report' class='btn btn-default fa fa-flag red'></button></span>"}}],(r=null)&&Et(t.prototype,r),n&&Et(t,n),e}();function Pt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function At(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(r),!0).forEach((function(t){Rt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Rt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ot(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var xt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(e){}},{key:"registerActionEvents",value:function(e){Ce.registerEvents(e),Te.registerEvents(e),Ae.registerEvents(e),Oe.registerEvents(e),Me.registerEvents(),Le.registerEvents(e),Fe.registerEvents(e),Ne.registerEvents(e),Ge.registerEvents(e),We.registerEvents(e),at.registerEvents(e),lt.registerEvents(e),pt.registerEvents(e),ht.registerEvents(e),_t.registerEvents(e),vt.registerEvents(e),bt.registerEvents(e),Ct.registerEvents(e),St.registerEvents(e),ct.registerEvents(e),Tt.registerEvents(e)}},{key:"show",value:function(t,r){if(!r.getState().isRequestingProfile){var n=r.getState().users.filter((function(e){return e.id==t}))[0];if(!n)return r.getState().socket.emit("req",wr({type:"PROFILE_SHOW",data:{id:t,force:!0}}),(function(t){r.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_REQUESTING_PROFILE",isRequestingProfile:e}}(!1)),(t=Sr(t)).user&&(r.dispatch(I(At(At({},t.user),{},{actions:t.actions,roles:t.roles,liked:t.liked}))),e.render(r),$("#user_profile").modal("show"))}));r.dispatch(I(At(At({},n),{},{actions:window.userActions,roles:window.roles,liked:!1}))),e.render(r),$("#user_profile").modal("show"),r.getState().socket.emit("req",wr({type:"PROFILE_SHOW",data:{id:t}}),(function(t){t=Sr(t),e.setLikes(t.likes,t.liked),St.toggle(r)}))}}},{key:"setLikes",value:function(e,t){t?$("#user_profile__footer__actions__item--like").parent().addClass("active").find("span").text(e):$("#user_profile__footer__actions__item--like").parent().removeClass("active").find("span").text(e),$("#user_profile__footer__actions__item_group--control-likes").find("input").val(e)}},{key:"clearAvatar",value:function(e){var t=e.getState().requestedUser.avatar;$("#user_profile .user_profile__body__avatar").attr("src",t)}},{key:"render",value:function(t){var r=t.getState().requestedUser;if(!r)return $("#user_profile_container").html("");$("#user_profile_container").html("");var n="<div class='modal fade' id='user_profile' tabindex='-1' role='dialog' aria-hidden='true'>";n+="<div class='modal-dialog' role='document' style='max-width: 345px'>",n+="<div class='modal-content'>",n+="<div class='user_profile__header modal-header label label-primary'>",n+="<div class='modal-title'>",n+="<img class='user_profile__header__avatar' width='25' height='25' src='"+r.avatar+"' alt=''/>",n+="<p class='user_profile__header__name ellipsis'>",n+=S.render(r),n+="</p>",n+="<button data-dismiss='modal' class='btn btn-danger user_profile__header__close'>&times;</button>",n+="</div><div class='clear'></div>",n+="</div>",n+="<div class='user_profile__scroll_area' id='user_profile__scroll_area'>",n+="<div class='user_profile__body modal-body'>",r.actions.reveal_names&&(n+=Ue.render(t),Ue.registerEvents(t)),n+="<div id='user_profile__body__user_details'>",n+="<img class='user_profile__body__avatar img-rounded img-thumbnail' src='"+r.avatar.replace("/sm/","/lg/")+"' alt=''/>",n+=C.render(t),n+=r.actions.ip?"<p class='user_profile__body__ip label label-success'>"+r.ip+"</p>":"",n+="<p style='color: "+r.statusColor+"' class='user_profile__body__status'>",n+=g.render(r.status,t),n+="</p>",n+="<div dir='rtl'>",n+="<div class='user_profile__body__room'>",n+=jt.render(r.room,!0,t,!0),n+="</div>",n+="<span class='user_profile__body__country_flag'>",n+="<span class='user_profile__body__country_name'>"+r.countryName+"</span>",n+="<img width='18' src='"+r.countryFlag+"' alt='' />",n+="</span>",n+="</div>",n+="<div class='clear'></div>",n+="</div>",n+="</div>",n+="<div class='user_profile__footer modal-footer'>",n+="<div class='user_profile__footer__actions'>",n+=Ce.render(t),n+=r.actions.notify?Te.render(t):"",n+=Ae.render(t),n+=r.actions.gift?Me.render():"",n+=r.actions.reveal_names?Le.render(t):"",n+=r.actions.remove_avatar?Fe.render(t):"",n+=r.actions.room_excpel?Ne.render(t):"",n+=r.actions.excpel?Ge.render(t):"",n+=r.actions.ban?We.render(t):"",n+=at.render(t),n+=lt.render(t),n+=r.actions.admin_mute?ht.render(t):"",t.getState().settings.isWebview&&r.id!=t.getState().mUser.id&&(n+=Tt.render(t)),n+=r.actions.change_decoration?_t.render(t):"",n+=r.actions.control_likes?vt.render(t):"",n+=r.actions.change_room?bt.render(t):"",n+=r.actions.change_role?Ct.render(t):"",n+=r.actions.change_role?St.render(t):"",n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",$("#user_profile_container").html(n),e.registerEvents(t),e.registerActionEvents(t),C.registerEvents(t),jt.registerEvents(t),St.toggle(t),$("#user_profile").find("img").on("contextmenu",(function(){return!1}))}}],(r=null)&&Ot(t.prototype,r),n&&Ot(t,n),e}();function Mt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Dt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(e){S.onNameClicked(e)}},{key:"updateUser",value:function(e,t){var r=t.getState().users.filter((function(t){return t.id==e}))[0];if(r){var n=$(".public_message:not(.linen)[data-user='"+e+"']");n&&(n.find(".public_message__avatar img").attr("src",r.avatar),n.find(".public_message__title").html(S.render(r)),n.find(".public_message__content").css("color",r.fontColor)),(n=$(".public_message.linen[data-user='"+e+"']"))&&(n.find(".public_message__avatar img").attr("src",r.avatar),n.find(".public_message__title").html(S.render(r)))}}},{key:"remove",value:function(e){window.publicMessagesContainer.find(".public_message[data-id='"+e+"']").remove()}},{key:"clearSelfMessages",value:function(){return window.publicMessagesContainer.find(".public_self_message").remove()}},{key:"renderGreetUserMessage",value:function(e,t){Date.now(),t.getState().mUser.room&&t.getState().mUser.room.is_video_room;var r=e.icon?"/uploads/greeting-messages/"+e.icon:t.getState().mUser.room.flag,n="<div class='public_message' style='background-color: "+e.backgroundColor+"' >";return n+="<p class='public_message__avatar'>",n+="<img width='36' height='38' src='"+r+"' />",n+="</p>",n+="<div>",n+="<h5 class='public_message__title' style='color: "+e.titleColor+"'>",n+=e.title,n+="</h5>",n+="<h5 class='public_message__content' style='color: "+e.contentColor+"'>",n+=g.render(e.content,t),n+="</h5>",n+="</div>",n+="<div class='clear'></div>",n+="</div>"}},{key:"renderJoinLeaveMessage",value:function(e,t){Date.now();var r="<div class='public_message linen"+(t.getState().mUser.room&&t.getState().mUser.room.is_video_room?"video-room":"")+"' data-user='"+e.user.id+"' >";return r+="<p class='public_message__avatar' data-id='"+e.user.id+"'>",r+="<img width='36' height='38' src='"+e.icon+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title'>",e.user?r+=S.render(e.user):r+=e.title,r+="</h5>",r+="<h5 class='public_message__content'>",r+=g.render(e.content,t),e.room&&(r+=jt.render(e.room,!0,t)),r+="</h5>",r+="</div>",r+="<div class='clear'></div>",r+="</div>"}},{key:"renderRoomGreeting",value:function(e,t){Date.now();var r="<div class='public_message greeting "+(t.getState().mUser.room&&t.getState().mUser.room.is_video_room?"video-room":"")+"' style='background: "+t.getState().settings.self_message_bg_color+"' >";return r+="<p class='public_message__avatar'>",r+="<img width='36' height='38' src='"+e.icon+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title' style='color: "+t.getState().settings.self_message_title_color+"'>"+t.getState().settings.rooms_greeting_title+"</h5>",r+="<h5 class='public_message__content' style='color: "+t.getState().settings.self_message_content_color+"' >",r+=g.render(e.content,t),r+="</h5>",r+="</div>",r+="<div class='clear'></div>",r+="</div>"}},{key:"renderPublicMessage",value:function(e,t){var r="";e.tagged&&(r+="<span style='display: inline-block; margin-left: 6px;'>"+S.render(e.tagged)+"</span><span style='color: blue; vertical-align: top; top: 3px; position: relative; left: 3px;'> : </span></span>");var n="<div class='public_message "+(t.getState().mUser.room&&t.getState().mUser.room.is_video_room?"video-room":"")+"' data-id='"+e.id+"' data-user='"+e.user.id+"'>";return n+="<p class='public_message__avatar' data-id='"+e.user.id+"'>","?test"==location.search?n+="<img width='36' height='38' src='/images/floating_rose2.png' />":n+="<img width='36' height='38' src='"+e.icon+"' />",n+="</p>",n+="<div>",n+="<h5 class='public_message__title'>",e.user?n+=r+"<span style='display: inline-block;'>"+S.render(e.user)+"</span>":n+=e.title,n+="</h5>",e.user&&(n+="<h5 class='public_message__content' style='color: "+(e.user?e.user.fontColor:"#000000")+"' >",n+=g.render(e.content,t),n+="</h5>"),n+="</div>",t.getState().mUser.canRemovePublicMessages,n+="<div class='clear'></div>",n+="</div>"}},{key:"renderAd",value:function(e,t){var r="<div class='public_message public_message_ad "+(t.getState().mUser.room&&t.getState().mUser.room.is_video_room?"video-room":"")+"' data-id='"+e.id+"' data-user='"+e.user.id+"' >";return r+="<p class='public_message__avatar' data-id='"+e.user.id+"'>",r+="<img width='36' height='38' src='"+e.user.avatar+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title'>",e.user?r+=S.render(e.user):r+=e.title,r+="</h5>",r+="<h5 class='public_message__content' style='color: "+(e.user?e.user.fontColor:"#000000")+"' >",r+=g.render(e.content,t),r+="<span class='public_message__content_title' style='color: blue; margin-right: 0.4rem'><span class='fa fa-comment'></span></span>",r+="</h5>",r+="</div>",t.getState().mUser.canRemovePublicMessages,r+="<div class='clear'></div>",r+="</div>"}},{key:"renderSelfMessage",value:function(t,r){Date.now();var n="<div class='public_message public_self_message public_message_ad "+(r.getState().mUser.room&&r.getState().mUser.room.is_video_room?"video-room":"")+"' style='background: "+r.getState().settings.self_message_bg_color+"' >";return n+="<p class='public_message__avatar'>",n+="<img width='36' height='38' src='"+e.getSelfMessageIcon(r)+"' />",n+="</p>",n+="<div>",n+="<h5 class='public_message__title' style='color: "+r.getState().settings.self_message_title_color+"'>"+t.title+"</h5>",n+="<h5 class='public_message__content' style='color: "+r.getState().settings.self_message_content_color+"' >",n+=g.render(t.content,r),n+="</h5>",n+="</div>",n+="<div class='clear'></div>",n+="</div>"}},{key:"renderBotBrbMessage",value:function(t,r){Date.now();var n="<div class='public_message public_bot_brb_message"+(r.getState().mUser.room&&r.getState().mUser.room.is_video_room?"video-room":"")+"' >";return n+="<p class='public_message__avatar'>",n+="<img width='36' height='38' src='"+e.getBotBrbAvatar(r)+"' />",n+="</p>",n+="<h5 class='public_message__bot_brb_title' style='color: "+r.getState().settings.self_message_title_color+"'>  </h5>",n+="<div>",n+="<h5 class='public_message__title' style='color: "+r.getState().settings.self_message_title_color+"'>",t.user?n+=S.render(t.user):n+=t.title,n+="</h5>",n+="<h5 class='public_message__content' style='color: "+r.getState().settings.self_message_content_color+"' >",n+=g.render(t.content,r),n+="</h5>",n+="</div>",n+="<div class='clear'></div>",n+="</div>"}},{key:"getSelfMessageIcon",value:function(e){return e.getState().settings.self_messages_icon?"/uploads/"+e.getState().settings.self_messages_icon:"/images/default_room.png"}},{key:"getBotBrbAvatar",value:function(e){return e.getState().settings.self_messages_icon?"/uploads/"+e.getState().settings.self_messages_icon:"/images/bot_brb.png"}},{key:"render",value:function(t,r){switch(t.type){case"GREET_USER":return e.renderGreetUserMessage(t,r);case"JOIN_LEAVE":return e.renderJoinLeaveMessage(t,r);case"ROOM_GREETING":return e.renderRoomGreeting(t,r);case"PUBLIC_MESSAGE":return e.renderPublicMessage(t,r);case"AD":return e.renderAd(t,r);case"SELF_MESSAGE":return e.renderSelfMessage(t,r);case"BOT_BRB_MESSAGE":return e.renderBotBrbMessage(t,r);default:return null}}},{key:"insert",value:function(t,r){window.publicMessagesContainer.find(".public_message").length>=20&&window.publicMessagesContainer.find(".public_message")[0].remove();var n=e.render(t,r),o=null;if(r.getState().mUser.room&&r.getState().mUser.room.is_video_room)o=window.publicMessagesContainer.find("#chat__body__messages_container__messages").append(n);else{t.tagged&&window.taggedUser&&(t.tagged.id,window.taggedUser),t.user&&(t.user.id,window.taggedUser);var i=t.tagged&&t.tagged.id==r.getState().mUser.id;o=window.togglePublicMessagesDivider&&window.togglePublicMessagesDivider[0].checked&&(t.user&&t.user.id==r.getState().mUser.id||i)?window.publicMessagesContainerDivider.append(n):window.publicMessagesContainer.append(n)}o.find(".public_message__avatar").unbind("click").on("click",(function(e){xt.show($(this).data("id"),r)})),o.find(".public_message__title .username").unbind("click").on("click",(function(e){hr.tagUser($(this).closest(".public_message").data("user"),r)})),o.find(".public_message__remove").unbind("click").on("click",(function(e){var n=e.target.dataset.id;"AD"==t.type?r.getState().socket.emit("req",wr({type:"REMOVE_PUBLIC_MESSAGE",data:{id:n,is_ad:!0,message:t.content}}),(function(e){})):r.getState().socket.emit("req",wr({type:"REMOVE_PUBLIC_MESSAGE",data:{id:n}}),(function(e){}))})),hr.scrollToBottom(),"JOIN_LEAVE"==t.type&&jt.registerEvents(r),o.find("img").on("contextmenu",(function(){return!1}))}}],(r=null)&&Mt(t.prototype,r),n&&Mt(t,n),e}();function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Bt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onFormSubmit(t),e.onLeaveRoom(t),e.openFacePicker(t),e.closePanes(t),e.clearPublicMessages(t),e.resetUserTag(t),e.disableCtrlV(t),e.onDividerClicked(t)}},{key:"disableCtrlV",value:function(){var e=!1;$(document).keydown((function(t){17!=t.keyCode&&91!=t.keyCode||(e=!0)})).keyup((function(t){17!=t.keyCode&&91!=t.keyCode||(e=!1)})),$("#chat__body__message-input__input").keydown((function(t){if(e&&86==t.keyCode)return!1}))}},{key:"onDividerClicked",value:function(t){$("#chat__body__message-input__divide").unbind("change").on("change",(function(r){var n=$(this)[0].checked;e.toggleDivider(t,n)}))}},{key:"toggleDivider",value:function(e,t){var r=document.getElementById("chat__body__messages_container__divider");r.style.display=t?"block":"none";var n=Pr()/document.body.style.zoom,o=document.getElementById("mic-speakers"),i=o?o.clientHeight:0,a=r?r.clientHeight:0;document.getElementById("chat__body__messages_container").style.height="calc("+n+"px - 32px - 40px - "+(i+a)+"px)",hr.scrollToBottom()}},{key:"resetUserTag",value:function(e){$("#chat__body__message-input__target-holder").on("click",(function(e){e.preventDefault(),window.taggedUser=null,$("#chat__body__message-input__target").text("")}))}},{key:"clearPublicMessages",value:function(e){$(".chat__body__message-clear_screan").on("click",(function(t){t.preventDefault(),$(".public_message").remove(),e.dispatch({type:"CLEAR_ALL_PUBLIC_MESSAGES"})}))}},{key:"onFormSubmit",value:function(t){$("#chat__body__message-input form").on("submit",(function(r){r.preventDefault();var n=r.target.message.value.substring(0,250),o=r.target.message;n.trim()&&(o.value="",o.focus(),t.getState().socket.emit("req",wr({type:"NEW_PUBLIC_MESSAGE",data:{message:n,taggedUser:window.taggedUser}}),(function(r){if("string"==typeof(r=Sr(r)))return alert(r);n=e.sanitize(n,t.getState().settings.public_msg_length),Dt.insert({id:Date.now(),tagged:window.taggedUser?t.getState().users.filter((function(e){return e.id==window.taggedUser}))[0]:null,user:t.getState().mUser,icon:t.getState().mUser.avatar,title:t.getState().mUser.name,content:n,type:"PUBLIC_MESSAGE"},t),window.lastMessage={time:Date.now(),isPublic:!0,isPrivate:!1,msg:r.data.message}})))}))}},{key:"onLeaveRoom",value:function(t){$(".chat__body__message-input__leave_room").on("click",(function(){if("object"==It(window.ludoPlayers)&&window.ludoPlayers.filter((function(e){return e.user_id==t.getState().mUser.id}))[0])return alert("       ");t.getState().socket.emit("req",wr({type:"LEAVE_ROOM",data:{}}),(function(r){r=Sr(r),Dt.insert({icon:r.user.avatar,title:r.user.name,user:r.user,room:null,content:"(   )",type:"JOIN_LEAVE"},t),e.toggleInput(t),me.toggle(t,!1),re.resetData(!0)}))}))}},{key:"toggleInput",value:function(e){e.getState().mUser.room?$("#chat__body__message-input__input, .chat__body__message-input__leave_room").removeAttr("disabled"):$("#chat__body__message-input__input, .chat__body__message-input__leave_room").attr("disabled","disabled")}},{key:"openFacePicker",value:function(t){$("#chat__body__message-input__face").on("click",(function(r){t.dispatch(b(!0)),e.closePanes(t)}))}},{key:"closePanes",value:function(e){$("#chat__body__message-input__input").on("focus",(function(t){e.dispatch(n(null)),pr.togglePane(e)}))}},{key:"canSendMessage",value:function(e){return e.getState().mUser.likes>=e.getState().settings.required_likes_public}},{key:"isXSS",value:function(e){return"string"==typeof e&&/on[a-zA-Z ]{0,}=/g.test(e)}},{key:"convertArNumbers",value:function(e){try{return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(//g,"0")).replace(//g,"1")).replace(//g,"2")).replace(//g,"3")).replace(//g,"4")).replace(//g,"5")).replace(//g,"6")).replace(//g,"7")).replace(//g,"8")).replace(//g,"9")}catch(t){return e}}},{key:"parseShortcuts",value:function(e){try{var t=e.split(" ");if(!t.length)return"";var r="";return window.shortcuts.values.length?(t.forEach((function(e){if(e.trim().length){var t=window.shortcuts.keys.indexOf(e);r+=t>=0?" "+window.shortcuts.values[t]:" "+e}}))," "==r.charAt(0)?r.replace(" ",""):r):e}catch(e){return""}}},{key:"sanitize",value:function(t,r){try{return"string"!=typeof t?"":e.isXSS(t)?"------":(t=e.convertArNumbers(t),t=(t=r?t.substring(0,r):t).replace(/\s+/g," ").replace(/</g,"").replace(/>/g,""),t=e.parseShortcuts(t))}catch(e){return""}}},{key:"render",value:function(e){var t=e.getState().mUser.room?"":"disabled",r="<div id='chat__body__message-input'>";return r+=y.render("public_messages","#chat__body__message-input__input",e),r+="<form>",r+="<button type='button' class='chat__body__message-input__leave_room btn btn-primary fa fa-sign-out'></button>",r+="<img class='chat__body__message-input__face' id='chat__body__message-input__face' src='/images/smile.gif' alt='' />",r+="<input id='chat__body__message-input__divide' type='checkbox' />",r+="<span id='chat__body__message-input__target-holder'>",r+="<span id='chat__body__message-input__target'></span>",r+="</span>",r+="<input "+t+" class='border-color chat__body__message-input__input' name='message' id='chat__body__message-input__input' autoComplete='off' type='text' placeholder='  ' />",r+="<button class='btn btn-primary fa fa-send chat__body__message-input__submit'></button>",r+="<button class='btn btn-primary fa fa-clear chat__body__message-clear_screan'></button>",r+="</form>",r+="</div>"}}],(r=null)&&Ut(t.prototype,r),o&&Ut(t,o),e}();function Lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var jt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.joinRoom(t)}},{key:"joinRoom",value:function(t){$(".chat_pane__room_item, .chat_pane__room_item--inline").unbind("click").on("click",(function(r){var n=$(this).data("id"),o=null;if((!t.getState().mUser.room||t.getState().mUser.room.id!=n)&&(!$(this).data("password")||t.getState().mUser.canOpenLockedRooms||(o=prompt("   ")))){var i={type:"JOIN_ROOM",data:{id:n,password:o}};t.getState().socket.emit("req",wr(i),(function(r){!1===(r=Sr(r)).error?(Gt.setRooms(t),Gt.setCurrentRoomActive(t),e.registerEvents(t),Bt.toggleInput(t),me.resetAllMics(),t.getState().mUser.room&&t.getState().mUser.room.micUsers.forEach((function(e){me.setUserOnMic(t,t.getState().users.filter((function(t){return t.id==e.user_id}))[0],e.micId)})),me.toggle(t,t.getState().mUser.room.is_voice_room),window.taggedUser=null,$("#chat__body__message-input__target").text(""),t.getState().mUser.room.ludoGameState.players?(window.ludoPlayers=t.getState().mUser.room.ludoGameState.players,window.ludoCurrentTurn=t.getState().mUser.room.ludoGameState.currentTurn,re.render(t,null,t.getState().mUser.room.ludoGameState),$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),re.onShowLudo(t)):re.resetData(!0),rt.toggleCamera(t)):r.message&&alert(r.message)}))}}))}},{key:"renderRoom",value:function(e,t){var r=t.getState().mUser.room&&t.getState().mUser.room.id==e.id?"active":"",n=e.password?"locked":"",o=e.is_voice_room?"has-mic":"",i=e.is_video_room?"has-video":"",a="<div data-id='"+e.id+"' data-password='"+e.password+"' class='chat_pane__room_item "+i+" "+r+" "+n+" "+o+"' >";return"?test"==location.search?a+="<p class='chat_pane__room_item__flag'><img class='radius' width='36' height='36' alt='' src='/images/floating_rose3.png' /></p>":a+="<p class='chat_pane__room_item__flag'><img class='radius' width='36' height='36' alt='' src='"+e.flag+"' /></p>",a+="<div>",a+="<h5 class='chat_pane__room_item__name'>",a+=e.name,a+="<img class='chat_pane__room_item--lock' alt='' src='/images/lock.png' />",a+="<img class='chat_pane__room_item--mic' width='20' alt='' src='/images/mic.png' />",a+="<img class='chat_pane__room_item--video' width='20' alt='' src='/images/video.png' />",a+="</h5>",a+="<h5 class='chat_pane__room_item__description'>",a+=g.render(e.description,t),a+="</h5>",a+="</div>",a+="<span class='chat_pane__room_item__users corner fa fa-user label label-primary fr'>"+e.users.length+"/"+e.capacity+"</span>",a+="<div class='clear'></div>",a+="</div>"}},{key:"renderInlineRoom",value:function(e,t){var r="<span data-id='"+e.id+"' data-password='"+e.password+"' class='chat_pane__room_item--inline label label-primary'>";return r+=e.name,r+=t?"<img src='"+e.flag+"' width='20' alt=''/>":"<span class='fa fa-sign-in'></span>",r+="</span>"}},{key:"render",value:function(t,r,n,o){return t?r&&t?e.renderInlineRoom(t,o):e.renderRoom(t,n):""}}],(r=null)&&Lt(t.prototype,r),n&&Lt(t,n),e}();function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Nt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.createRoom(t)}},{key:"createRoom",value:function(t){$("#createRomModal form").on("submit",(function(r){r.preventDefault();var n=r.target.name.value.trim(),o=r.target.description.value.trim(),i=r.target.welcome.value.trim(),a=r.target.required_likes.value,s=r.target.password.value.trim(),c=r.target.capacity.value,u=r.target.permanent.checked;return n.length?n.length<2?e.showErrorMessage("       "):t.getState().rooms.filter((function(e){return e.name==n})).length?e.showErrorMessage("  ,    "):c<2||c>50?e.showErrorMessage("      2  50"):void t.getState().socket.emit("req",wr({type:"CREATE_ROOM",data:{room:{name:n,description:o,welcome:i,password:s,required_likes:a,capacity:c,isPermanent:u}}}),(function(t){if("string"==typeof(t=Sr(t)))return alert(t);t&&"object"==Ft(t)&&(!1===t.error?e.showSuccessMessage("   "):!0===t.error&&e.showErrorMessage(t.message))})):e.showErrorMessage("   ")}))}},{key:"showErrorMessage",value:function(e){$("#createRomModal .alert-success").hide(),$("#createRomModal .alert-danger").text(e).show()}},{key:"showSuccessMessage",value:function(e){$("#createRomModal .alert-success").text(e).show(),$("#createRomModal .alert-danger").hide()}},{key:"render",value:function(t){$("#createRomModal form").unbind("submit"),$("#create_room_container").html("<div class='modal fade room_modal' id='createRomModal' tabindex='-1' role='dialog' aria-hidden='true'><div class='modal-dialog' role='document'><div class='modal-content'><div class='room_modal__header modal-header label label-primary'><div class='modal-title'><p class='room_modal__header__name ellipsis'>  </p><button data-dismiss='modal' class='btn btn-danger room_modal__header__close fa fa-times'></button></div></div><div class='room_modal__body modal-body'><p class='alert alert-danger' style='display: none'></p><p class='alert alert-success' style='display: none'></p><form id='room_modal__body__form'><div><div><input type='text' name='name' placeholder=' ' /></div><div><input type='text' name='description' placeholder='' /></div><div><input type='text' name='welcome' placeholder=' ' /></div><div><input type='text' name='password' placeholder=' ' /></div><div><input type='number' name='required_likes' placeholder=' ' /></div><div><input type='number' name='capacity' value='50' placeholder='   2  50' /></div><div><input type='checkbox' name='permanent' id='room_modal__body__checkbox' /><label for='room_modal__body__checkbox'> </label></div><button class='btn btn-success'><span class='fa fa-plus'></span> &nbsp;</button></div></form></div></div></div></div>"),e.registerEvents(t)}}],(r=null)&&$t(t.prototype,r),n&&$t(t,n),e}();function qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Gt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.showCreateRoomDialog(t),e.setRooms(t)}},{key:"showCreateRoomDialog",value:function(e){$("#chat__body__rooms_pane__create_room").on("click",(function(t){Nt.render(e)}))}},{key:"setCurrentRoomActive",value:function(e){$("#chat__body__rooms_pane .chat_pane__room_item").removeClass("active"),e.getState().mUser.room&&$("#chat__body__rooms_pane .chat_pane__room_item[data-id='"+e.getState().mUser.room.id+"']").addClass("active")}},{key:"setRooms",value:function(e){if(pr.updateRoomsCount(e),"rooms"==e.getState().currentPane){$(".chat_pane__room_item").unbind("click");var t=$("#chat__body__rooms_pane .chat_pane__container");t.html(""),e.getState().rooms.forEach((function(r){t.append(jt.render(r,!1,e))})),jt.registerEvents(e)}}},{key:"scrollToTop",value:function(){document.querySelector("#chat__body__rooms_pane .chat_pane__container").scrollTo({top:0})}},{key:"render",value:function(e){var t="<div id='chat__body__rooms_pane' class='chat_pane' style='background: "+Cr(e.getState().settings,!0)+"'>";return t+=f.render(" "),t+="<div><button id='chat__body__rooms_pane__create_room' data-toggle='modal' data-target='#createRomModal' class='border btn btn-success fa fa-plus'> </button></div>",t+="<div class='chat_pane__container border'></div>",t+="</div>"}}],(r=null)&&qt(t.prototype,r),n&&qt(t,n),e}(),Vt=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_WALL_COMMENTS_FACE_PICKER",isWallCommentsFacePickerOpen:e}};function Wt(e){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ht(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var zt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.sendComment(t),e.openFacePicker(t),e.onRemove(t),e.onLike(t)}},{key:"openFacePicker",value:function(e){$("#wall_comments__attach__face").unbind("click").on("click",(function(t){e.dispatch(Vt(!0)),y.onSelect()}))}},{key:"onRemove",value:function(e){$("#wall_comments .wall_comments__comment__remove").unbind("click").on("click",(function(t){var r=t.target.dataset.id,n=t.target.dataset.postId;e.getState().socket.emit("req",wr({type:"WALL_POST_COMMENT_REMOVE",data:{id:r,postId:n}}),(function(e){if("string"==typeof(e=Sr(e)))return alert(e)}))}))}},{key:"onLike",value:function(t){$("#wall_comments .wall_comments__comment__like").unbind("click").on("click",(function(r){var n=r.target.dataset.id;t.getState().socket.emit("req",wr({type:"WALL_POST_COMMENT_LIKE",data:{id:n}}),(function(t){if("string"==typeof(t=Sr(t)))return alert(t);"object"==Wt(t)&&!1===t.error&&e.incCommentLikes(n)}))}))}},{key:"incCommentLikes",value:function(e){var t=$("#wall_comments .wall_comments__comment[data-id='"+e+"'] .wall_comments__comment__like").text();t=parseInt(t)+1,$("#wall_comments .wall_comments__comment[data-id='"+e+"'] .wall_comments__comment__like").text(t)}},{key:"scrollToBottom",value:function(){var e=document.getElementById("wall_comments__scroll_area");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"setComments",value:function(t,r){var n=$("#wall_comments .wall_comments__body");n.html(""),t.forEach((function(t){n.append(e.renderPostComment(t,r))})),setTimeout((function(){e.scrollToBottom(),e.registerEvents(r)}),500)}},{key:"renderPostComment",value:function(e,t){var r=t.getState().posts.filter((function(t){return t.id==e.postId}))[0],n="<div class='wall_comments__comment' data-id='"+e.id+"' >";return n+="<p class='wall_comments__comment__avatar'>",n+="<img class='radius border border-color' width='30' height='30' src='"+e.user.avatar+"' />",n+="</p>",n+="<div>",n+="<h5 class='wall_comments__comment__title'>",n+=S.render(e.user),n+="</h5>",n+="<h5 class='wall_comments__comment__content'>",n+=g.render(e.comment,t),n+="</h5>",n+="</div>",n+="<button data-id='"+e.id+"' class='wall_comments__comment__like fl btn btn-danger fa fa-heart'>"+e.likes+"</button>",r.user.reg_id!=t.getState().mUser.reg_id&&e.user.reg_id!=t.getState().mUser.reg_id||(n+="<button data-id='"+e.id+"' data-post-id='"+e.postId+"' class='wall_comments__comment__remove fl btn btn-danger fa fa-remove'></button>"),n+="<span class='wall_comments__comment__time fr time' data-time='"+e.time+"'>"+kr(e.time)+"</span>",n+="<div class='clear'></div>",n+="</div>"}},{key:"sendComment",value:function(e){$("#wall_comments form").unbind("submit").on("submit",(function(t){t.preventDefault();var r=$(this).data("post-id"),n=t.target.comment,o=n.value.trim();o&&"disabled"!=$("#wall_comments__form__submit").attr("disabled")&&($("#wall_comments__form__submit").attr("disabled","disabled"),e.getState().socket.emit("req",wr({type:"ADD_WALL_POST_COMMENT",data:{post_id:r,text:o}}),(function(e){if($("#wall_comments__form__submit").removeAttr("disabled"),n&&(n.value=""),"string"==typeof(e=Sr(e)))return alert(e)})))}))}},{key:"getPostComments",value:function(t,r){r.getState().socket.emit("req",wr({type:"WALL_GET_POST_COMMENTS",data:{post_id:t.id}}),(function(t){e.setComments(Sr(t),r)}))}},{key:"add",value:function(t,r){var n=$("#wall_comments");n&&n.hasClass("show")&&r.getState().wallCommentsPost&&r.getState().wallCommentsPost.id==t.postId&&($("#wall_comments .wall_comments__body").append(e.renderPostComment(t,r)),e.scrollToBottom(),e.registerEvents(r))}},{key:"remove",value:function(e){$("#wall_comments").hasClass("show")&&$("#wall_comments .wall_comments__comment[data-id='"+e+"']").remove()}},{key:"render",value:function(t,r){var n="<div class='modal fade' id='wall_comments' tabindex='-1' role='dialog' aria-hidden='true'>";n+="<div class='modal-dialog' role='document' style='max-width: 345px'>",n+="<div class='modal-content'>",n+="<div class='wall_comments__header modal-header label label-primary'>",n+="<div class='modal-title'>",n+="<img class='wall_comments__header__avatar' width='25' height='25' src='"+t.user.avatar+"' alt=''/>",n+="<p class='wall_comments__header__name ellipsis'>",n+=t.user.icon?"<img src='"+t.user.icon+"' class='username__icon fl' style='max-height: 16px' />":"",n+="<span style='vertical-align: middle; font-size: 0.7rem; display: inline-block; margin-left: 2px'>"+t.user.name+"</span>",n+="</p>",n+="<button data-dismiss='modal' class='btn btn-danger wall_comments__header__close'>&times;</button>",n+="</div><div class='clear'></div>",n+="</div>",n+="<div class='wall_comments__post_body_area'>",n+="<h5 style='color: "+t.user.fontColor+"' class='wall_post__body'>",n+=Kt.renderPostBody(t,r),n+="</h5>",n+="</div>",n+="<div class='wall_comments__scroll_area' id='wall_comments__scroll_area'>",n+="<div class='wall_comments__body modal-body'></div>",n+="</div>",n+="<form class='wall_comments__form' data-post-id='"+t.id+"'>",n+="<img class='wall_comments__form__face' src='/images/smile.gif' alt='smile' id='wall_comments__attach__face' width='22' height='22'/>",n+="<input type='text' id='wall_comments__form__input' class='border-color wall_comments__form__input' name='comment' placeholder='  ' autoComplete='off' dir='rtl'/>",n+="<button id='wall_comments__form__submit' class='border-color fa fa-send btn btn-primary wall_comments__form__send'></button>",n+=y.render("wall-comments","#wall_comments__form__input",r),n+="</form>",n+="</div>",n+="</div>",n+="</div>",$("#wall_comments_container").html(n),e.getPostComments(t,r),e.registerEvents(r)}}],(r=null)&&Ht(t.prototype,r),n&&Ht(t,n),e}(),Jt=r(53),Yt=r.n(Jt);function Xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Kt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.youtubeVideoClicked(t),e.videoClicked(t),e.photoClicked(t),e.soundClicked(t),e.getProfile(t),e.remove(t),e.comment(t),e.like(t),Yt.a.init({wrapAround:!0,disableScrolling:!0})}},{key:"like",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__heart").unbind("click").on("click",(function(t){t.stopPropagation();var r=$(this).parent().data("id");e.getState().socket.emit("req",wr({type:"WALL_LIKE_POST",data:{id:r}}),(function(e){if("string"==typeof(e=Sr(e)))return alert(e)}))}))}},{key:"remove",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__remove").unbind("click").on("click",(function(t){t.stopPropagation();var r=$(this).parent().data("id");e.getState().socket.emit("req",wr({type:"WALL_REMOVE_POST",data:{id:r}}),(function(e){if("string"==typeof(e=Sr(e)))return alert(e)}))}))}},{key:"comment",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__comments").unbind("click").on("click",(function(t){var r=$(this).parent().data("id"),n=e.getState().posts.filter((function(e){return e.id==r}))[0];e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_WALL_COMMENTS_POST",wallCommentsPost:e}}(n)),zt.render(n,e)}))}},{key:"getProfile",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__avatar img").unbind("click").on("click",(function(t){t.stopPropagation();var r=$(this).closest(".wall_post").data("user");xt.show(r,e)}))}},{key:"photoClicked",value:function(){$(".wall_post__body--photo").unbind("click").on("click",(function(e){e.stopPropagation(),window.open($(this).attr("src"),"_blank").focus()}))}},{key:"photoClicked",value:function(){$(".wall_post__body--photo").unbind("click").on("click",(function(e){e.stopPropagation();var t=document.getElementById("wall_media_"+$(this).attr("data-id"));t&&(t.insertAdjacentHTML("afterend",'<img class="wall_post__body--video" autoplay controls src="/uploads/wall/photos/'+$(this).attr("data-src")+'"/>'),t.remove())}))}},{key:"soundClicked",value:function(){$(".wall_post__body--sound").unbind("click").on("click",(function(e){e.stopPropagation();var t=document.getElementById("wall_media_"+$(this).attr("data-id"));t&&(t.insertAdjacentHTML("afterend",'<audio class="wall_post__body--sound" autoplay controls src="/uploads/wall/sounds/'+$(this).attr("data-src")+'"></audio>'),t.remove())}))}},{key:"videoClicked",value:function(){$(".wall_post__body--video").unbind("click").on("click",(function(e){e.stopPropagation();var t=document.getElementById("wall_media_"+$(this).attr("data-id"));t&&(t.insertAdjacentHTML("afterend",'<video class="wall_post__body--video" autoplay controls src="/uploads/wall/videos/'+$(this).attr("data-src")+'"></video>'),t.remove())}))}},{key:"youtubeVideoClicked",value:function(){$(".wall_post .yt-btn").unbind("click").on("click",(function(e){e.stopPropagation();try{var t=$(this).data("post-id"),r="https://www.youtube.com/embed/"+$(this).data("yid")+"?autoplay=1&playsinline=1",n=document.getElementById("yt-btn-"+t);n&&(n.insertAdjacentHTML("afterend",'<iframe width="95%" style="max-width:240px;" height="200" src="'+r+'" frameborder="0"></iframe><br />'),n.remove())}catch(e){}}))}},{key:"renderPostBody",value:function(e,t){switch(e.type){case"text":return"<span class='wall_post__body--text'>"+g.render(e.body,t)+"</span>";case"photo":return"<button id='wall_media_"+e.id+"' class='wall_post__body--photo btn fa fa-file-photo-o' data-id='"+e.id+"' data-src='"+e.body+"'> </button>";case"sound":return"<button id='wall_media_"+e.id+"' class='wall_post__body--sound btn fa fa-file-sound-o' data-id='"+e.id+"' data-src='"+e.body+"'> </button>";case"video":return"<button id='wall_media_"+e.id+"' class='wall_post__body--video btn fa fa-file-video-o' data-id='"+e.id+"' data-src='"+e.body+"'> </button>";case"youtube":var r="<button class='yt-btn' id='yt-btn-"+e.id+"' data-post-id='"+e.id+"' data-yid='"+e.body+"'>";return r+="<img src='images/youtube.png'/>",r+="<img style='width: 80px' alt='[YouTube]' src='https://img.youtube.com/vi/"+e.body+"/0.jpg' />",r+="</button>"}}},{key:"render",value:function(t,r){var n=t.active?"active":"",o="<div data-user='"+t.user.id+"' id='wall-post-"+t.id+"' class='wall_post "+n+"' >";return o+="<p class='wall_post__avatar'>",o+="<img class='radius' width='36' height='36' alt='' src='"+t.user.avatar+"' />",o+="</p>",o+="<div>",o+="<h5 class='wall_post__name'>",o+=S.render(t.user),o+="</h5>",o+="<h5 style='color: "+t.user.fontColor+"' class='wall_post__body'>",o+=e.renderPostBody(t,r),o+="</h5>",o+="<div class='wall_post__footer' data-id='"+t.id+"'>",o+="<button data-toggle='modal' data-target='#wall_comments' class='wall_post__body__comments fl btn btn-primary fa fa-comments'>"+t.comments+"</button>",o+="<button class='wall_post__body__heart fl btn btn-danger fa fa-heart'>"+t.likes+"</button>",o+="<button class='wall_post__body__remove fr btn btn-danger fa fa-times'></button>",o+="</div>",o+="<span class='wall_post__time fr time' data-time='"+t.time+"'>"+kr(t.time)+"</span>",o+="</div>",o+="<div class='clear'></div>",o+="</div>"}}],(r=null)&&Xt(t.prototype,r),n&&Xt(t,n),e}(),Qt=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_WALL_FACE_PICKER",isWallFacePickerOpen:e}};function Zt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var er=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.publish(t),e.fetchPosts(t),e.attachFile(t),e.openFacePicker(t),e.triggerAttachFileInput(t)}},{key:"publish",value:function(t){$("#chat__body__wall_pane .chat__body__wall_pane__form").on("submit",(function(r){r.preventDefault();var n=r.target.message,o=n.value.trim();if(o){var i={type:"text",body:o};e.send(i,n,t)}}))}},{key:"send",value:function(e,t,r){t&&(t.value=""),r.getState().socket.emit("req",wr({type:"WALL_ADD_POST",data:e}),(function(e){if("string"==typeof(e=Sr(e)))return alert(e)}))}},{key:"fetchPosts",value:function(t){t.dispatch({type:"RESET_NEW_POSTS_COUNT"}),pr.updateWallCout(t),t.getState().isPostsFetched||t.getState().socket.emit("req",wr({type:"WALL_GET_POSTS",data:{}}),(function(r){t.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_POSTS",posts:e}}(Sr(r))),t.dispatch({type:"IS_POSTS_FETCHED",isPostsFetched:!0}),e.renderPosts(t)}))}},{key:"renderPosts",value:function(e){var t=$("#chat__body__wall_pane .chat_pane__container__posts");t.html(""),e.getState().posts.forEach((function(r){t.append(Kt.render(r,e))})),Kt.registerEvents(e)}},{key:"openFacePicker",value:function(e){$("#chat__body__wall_pane__form__attach__face").on("click",(function(t){e.dispatch(Qt(!0))}))}},{key:"updatePost",value:function(e,t){var r=t.getState().posts.filter((function(t){return t.id==e}))[0];if(r){var n=window.wallPane.find("#wall-post-"+r.id);n.find(".wall_post__body__heart").text(r.likes),n.find(".wall_post__body__comments").text(r.comments)}}},{key:"removePost",value:function(e){$("#wall-post-"+e).remove()}},{key:"addPost",value:function(e,t){e&&(window.wallPane.find(".chat_pane__container__posts").prepend(Kt.render(e,t)),Kt.registerEvents(t),window.wallPane.find(".wall_post").length>t.getState().settings.wall_msg_count&&window.wallPane.find(".wall_post:nth-child("+(t.getState().settings.wall_msg_count+1)+")").remove())}},{key:"setPosts",value:function(e){if(pr.updateWallCout(e),"wall"==e.getState().currentPane&&!window.wallPane.find(".chat_pane__container__posts").length){$(".wall_post").unbind("click");var t=window.wallPane.find(".chat_pane__container__posts");t.html(""),e.getState().posts.forEach((function(r){t.append(Kt.render(r,e))})),Kt.registerEvents(e),document.querySelector("#chat__body__wall_pane .chat_pane__container").scrollTo({top:0}),window.wallPane.find("img").on("contextmenu",(function(){return!1}))}}},{key:"triggerAttachFileInput",value:function(){window.wallPane.find(".chat__body__wall_pane__form__attach").unbind("click").on("click",(function(e){var t=document.getElementById("chat__body__wall_pane__form__file");t&&t.click()}))}},{key:"attachFile",value:function(t){window.wallPane.find("#chat__body__wall_pane__form__file").unbind("change").on("change",(function(r){var n=r.target.files[0],o=new FormData;o.append("file",n),t.getState().socket.emit("req",wr({type:"WALL_BEFORE_SEND_MEDIA",data:{}}),(function(r){if("string"==typeof(r=Sr(r)))return alert(r);if(!1===r.error){o.append("hash",r.hash),o.append("id",r.user_id);var i=null,a=n.type.split("/")[0];if("image"==a&&(i="/wall_upload_photo_post"),"audio"==a&&(i="/wall_upload_sound_post"),"video"==a&&(i="/wall_upload_video_post"),!i)return;window.wallPane.find(".chat__body__wall_pane__form__attach").hide(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").show();var s=$(".chat__body__wall_pane__form__loading_percent");G.a.post(i,o,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);s.text(t<10?"0"+t:t)}}).then((function(r){!1===r.data.error&&e.send({type:r.data.type,body:r.data.body},null,t),window.wallPane.find(".chat__body__wall_pane__form__attach").show(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").hide(),s.text("00")})).catch((function(e){window.wallPane.find(".chat__body__wall_pane__form__attach").show(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").hide(),s.text("00")}))}}))}))}},{key:"update",value:function(e){var t=e.getState().settings.wall_banner_msg?e.getState().settings.wall_banner_msg:"";window.wallPane.find(".chat_pane__container__banner").css("background",e.getState().settings.wall_banner_background_color),window.wallPane.find(".chat_pane__container__banner").css("color",e.getState().settings.wall_banner_font_color),window.wallPane.find(".chat_pane__container__banner p").text(t),e.getState().settings.show_wall_banner?window.wallPane.find(".chat_pane__container__banner").show():window.wallPane.find(".chat_pane__container__banner").hide()}},{key:"render",value:function(e){var t=e.getState().settings.wall_banner_msg?e.getState().settings.wall_banner_msg:"",r="<div id='chat__body__wall_pane' class='chat_pane' style='background: "+Cr(e.getState().settings,!0)+"'>";return r+=f.render("  ",!0),r+="<div class='chat_pane__container border'>",r+="<div class='chat_pane__container__banner' style='background: "+e.getState().settings.wall_banner_background_color+"; color: "+e.getState().settings.wall_banner_font_color+"'>",r+="<p>"+t+"</p>",r+="</div>",r+="<div class='chat_pane__container__posts'></div>",r+="</div>",r+="<form class='chat__body__wall_pane__form'>",r+="<button type='button' class='border-color btn btn-primary fa fa-share-alt chat__body__wall_pane__form__attach'></button>",r+="<span><span class='chat__body__wall_pane__form__loading_percent'>00</span><img class='chat__body__wall_pane__form__loader' style='display: none' src='/images/loader.gif' width='24' height='24' alt='' /></span>",r+="<img class='chat__body__wall_pane__form__face' src='/images/smile.gif' alt='smile' id='chat__body__wall_pane__form__attach__face' width='22' height='22' />",r+="<input type='text' id='chat__body__wall_pane__form__input' class='border-color chat__body__wall_pane__form__input' name='message' placeholder='  ' autoComplete='off' dir='rtl'/>",r+="<button class='border-color fa fa-send btn btn-primary chat__body__wall_pane__form__send'></button>",r+="<input id='chat__body__wall_pane__form__file' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",r+=y.render("wall","#chat__body__wall_pane__form__input",e),r+="</form>",r+="</div>"}}],(r=null)&&Zt(t.prototype,r),n&&Zt(t,n),e}();function tr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var rr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(e){}},{key:"fetchPosts",value:function(e){e.getState().socket.emit("req",wr({type:"WALL_CREATOR_GET_POSTS",data:{}}),(function(e){e=Sr(e);var t=$(".chat_pane__container__podium-users"),r=$(".chat_pane__container__podium-grades"),n=$("#chat__body__wall_creator_pane .chat_pane__container__posts"),o=e.slice(0,3),i=e.slice(3);o.forEach((function(e,n){e.avatar&&t.find(".chat_pane__container__podium-user.grade-"+(n+1)+" .avatar").attr("src","/uploads/avatars/sm/"+e.avatar),e.decoration=e.decoration?e.decoration:e.name,t.find(".chat_pane__container__podium-user.grade-"+(n+1)+" .name").text(e.decoration),r.find(".chat_pane__container__podium-grade.grade-"+(n+1)+" .rank").text(e["count( wall.user_id )"])})),n.html(""),i.forEach((function(e,t){e.decoration=e.decoration?e.decoration:e.name;var r="/images/none.png";e.avatar&&(r="/uploads/avatars/sm/"+e.avatar),n.append("<div class='chat_pane__container__post'><span class='grade'>"+(t+4)+"</span><img class='avatar' width='40' height='40' src='"+r+"' /><span class='name'>"+e.decoration+"</span><span class='rank'>"+e["count( wall.user_id )"]+"</span></div>")}))}))}},{key:"setPosts",value:function(t){e.fetchPosts(t)}},{key:"render",value:function(e){var t="<div id='chat__body__wall_creator_pane' class='chat_pane' style='background: "+Cr(e.getState().settings,!0)+"'>";return t+=f.render(" ",!0),t+="<div class='chat_pane__container border'>",t+="<div class='chat_pane__container__podium'>",t+="<div class='chat_pane__container__podium-users'>",t+="<span class='chat_pane__container__podium-user grade-2'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/silver_grade.png' /><span class='name'></span></span>",t+="<span class='chat_pane__container__podium-user grade-1'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/gold_grade.png' /><img class='crown' width='40' height='40' src='/images/crown.png' /><span class='name'></span></span>",t+="<span class='chat_pane__container__podium-user grade-3'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/bronz_grade.png' /><span class='name'></span></span>",t+="</div>",t+="<div class='chat_pane__container__podium-grades'>",t+="<span class='chat_pane__container__podium-grade  grade-2'><span class='grade'>2</span><span class='rank'>0</span></span>",t+="<span class='chat_pane__container__podium-grade  grade-1'><span class='grade'>1</span><span class='rank'>0</span></span>",t+="<span class='chat_pane__container__podium-grade  grade-3'><span class='grade'>3</span><span class='rank'>0</span></span>",t+="</div>",t+="</div>",t+="<div class='chat_pane__container__posts'></div>",t+="</div>",t+="</div>"}}],(r=null)&&tr(t.prototype,r),n&&tr(t,n),e}();function nr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var or=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.openChat(t),e.remove(t)}},{key:"openChat",value:function(e){$("#chat__body__conversations_pane .conversations_item").unbind("click").on("click",(function(t){var r=e.getState().currentConversation;$(this).removeClass("unread");var n=$(this).data("id"),o=e.getState().conversations.filter((function(e){return e.id==n}))[0];o&&o.him&&(r&&r.id==o.id||(e.dispatch(E(o.him)),Se.render(e)))}))}},{key:"remove",value:function(e){$("#chat__body__conversations_pane .conversations_item__remove").unbind("click").on("click",(function(t){t.stopPropagation();var r=$(this).closest(".conversations_item").data("id"),n=e.getState().conversations.filter((function(e){return e.id==r}))[0];e.getState().currentConversation&&e.getState().currentConversation.id==n.id&&(e.dispatch(E(null)),$("#chat_box_container").html("")),e.dispatch(T(n.id)),$(this).closest(".conversations_item").remove(),pr.updateConversationsCount(e)}))}},{key:"renderLastMessage",value:function(e,t){var r=e.messages.length;if(r){var n=e.messages[r-1];if("text"==n.type)return g.render(n.body,t);if("photo"==n.type)return"<span class='fa fa-camera'></span>";if("sound"==n.type)return"<span class='fa fa-microphone'></span>";if("video"==n.type)return"<span class='fa fa-video-camera'></span>";if("youtube"==n.type)return"<span class='fa fa-youtube'></span>"}}},{key:"render",value:function(t,r){var n=t.seen?"":"unread",o="<div data-id='"+t.id+"' class='conversations_item "+n+" "+t.him.state+"' >";return o+="<div class='conversations_item__holder fl'>",o+="<p class='conversations_item__avatar'><img class='radius' width='30' height='30' src='"+t.him.avatar+"' /></p>",o+="<div>",o+="<h5 class='conversations_item__name'>",o+=S.render(t.him),o+="</h5>",o+="<h5 style='color: "+t.him.fontColor+"' class='conversations_item__last_message'>",o+=e.renderLastMessage(t,r),o+="</h5>",o+="</div>",o+="</div>",o+="<button class='conversations_item__remove btn btn-danger fa fa-times fr'></button>",o+="<div class='clear'></div>",o+="</div>"}}],(r=null)&&nr(t.prototype,r),n&&nr(t,n),e}();function ir(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ar=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(e){}},{key:"renderConversations",value:function(e){var t=$("#chat__body__conversations_pane .chat_pane__container");t.html(""),e.getState().conversations.filter((function(t){return!e.getState().ignoredUsers.includes(t.him.id)})).forEach((function(r){t.append(or.render(r,e))})),or.registerEvents(e)}},{key:"render",value:function(t){var r="<div id='chat__body__conversations_pane' class='chat_pane' style='background: "+Cr(t.getState().settings,!0)+"'>";return r+=f.render(" "),r+="<div class='chat_pane__container border'>"+e.renderConversations(t)+"</div>",r+="</div>"}}],(r=null)&&ir(t.prototype,r),n&&ir(t,n),e}();function sr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var cr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onClick(t),e.trustUser(t)}},{key:"onClick",value:function(e){$(".notification").unbind("click").on("click",(function(t){var r=$(this).closest(".notification").data("user-id");xt.show(r,e)}))}},{key:"trustUser",value:function(e){$(".notification__message__body__trust_user").unbind("click").on("click",(function(t){var r=this;t.stopPropagation(),e.getState().socket.emit("req",wr({type:"TRUST_USER",data:{id:$(this).data("user-id"),name:$(this).data("user-name"),decoration:$(this).data("user-decoration")}}),(function(t){if(t=Sr(t),$(r).closest(".popup").click(),"string"==typeof t)return alert(t);if(t&&t.message&&alert(t.message),!t.error){var n=$(r).data("user-id");e.dispatch(Y(n)),$("button[data-user-id='"+n+"']").remove()}}))}))}},{key:"renderMessage",value:function(e,t){switch(e.type){case"like":return"<span>  <span style='color: red' class='fa fa-heart'></span></span>";case"gift":return"<span>  <img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"remove_gift":return"<span>  <img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"room_excpel":case"change_room":return"<p dir='rtl'>"+e.message+" <span>"+jt.render(e.room,!0,t)+"</span></p>";case"post_comment_like":case"post_commented":return"<p dir='rtl'>"+e.message+" <span><p class='notification__message__body'>"+e.comment+"</p></span></p>";case"login_banned":var r="<p>"+e.data.name+" ---- "+e.data.decoration+"</p>";return r+="<p>"+e.data.role+"</p>",r+="<p>"+e.data.ip+" <img src='/images/flags/"+e.data.country.toLowerCase()+".png' /></p>",r+="<p dir='rtl'>"+e.data.device+"</p>",e.data.isGuest||e.data.is_trusted||(r+="<p style='text-align: center'><button data-user-name='"+e.data.name+"' data-user-decoration='"+e.data.decoration+"' data-user-id='"+e.data.user_id+"' class='notification__message__body__trust_user btn btn-success'> </button></p>"),r;case"world_filter_notification":return"<p dir='rtl'>"+e.word.word+" <span><p class='popup__message__body'>"+e.word.text+"</p></span></p>";case"photo_like":return;default:return"<span>"+g.render(e.message,t)+"</span>"}}},{key:"render",value:function(t,r){var n=t.user?t.user.id:"",o=t.id,i="<div data-id='"+t.id+"' data-user-id='"+n+"' class='notification'>";return i+="<p class='notification__title label label-primary'>"+t.title+"</p>",t.user&&(i+="<div class='notification__sender'>",i+="<img src='"+t.user.avatar+"' width='24' height='24' class='notification__sender__avatar' />",i+="<p class='notification__sender__name'>"+S.render(t.user)+"</p>",i+="</div>"),i+="<div class='notification__message'>",i+=e.renderMessage(t,r),i+="</div>",i+="<span class='notification__time fr time' data-time='"+o+"'>"+kr(o)+"</span>",i+="</div>"}}],(r=null)&&sr(t.prototype,r),n&&sr(t,n),e}();function ur(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var lr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.close(t)}},{key:"close",value:function(e){$(".chat__body__notifications-pane__back button").unbind("click").on("click",(function(t){e.dispatch(n("settings")),pr.togglePane(e)}))}},{key:"setNotifications",value:function(e){var t=$("#chat__body__notifications-pane .chat_pane__container");t.html(""),e.getState().popups.forEach((function(r){t.prepend(cr.render(r,e))})),cr.registerEvents(e)}},{key:"render",value:function(e){var t="<div id='chat__body__notifications-pane' class='chat_pane' style='background: "+Cr(e.getState().settings,!0)+"'>";return t+=f.render(""),t+="<p class='chat__body__notifications-pane__back'>",t+="<button class='btn btn-success fa fa-arrow-left'></button>",t+="</p>",t+="<div class='chat_pane__container border'></div>",t+="</div>"}}],(r=null)&&ur(t.prototype,r),o&&ur(t,o),e}();function dr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var pr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.updateUsersCout(t),window.chatFooter.find("#chat__footer__menu__users_item").on("click",(function(r){"users"!=t.getState().currentPane&&(t.dispatch(n("users")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__conversations_item").on("click",(function(r){"conversations"!=t.getState().currentPane&&(t.dispatch(n("conversations")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__rooms_item").on("click",(function(r){"rooms"!=t.getState().currentPane&&(t.dispatch(n("rooms")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__wall_item").on("click",(function(r){"wall"!=t.getState().currentPane&&(t.dispatch(n("wall")),t.dispatch({type:"RESET_NEW_POSTS_COUNT"}),e.updateWallCout(t),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__settings_item").on("click",(function(r){"settings"!=t.getState().currentPane&&(t.dispatch(n("settings")),e.togglePane(t),ae.setLockedMics(t))})),window.chatFooter.find("#chat__footer__menu__live_item").on("click",(function(r){Se.close(t),"live"!=t.getState().currentPane&&(t.dispatch(n("live")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__wall_creator_item").on("click",(function(r){"wall-creator"!=t.getState().currentPane&&(t.dispatch(n("wall-creator")),e.togglePane(t))}))}},{key:"togglePane",value:function(e,t){if($(".chat_pane").hide(),me.closeModals(),!t)return"users"==e.getState().currentPane?(window.usersPane.show(),Promise.resolve().then((function(){return rt.setUsers(e)}))):"conversations"==e.getState().currentPane?(window.conversationsPane.show(),ar.renderConversations(e)):"rooms"==e.getState().currentPane?(window.roomsPane.show(),Gt.setRooms(e)):"wall"==e.getState().currentPane?(window.wallPane.show(),er.setPosts(e)):"settings"==e.getState().currentPane?window.settingsPane.show():"ignored_users"==e.getState().currentPane?(window.ignoredUsersPane.show(),ot.setUsers(e)):"notifications"==e.getState().currentPane?(window.notificationsPane.show(),lr.setNotifications(e)):"live"==e.getState().currentPane?$("#chat__body__live-pane").show():"wall-creator"==e.getState().currentPane?(window.wallCreatorPane.show(),rr.setPosts(e)):void 0}},{key:"updateUsersCout",value:function(e){window.chatFooter.find("#chat__footer__menu__users_item .count").text(e.getState().users.length-e.getState().ignoredUsers.length)}},{key:"updateConversationsCount",value:function(e){var t=e.getState().conversations.filter((function(e){return 0==e.seen})).length;t>0?(window.chatFooter.find("#chat__footer__menu__conversations_item").addClass("unread"),window.chatFooter.find("#chat__footer__menu__conversations_item .count").text(t)):(window.chatFooter.find("#chat__footer__menu__conversations_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__conversations_item .count").text(0))}},{key:"updateRoomsCount",value:function(e){$("#chat__footer__menu__rooms_item .count").text(e.getState().rooms.length)}},{key:"updateWallCout",value:function(e){var t=e.getState().newPostsCount;t?window.chatFooter.find("#chat__footer__menu__wall_item").addClass("unread"):window.chatFooter.find("#chat__footer__menu__wall_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__wall_item .count").text(t)}},{key:"toggleTV",value:function(e){e.getState().settings.tv_box_enabled?window.chatFooter.find("#chat__footer__menu__tv_item").show():(window.chatFooter.find("#chat__footer__menu__tv_item").hide(),d.close(e))}},{key:"render",value:function(){return"<div id='chat__footer'><ul id='chat__footer__menu'><li id='chat__footer__menu__users_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-user'></span><span class='badge count'>0</span></li><li id='chat__footer__menu__conversations_item' class='border border-color btn-primary chat__footer__menu__item' ><span class='fa fa-comment'></span><span class='badge count'>0</span></li><li id='chat__footer__menu__rooms_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-users'></span><span><span class='badge count'>0</span></span></li><li id='chat__footer__menu__wall_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-commenting-o'></span><span class='badge count'>0</span><span></span></li><li id='chat__footer__menu__settings_item' class='border border-color btn-primary chat__footer__menu__item'><span></span></li><li id='chat__footer__menu__wall_creator_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-area-chart'></span></li></ul></div>"}}],(r=null)&&dr(t.prototype,r),o&&dr(t,o),e}();function fr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var hr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"registerEvents",value:function(t){e.hideAllPanes(t)}},{key:"tagUser",value:function(e,t){var r=t.getState().users.filter((function(t){return t.id==e}))[0];r&&r.room&&t.getState().mUser.room&&t.getState().mUser.room.id==r.room.id&&($("#chat__body__message-input__target").text(r.name),window.taggedUser=e)}},{key:"hideAllPanes",value:function(e){window.publicMessagesContainer&&window.publicMessagesContainer.on("click",(function(t){"users"!=e.getState().currentPane&&(e.dispatch(n(null)),pr.togglePane(e,!0))}))}},{key:"scrollToBottom",value:function(){window.publicMessagesContainer&&window.publicMessagesContainer.animate({scrollTop:window.publicMessagesContainer.prop("scrollHeight")},100);var t=$("#chat__body__messages_container__messages");t&&t.animate({scrollTop:t.prop("scrollHeight")},100),e.scrollToBottomDivider()}},{key:"scrollToBottomDivider",value:function(){window.publicMessagesContainerDivider&&window.publicMessagesContainerDivider.animate({scrollTop:window.publicMessagesContainerDivider.prop("scrollHeight")},100)}},{key:"setBacground",value:function(e){e?$("#chat__body--bg").attr("src",e).show():$("#chat__body--bg").removeAttr("src").hide()}},{key:"render",value:function(){return"<div id='chat__body__messages_container'><div id='chat__body__messages_container__messages'></div><div id='chat__body__messages_container__videos'></div></div><div id='chat__body__messages_container__divider'></div>"}}],(r=null)&&fr(t.prototype,r),o&&fr(t,o),e}();function mr(e){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _r=r(58),gr=r(82);function vr(){return"undefined"!=typeof Storage}function yr(e,t){vr()?localStorage.setItem(e,t):function(e,t,r){var n=new Date;n.setTime(n.getTime()+287712e5);var o="expires="+n.toUTCString();document.cookie=e+"="+(i=t,encodeURIComponent(i).split("'").join("%27")+"; ")+o;var i}(e,t)}function br(e){if(vr()){var t=localStorage.getItem(e);return"null"!=t&&null!=t||(t=""),t}return function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "==o.charAt(0);)o=o.substring(1);if(-1!=o.indexOf(t))return i=o.substring(t.length,o.length),decodeURIComponent(i)}var i;return""}(e)}function wr(e,t){if(!t)return e;try{return _r.AES.encrypt(JSON.stringify(e),gr.aes_secret).toString()}catch(e){return null}}function Sr(e,t){if(!t){try{e=JSON.stringify(e).replaceAll("","")}catch(t){e=JSON.stringify(e).replace("","").replace("","").replace("","").replace("","").replace("","")}return e=JSON.parse(e)}try{var r=_r.AES.decrypt(e,gr.aes_secret).toString(_r.enc.Utf8);return JSON.parse(r)}catch(e){return""}}function kr(e){var t=Math.round(Math.abs(Date.now()-e)/1e3);return t<59?"":t/60<60?parseInt(t/60)+"":t/3600<24?parseInt(t/3600)+"":t/86400<30?parseInt(t/86400)+"":t/2592e3<12?parseInt(t/2592e3)+"":parseInt(t/31104e3)+""}function Cr(e,t){return t?e&&e.show_chat_background_on_windows?e.chat_background?e.window_color+" url(/uploads/"+e.chat_background+")":e.window_color+" url(/images/main_background.png)":e.window_color:e&&e.show_chat_background?e.chat_background?e.background_color+" url(/uploads/"+e.chat_background+")":e.background_color+" url(/images/main_background.png)":e.background_color}function Er(e,t){if(settings){for(var r=document.getElementsByTagName("style"),n=0;n<r.length;n++);var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style"),a=".btn-primary { background-color: "+settings.btn_color+"; }.btn-primary:hover, .btn-primary:disabled, .btn-primary:active { background-color: "+settings.btn_color+"AA !important; }.border-color { border-color: "+settings.border_color+" !important; }.react-tabs__tab { color: "+settings.btn_color+" !important; }.color-primary { color: "+settings.btn_color+" !important; }.users-count-label__right__arrow-left { border-right-color: "+settings.btn_color+" !important; }.users-count-label__left__arrow-right { border-left-color: "+settings.btn_color+" !important; }.users-count-label { background-color: "+function(e,t){var r=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),o=parseInt(e.substring(5,7),16);r=parseInt(r*(100+t)/100),n=parseInt(n*(100+t)/100),o=parseInt(o*(100+t)/100),n=n<255?n:255,o=o<255?o:255;var i=1==(r=r<255?r:255).toString(16).length?"0"+r.toString(16):r.toString(16),a=1==n.toString(16).length?"0"+n.toString(16):n.toString(16),s=1==o.toString(16).length?"0"+o.toString(16):o.toString(16);return"#"+i+a+s}(settings.btn_color,15)+" !important; }.label-primary { background-color: "+settings.btn_color+"; }";i.type="text/css",i.styleSheet?i.styleSheet.cssText=a:i.appendChild(document.createTextNode(a)),o.appendChild(i)}}function Tr(){document.body.style.zoom="0.975";var e=Pr()/document.body.style.zoom,t=document.getElementById("mic-speakers"),r=document.getElementById("chat__body__messages_container__divider"),n=t?t.clientHeight:0,o=r?r.clientHeight:0,i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style"),s=document.querySelector("#login .login_wrapper"),c="#chat__body { height: calc("+e+"px - 38px); }#chat, #app { height: "+e+"px; }#online_users { height: "+(e-((s?s.clientHeight:0)-3))+"px; }#user_profile { max-height: "+e+"px; }#chat__body__messages_container__videos { height: calc("+e+"px - 32px - 40px - "+n+"px); }#chat__body__messages_container { height: calc("+e+"px - 32px - 40px - "+(n+o)+"px); }#chat__body__messages_container__videos .mic-video {height: calc(("+e+"px - 32px - 40px - "+n+"px) / 2);}.user_profile__scroll_area { max-height: "+91*e/100+"px; }.reveal_names_body { height: "+65*e/100+"px; }";a.type="text/css",a.styleSheet?a.styleSheet.cssText=c:a.appendChild(document.createTextNode(c)),i.appendChild(a),$("#chat__body__messages_container__divider").css("height","30vh"),o=(r=document.getElementById("chat__body__messages_container__divider"))?r.clientHeight:0,document.getElementById("chat__body__messages_container").style.height="calc("+e+"px - 32px - 40px - "+(n+o)+"px)",hr.scrollToBottom();var u=document.getElementById("chat_box__body");u&&(u.scrollTop=u.scrollHeight-u.clientHeight);var l=$(".winner-home").prop("clientHeight"),d=Math.round(Or(50,l)),p=Math.round(Or(40,l)),f=Math.round(Or(28,l));if($(".winner-home .stack").css("border-width",d),$("#red-dice, #green-dice, #yellow-dice, #blue-dice").css("width",p).css("height",p),$(".player-room").css("gap",f),document.body.clientWidth<750){$(".ludo-board").css("width","100vw").css("height","100vw");var h=Math.round(Or(17,l));$(".player").css("width",h).css("height",h)}else{$(".ludo-board").css("width","80vh").css("height","80vh");var m=Math.round(Or(20,l));$(".player").css("width",m).css("height",m)}document.body.clientWidth>900?$("main").css("padding-top","10vh"):$("main").css("padding-top","0"),window.removeEventListener("resize",Tr),window.addEventListener("resize",Tr)}function Pr(){return document.documentElement.clientHeight}function Ar(){return location.host.replace("www.","")}function Rr(e){if(!e)return 0;var t=new Date,r=new Date(e),n=Math.abs(r-t),o=Math.ceil(n/864e5);return o>0&&(o-=1),o}function Or(e,t){return(e/100*t).toFixed(2)}function xr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Mr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,r,n;return t=e,n=[{key:"getIcon",value:function(e){return e.getState().settings.default_avatar?"/uploads/avatars/"+e.getState().settings.default_avatar:"/images/none.png"}},{key:"render",value:function(t){var r=t.getState().settings.chat_name?t.getState().settings.chat_name:"",n="<h1 id='login-header' class='border-color label label-primary'>";return n+="<a class='label label-primary login-header__label' href='/'>",n+="<img src='"+e.getIcon(t)+"' width='28' height='30' />",n+="<span class='login-header__title'>"+r+"</span>",n+="<button class='btn fr btn-success fa fa-refresh login-header__refresh'></button>",n+="</a>",n+="</h1>"}}],(r=null)&&xr(t.prototype,r),n&&xr(t,n),e}();function Dr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ir=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"getSrc",value:function(e){return e.getState().settings.banner_img?"/uploads/"+e.getState().settings.banner_img:"/images/banner.png"}},{key:"render",value:function(t){var r="<div id='login-banner' class='rainbow'>";return r+="<img src='"+e.getSrc(t)+"' alt='banner' class='login-banner__img' />",r+="</div>"}}],(r=null)&&Dr(t.prototype,r),n&&Dr(t,n),e}();function Ur(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Br=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"render",value:function(){return"<div id='login-btn-holder'><a href='https://www.facebook.com/' class='login-btn-holder__btn fa fa-facebook btn btn-primary'>  </a><a href='/' class='login-btn-holder__btn fa fa-music btn btn-default'>  </a><a href='/' class='login-btn-holder__btn fa fa-star-half-o btn btn-primary'>  </a><a href='/' class='login-btn-holder__btn fa fa-user btn btn-default'>  </a></div>"}}],(r=null)&&Ur(t.prototype,r),n&&Ur(t,n),e}(),Lr=function(e,t){return{type:"UPDATE_ROOM_BACKGROUND",id:e,background:t}},jr=function(e,t,r){return{type:"HANDLE_USER_CHANGE_ROOM",userId:e,oldRoomId:t,newRoomId:r}},Fr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_GIFTS",gifts:e}},$r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_FACES",faces:e}},Nr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"heart";return{type:"SET_FLOATING_PARTICLES",particleType:e}};function qr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Gr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.toggle(t)}},{key:"toggle",value:function(t){$("#radio-container img").unbind("click").on("click",(function(r){$("#radio-stream").length?(e.stopRadio(),$("#radio-container .radio-container__off").removeClass("active"),$("#radio-container .radio-container__on").addClass("active")):(e.playRadio(t),$("#radio-container .radio-container__off").addClass("active"),$("#radio-container .radio-container__on").removeClass("active"))}))}},{key:"update",value:function(t){var r=$("#radio-container");r.find("#radio-stream").attr("src")!=t.getState().settings.radio_stream_url&&r.find("#radio-stream").attr("src",t.getState().settings.radio_stream_url);var n=t.getState().settings.radio_stream_off_img?"/uploads/"+t.getState().settings.radio_stream_off_img:"/images/radio_banner_off.jpeg";r.find(".radio-container__off").attr("src",n);var o=t.getState().settings.radio_stream_on_img?"/uploads/"+t.getState().settings.radio_stream_on_img:"/images/radio_banner_on.jpeg";r.find(".radio-container__on").attr("src",o),t.getState().settings.is_radio_stream_enabled?$("#radio-container").show():(e.stopRadio(),$("#radio-container .radio-container__off").removeClass("active"),$("#radio-container .radio-container__on").addClass("active"),$("#radio-container").hide()),e.toggle(t)}},{key:"playRadio",value:function(e){$("#radio-container").append('<audio id="radio-stream" src="'+e.getState().settings.radio_stream_url+'" width="0" height="0" />'),$("#radio-stream")[0].play()}},{key:"stopRadio",value:function(){$("#radio-stream")[0]&&$("#radio-stream")[0].remove()}},{key:"render",value:function(e){var t=e.getState().settings.is_radio_stream_enabled?"block":"none",r=e.getState().settings.radio_stream_on_img?"/uploads/"+e.getState().settings.radio_stream_on_img:"/images/radio_banner_on.jpeg",n="<div id='radio-container' style='display: "+t+"'>";return n+="<img class='radio-container__off' src='"+(e.getState().settings.radio_stream_off_img?"/uploads/"+e.getState().settings.radio_stream_off_img:"/images/radio_banner_off.jpeg")+"' alt=''/>",n+="<img class='radio-container__on active' src='"+r+"' alt=''/>",n+="</div>"}}],(r=null)&&qr(t.prototype,r),n&&qr(t,n),e}();function Vr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(e){}},{key:"render",value:function(e){var t="<div id='chat__body__live-pane' class='chat_pane' style='background: #FFFFFF'>";return t+=f.render(" "),t+="<div class='chat_pane__container border'>",t+=Gr.render(e),t+="<div id='chat__body__live-pane__tv' class='fl'>",t+="<iframe src='"+d.parseURL(e.getState().settings.tv_box_url)+"' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' ></iframe>",t+="</div>",t+="</div>",t+="</div>"}}],(r=null)&&Vr(t.prototype,r),n&&Vr(t,n),e}();function Hr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var zr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"render",value:function(e){var t="<div id='chat__body' style='background: "+Cr(e.getState().settings)+"'>";return t+="<img id='chat__body--bg' />",window.is_mic_enabled&&(t+=me.render(e)),t+=hr.render(),t+=Bt.render(e),t+=rt.render(e),t+=ar.render(e),t+=Gt.render(e),t+=er.render(e),t+=rr.render(e),t+=ae.render(e),t+=ot.render(e),t+=Wr.render(e),t+=lr.render(e),t+="<audio style='display: none;' id='private-bip'>",t+="<source src='private-bip.mp3' type='audio/mpeg'>",t+="<source src='private-bip.ogg' type='audio/ogg'>",t+="</audio>",t+="</div>"}}],(r=null)&&Hr(t.prototype,r),n&&Hr(t,n),e}();function Jr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Yr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onParticleLoaded(t)}},{key:"getRandomInt",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"insertParticles",value:function(e){if($("#floating_particles"))for(var t=0;t<2;t++)"heart"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_heart1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_heart2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_heart3.png" width="50" height="50" alt="" />')),"gift"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_gift1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_gift2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_gift3.png" width="50" height="50" alt="" />')),"ad"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_ad1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_ad2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_ad3.png" width="50" height="50" alt="" />')),"rose"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_rose1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_rose2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_rose3.png" width="50" height="50" alt="" />'))}},{key:"onParticleLoaded",value:function(t){$(".floating_particles__item").unbind("load").on("load",(function(r){e.insertParticles(t),$(".floating_particles__item").toArray().forEach((function(r){var n=$("body").width()-100,o=e.getRandomInt(50,150);try{$(r).animate({lef:e.getRandomInt(0,n),right:e.getRandomInt(0,n),bottom:e.getRandomInt(30,500),width:o,height:o},e.getRandomInt(1e3,3e3),(function(){$(r).animate({top:"-100%",opacity:0},e.getRandomInt(5e3,15e3),(function(){try{$(r).unbind("load").remove()}catch(e){}t.getState().particleType&&t.dispatch(Nr(null))}))}))}catch(e){}}))}))}},{key:"toggle",value:function(t){t.getState().settings.disable_floating_particles||($("#floating_particles .floating_particles__item").remove(),$("#floating_particles").append("<img class='floating_particles__item' src='/images/floating_"+t.getState().particleType+"1.png' width='50' height='50' alt='' />"),e.onParticleLoaded(t))}},{key:"render",value:function(e){var t="<div id='floating_particles'>";return e.getState().settings.disable_floating_particles||(t+="<img class='floating_particles__item' src='/images/floating_rose1.png' width='50' height='50' alt='' />"),t+="</div>"}}],(r=null)&&Jr(t.prototype,r),n&&Jr(t,n),e}();function Xr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Kr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(e){}},{key:"append",value:function(e){if(e.royalLogin){var t=Math.floor(4*Math.random())+1,r="<div class='royal_login_item' id='royal_login_item--"+e.reg_id+"' style='background-image: url(/images/royal_login_bg"+t+".png)'>";r+="<img class='royal_login_item__img' src='"+e.avatar+"'/>",r+="<p  class='royal_login_item__name'>"+S.render(e)+"</p>",r+="</div>",$("#royal_login_container").append(r),$("#royal_login_item--"+e.reg_id).animate({right:0},500,"linear",(function(){setTimeout((function(){$("#royal_login_item--"+e.reg_id).animate({right:-300},500,"linear",(function(){$("#royal_login_item--"+e.reg_id).remove()}))}),3e3)}))}}}],(r=null)&&Xr(t.prototype,r),n&&Xr(t,n),e}();function Qr(e,t){switch(this.store=t,e.type){case"NEW_USER":return this.newUser(e.data.user);case"USER_OUT":return this.userOut(e.data.user,e.data.force);case"NOTIFY_USER_OUT":return this.notifyUserOut(e.data.user);default:return null}}Qr.prototype.newUser=function(e){var t=this.store.getState().users.filter((function(t){return t.reg_id==e.reg_id}))[0];t&&t.reg_id&&this.store.dispatch(L(t)),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_USER",user:e}}(e)),this.store.dispatch({type:"REMOVE_OLD_USER_FROM_ROOM",oldSocketId:e.oldSocketId}),this.store.dispatch(jr(e.id,null,e.room.id)),e.room&&this.store.getState().mUser.room&&e.room.id==this.store.getState().mUser.room.id&&!e.isMuted&&Dt.insert({icon:e.avatar,title:e.name,user:e,content:"    ",room:e.room,type:"JOIN_LEAVE"},this.store),pr.updateUsersCout(this.store),Gt.setRooms(this.store),rt.setUsers(this.store),Kr.append(e)},Qr.prototype.userOut=function(e,t){if(window.ludoPlayers&&window.ludoPlayers.length){var r=window.ludoPlayers.filter((function(t){return t.user_id==e.id}))[0];r&&re.userOut(this.store,r.color)}window.taggedUser&&window.taggedUser==e.id&&(window.taggedUser=null,$("#chat__body__message-input__target").text("")),this.store.getState().settings.is_fixed_login_enabled&&e.reg_id&&!t||(this.store.dispatch(L(e)),this.store.dispatch(A(e.id)),pr.updateUsersCout(this.store),this.store.getState().requestedUser&&this.store.getState().requestedUser.id==e.id&&(this.store.dispatch(I(null)),$("#user_profile").modal("hide")),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==e.id&&(this.store.dispatch(E(null)),$("#chat_box_container").html("")),this.store.dispatch(T(e.id)),pr.updateConversationsCount(this.store),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==e.id&&this.store.dispatch(E(null)),this.store.getState().requestedUser&&this.store.getState().requestedUser.id==e.id&&this.store.dispatch(I(null)),e.room&&this.store.dispatch(jr(e.id,e.room.id,null)),this.notifyUserOut(e),Gt.setRooms(this.store),rt.setUsers(this.store))},Qr.prototype.notifyUserOut=function(e){if(e.room&&this.store.getState().mUser.room&&e.room.id==this.store.getState().mUser.room.id){var t=null;(t=e.isExcpeled?"(   )":e.isBanned?"(    )":"(   )")&&!this.store.getState().ignoredUsers.includes(e.id)&&Dt.insert({icon:e.avatar,title:e.name,user:e,content:t,type:"JOIN_LEAVE"},this.store);var r=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id==e.id}))[0];r&&(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id!=e.id})),me.removeUserFromMic(this.store,e,r.micId,!1,!0));var n=$("#camera__box-"+e.id);n&&Qe.close(this.store,n)}};var Zr=Qr;function en(e,t){switch(this.store=t,e.type){case"USER_JOINDED_ROOM":return this.userJoinedRoom(e.data);case"USER_EXPELED_FROM_ROOM":return this.userExcpeledFromRoom(e.data);case"USER_LEAVED_ROOM":return this.userLeavedRoom(e.data);case"PROFILE_ACTION_CHANGE_ROOM":return this.changeRoom(e.data);case"NEW_ROOM_CREATED":return this.addRoom(e.data);case"ROOMS_UPDATED":return this.updateRooms(e.data);case"ADMIN_ROOM_BACKGROUND_UPDATED":return this.updateRoomBackground(e.data);case"ADMIN_ROOM_BACKGROUND_REMOVED":return this.removeRoomBackground(e.data);case"ADMIN_ROOM_FLAG_UPDATED":return this.updateRoomFlag(e.data);case"ADMIN_ROOM_DELETED":return this.deleteRoom(e.data);default:return null}}en.prototype.userJoinedRoom=function(e){e.user.id==this.store.getState().mUser.id?(this.store.dispatch(M(e.user)),this.store.dispatch(Nr("rose")),Yr.toggle(this.store),hr.setBacground(e.newRoom.background),Qe.close(this.store,$("#camera__box-"+e.user.id)),Qe.closeAllCameraBoxes(this.store)):window.taggedUser&&window.taggedUser==e.user.id&&(window.taggedUser=null,$("#chat__body__message-input__target").text(""));var t=e.oldRoom?e.oldRoom.id:null,r=e.newRoom?e.newRoom.id:null,n=null,o=null,i=null;e.user.room&&this.store.getState().mUser.room&&e.user.room.id==this.store.getState().mUser.room.id&&(i=e.user.room,n=e.user.id==this.store.getState().mUser.id?"    ":"    ",o="JOIN_LEAVE"),this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(r?(i=e.newRoom,n="    "):n="    ",o="JOIN_LEAVE"),n&&o&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&Dt.insert({icon:e.user.avatar,title:e.user.name,user:e.user,content:n,room:i,type:o},this.store),this.store.dispatch(B(e.user)),e.user.isMuted||(this.store.dispatch(jr(e.user.id,t,r)),e.user.id!=this.store.getState().mUser.id&&(Gt.setRooms(this.store),rt.setUsers(this.store))),e.newRoom&&e.newRoom.welcome&&e.user.id==this.store.getState().mUser.id&&Dt.insert({icon:e.newRoom.flag,content:e.newRoom.welcome,type:"ROOM_GREETING"},this.store),me.leaveRoom(this.store,e.user)},en.prototype.userExcpeledFromRoom=function(e){e.user.id==this.store.getState().mUser.id&&me.toggle(this.store,!1,e.oldRoom);var t=e.oldRoom?e.oldRoom.id:null,r=null,n=null;this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(t&&(r="(     )"),n="JOIN_LEAVE"),r&&n&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&Dt.insert({icon:e.user.avatar,title:e.user.name,user:e.user,room:null,content:r,type:n},this.store),t&&e.user.id&&!e.user.isMuted&&(this.store.dispatch(jr(e.user.id,t,null)),rt.setUsers(this.store))},en.prototype.userLeavedRoom=function(e){if(this.store.getState().mUser.room){var t=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id==e.user.id}))[0];t&&(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id!=e.user.id})),me.removeUserFromMic(this.store,e.user,t.micId,!1,!0))}e.user.id==this.store.getState().mUser.id&&(this.store.dispatch(M(e.user)),me.resetAllMics());var r=e.oldRoom?e.oldRoom.id:null,n=null,o=null;this.store.getState().mUser.room&&r==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(r&&(n="(   )"),o="JOIN_LEAVE"),n&&o&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&Dt.insert({icon:e.user.avatar,title:e.user.name,user:e.user,room:null,content:n,type:o},this.store),this.store.dispatch(B(e.user)),r&&e.user.id&&!e.user.isMuted&&(this.store.dispatch(jr(e.user.id,r,null)),rt.setUsers(this.store)),Gt.setRooms(this.store)},en.prototype.changeRoom=function(e){var t=this;if(!1===e.error){var r={id:Date.now(),user:e.user,type:"change_room",room:e.room,message:"   ",title:" "};this.store.dispatch(J(r)),K.render(r,this.store),rt.setUsers(this.store),Bt.toggleInput(this.store),me.resetAllMics(),this.store.getState().mUser.room&&this.store.getState().mUser.room.micUsers.forEach((function(e){me.setUserOnMic(t.store,t.store.getState().users.filter((function(t){return t.id==e.user_id}))[0],e.micId)})),me.toggle(this.store,e.room.is_voice_room)}},en.prototype.addRoom=function(e){e&&e.room&&(this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_ROOM",room:{id:e.id,name:e.name,password:e.password,welcome:e.welcome,description:e.description,capacity:e.capacity,flag:e.flag,users:e.users}}}(e.room)),Gt.setRooms(this.store))},en.prototype.updateRooms=function(e){var t=this;e&&Array.isArray(e.rooms)&&(e.rooms.forEach((function(e){var r=!1,n=!1,o=!1,i=t.store.getState().rooms.filter((function(t){return t.id==e.id}))[0];i&&(r=i.is_voice_room,n=i.is_video_room,o=i.is_users_cam_enabled),t.store.dispatch(function(e){return{type:"UPDATE_ROOM",room:e}}(e)),t.store.getState().mUser.room&&t.store.getState().mUser.room.id==e.id&&(t.store.dispatch(D({room:e})),(e.is_voice_room&&!r||e.is_video_room&&!n)&&me.toggle(t.store,e.is_voice_room),e.is_users_cam_enabled!=o&&rt.toggleCamera(t.store))})),Gt.setRooms(this.store),me.setLockedMics(this.store))},en.prototype.updateRoomBackground=function(e){e&&e.room&&(this.store.dispatch(Lr(e.room.id,e.room.background)),e.room.background&&hr.setBacground(e.room.background))},en.prototype.removeRoomBackground=function(e){e&&e.room&&(this.store.dispatch(Lr(e.room.id,null)),hr.setBacground(null))},en.prototype.updateRoomFlag=function(e){var t,r;e&&e.room&&(this.store.dispatch((t=e.room.id,r=e.room.flag,{type:"UPDATE_ROOM_FLAG",id:t,flag:r})),Gt.setRooms(this.store))},en.prototype.deleteRoom=function(e){var t=this;e&&Array.isArray(e.ids)&&(e.ids.forEach((function(e){t.store.dispatch(function(e){return{type:"DELETE_ROOM",id:e}}(e))})),Gt.setRooms(this.store))};var tn=en,rn=r(4),nn=r.n(rn);function on(e,t){switch(this.store=t,e.type){case"NEW_PUBLIC_MESSAGE":return this.onNewMessage(e.data);case"REMOVE_PUBLIC_MESSAGE":return this.removeMessage(e.data);case"NEW_AD":return this.onNewAd(e.data);case"SELF_MESSAGE":return this.onSelfMessage(e.data);default:return null}}on.prototype.onNewMessage=function(e){if(e&&e.user.room&&this.store.getState().mUser.room&&e.user.room.id==this.store.getState().mUser.room.id){if(this.store.getState().ignoredUsers.includes(e.user.id))return;Dt.insert({tagged:e.tagged,id:e.time,user:e.user,icon:e.user.avatar,title:e.user.name,content:e.message,type:"PUBLIC_MESSAGE"},this.store)}},on.prototype.removeMessage=function(e){e&&e.id&&Dt.remove(e.id)},on.prototype.onNewAd=function(e){if(e){if(this.store.getState().ignoredUsers.includes(e.user.id))return;Dt.insert({id:e.time,user:e.user,icon:e.user.avatar,title:e.user.name,content:e.message,type:"AD"},this.store)}},on.prototype.onSelfMessage=function(e){e&&e.message&&(Dt.clearSelfMessages(),Dt.insert({id:nn()(),user:null,icon:null,title:e.message.title,content:e.message.msg,type:"SELF_MESSAGE"},this.store))};var an=on;function sn(e,t){switch(this.store=t,e.type){case"NEW_PRIVATE_MESSAGE":return this.onNewMessage(e.data);default:return null}}sn.prototype.onNewMessage=function(e){if(e.from&&e.from.id!=this.store.getState().mUser.id&&!this.store.getState().ignoredUsers.includes(e.from.id)){var t=e.from.id,r=this.store.getState().mUser,n=e.from,o=e.message,i=!(!this.store.getState().currentConversation||this.store.getState().currentConversation.id!=t);this.store.dispatch(P(t,r,n,i,o)),i?Se.insert(o,n,this.store):Se.playNotification(this.store),pr.updateConversationsCount(this.store),"conversations"==this.store.getState().currentPane&&ar.renderConversations(this.store)}};var cn=sn;function un(e,t){switch(this.store=t,e.type){case"PROFILE_ACTION_NOTIFY":return this.notify(e.data);case"PROFILE_ACTION_LIKE":return this.like(e.data);case"PROFILE_ACTION_GIFT":return this.gift(e.data);case"PROFILE_ACTION_REMOVE_GIFT":return this.removeGift(e.data);case"PROFILE_ACTION_CHANGE_DECORATION":return this.changeDecoration(e.data);case"PROFILE_ACTION_CONTROL_LIKES":return this.controlLikes(e.data);case"PROFILE_ACTION_ROOM_EXCPEL":return this.roomExcpel(e.data);case"PROFILE_ACTION_CHANGE_ROLE":return this.changeRole(e.data);case"PROFILE_LIKE_ALBUM_PHOTO":return this.photoLiked(e.data);default:return null}}un.prototype.notify=function(e){if(e.user&&e.message){var t={id:Date.now(),user:e.user,message:e.message,title:"",type:"notify"};this.store.dispatch(J(t)),K.render(t,this.store)}},un.prototype.like=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"like",message:null,title:""};this.store.dispatch(J(t)),this.store.dispatch(Nr("heart")),Yr.toggle(this.store),K.render(t,this.store)}},un.prototype.gift=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"gift",message:e.message,title:""};this.store.dispatch(J(t)),this.store.dispatch(Nr("gift")),Yr.toggle(this.store),K.render(t,this.store)}},un.prototype.removeGift=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"remove_gift",message:e.message,title:" "};this.store.dispatch(J(t)),K.render(t,this.store)}},un.prototype.changeDecoration=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"change_decoration",message:"   ",title:""};this.store.dispatch(J(t)),K.render(t,this.store),ae.updateDecoration(this.store)}},un.prototype.controlLikes=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"control_likes",message:"  "+e.likes+" ",title:""};this.store.dispatch(J(t)),this.store.dispatch(Nr("heart")),Yr.toggle(this.store),K.render(t,this.store)}},un.prototype.roomExcpel=function(e){if(e.user){var t={id:Date.now(),user:e.user,room:e.oldRoom,type:"room_excpel",message:"   ",title:""};this.store.dispatch(J(t)),K.render(t,this.store)}},un.prototype.changeRole=function(e){var t={id:Date.now(),user:e.user,type:"change_role",message:"   "+e.roleName,title:""};this.store.dispatch(J(t)),K.render(t,this.store)},un.prototype.photoLiked=function(e){if(e&&e.user&&e.photo){var t={id:Date.now(),user:e.user,type:"photo_like",message:"  ",photo:e.photo,title:""};this.store.dispatch(J(t)),K.render(t,this.store)}};var ln=un;function dn(e,t){switch(this.store=t,e.type){case"GREET_USER":return this.greetUser(e.data);case"USER_UPDATED":return this.userUpdated(e.data);case"USERS_UPDATED":return this.usersUpdated(e.data);case"LOGIN_BANNED":return this.loginBanned(e.data);default:return null}}dn.prototype.greetUser=function(e){var t=this;me.joinRoom(this.store),e&&e.messages&&e.messages.forEach((function(e){Dt.insert({icon:e.icon,title:e.title,content:e.content,titleColor:e.titleColor,contentColor:e.contentColor,backgroundColor:e.backgroundColor,type:"GREET_USER"},t.store)}))},dn.prototype.userUpdated=function(e){if(this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_USER_ATTRIBUTE",user:e}}(e)),this.store.dispatch(U(e)),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_PUBLIC_MESSAGE_USER",user:e}}(e)),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_PRIVATE_MESSAGE_USER",user:e}}(e)),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_POSTS_USER",user:e}}(e)),this.store.dispatch({type:"UPDATE_CURRENT_CONVERSATION",user:e}),e.id==this.store.getState().mUser.id&&this.store.dispatch(D(e.updates)),e.updates.state&&"state_out"==e.updates.state&&(this.store.dispatch(A(e.id)),ar.render(this.store),pr.updateConversationsCount(this.store)),e.updates&&!1===e.updates.isCameraOn){var t=$("#camera__box-"+e.id);t&&Qe.close(this.store,t)}rt.updateUser(e.id,this.store),Dt.updateUser(e.id,this.store),Se.updateUser(e.id,this.store),O.updateUser(e.id,this.store)},dn.prototype.usersUpdated=function(e){var t=this;e&&Array.isArray(e.updates)&&e.updates.forEach((function(e){t.userUpdated(e)}))},dn.prototype.loginBanned=function(e){var t={id:Date.now(),data:e,title:" ",type:"login_banned"};this.store.dispatch(J(t)),K.render(t,this.store)};var pn=dn;function fn(e,t){switch(this.store=t,e.type){case"POST_ADDED":return this.postAdded(e.data);case"POST_UPDATED":return this.postUpdated(e.data);case"POST_LIKED":return this.postLiked(e.data);case"POST_REMOVED":return this.postRemoved(e.data);case"YOUR_POST_IS_REMOVED":return this.yourPostIsRemoved(e.data);case"POST_COMMENTED":return this.postCommented(e.data);case"POST_COMMENT_LIKED":return this.postCommentLiked(e.data);case"POST_COMMENT_ADDED":return this.postCommentAdded(e.data);case"POST_COMMENT_DELETED":return this.postCommentDeleted(e.data);default:return null}}fn.prototype.postAdded=function(e){this.store.getState().ignoredUsers.includes(e.user.id)||(this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{type:"ADD_POST",post:e,wallMsgCount:t}}(e,this.store.getState().settings.wall_msg_count)),"wall"!=this.store.getState().currentPane&&(this.store.dispatch({type:"INC_NEW_POSTS_COUNT"}),pr.updateWallCout(this.store)),er.addPost(e,this.store))},fn.prototype.postUpdated=function(e){this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_POST_ATTRIBUTE",post:e}}(e)),er.updatePost(e.id,this.store)},fn.prototype.postLiked=function(e){if(e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,message:"  ",title:"",type:"post_like"};this.store.dispatch(J(t)),K.render(t,this.store)}},fn.prototype.postRemoved=function(e){this.store.dispatch({type:"REMOVE_POST",id:e.id}),er.removePost(e.id)},fn.prototype.yourPostIsRemoved=function(e){if(e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,message:"  ",title:"",type:"post_remove"};this.store.dispatch(J(t)),K.render(t,this.store)}},fn.prototype.postCommented=function(e){if(e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,comment:e.comment,comment_id:e.commentId,post_id:e.postId,message:"   ",title:"",type:"post_commented"};this.store.dispatch(J(t)),K.render(t,this.store),er.updatePost(e.postId,this.store)}},fn.prototype.postCommentLiked=function(e){if(e.user&&e.commentId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,comment:e.comment,comment_id:e.commentId,message:"  ",title:"",type:"post_comment_like"};this.store.dispatch(J(t)),K.render(t,this.store),zt.incCommentLikes(e.commentId)}},fn.prototype.postCommentAdded=function(e){this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"INC_POST_COMMENTS_COUNT",post:e}}({id:e.post_id})),er.updatePost(e.post_id,this.store),e.comment.time=Date.now(),zt.add(e.comment,this.store)},fn.prototype.postCommentDeleted=function(e){this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"DEC_POST_COMMENTS_COUNT",post:e}}({id:e.post_id})),er.updatePost(e.post_id,this.store),zt.remove(e.id)};var hn=fn;function mn(e,t){switch(this.props=t,e.type){case"RESET_FACES":return this.setGifts(e.data);case"RESET_GIFTS":return this.setFaces(e.data);default:return null}}mn.prototype.setGifts=function(e){e.faces&&this.props.dispatch($r(e.faces))},mn.prototype.setFaces=function(e){e.gifts&&this.props.dispatch(Fr(e.gifts))};var _n=mn,gn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_SETTINGS",settings:e}};function vn(e,t){switch(this.store=t,e.type){case"SET_SETTINGS":return this.setSettings(e.data);case"USER_SETTINGS_CLEAR_PUBLIC_MESSAGES":return this.clearPublicMessages();default:return null}}vn.prototype.setSettings=function(e){if(e&&e.settings){var t=e.settings[Ar()]?e.settings[Ar()]:e.settings,r=!1;this.store.getState().settings.public_banner_1_img==t.public_banner_1_img&&this.store.getState().settings.public_banner_2_img==t.public_banner_2_img||(r=!0),this.store.dispatch(gn(t)),Er(),pr.toggleTV(this.store),d.update(this.store),er.update(this.store),Gr.update(this.store),Gr.toggle(this.store),r&&me.setPublicBanner(this.store),me.setBackgroundColor(this.store)}},vn.prototype.clearPublicMessages=function(){$(".public_message").remove(),this.store.dispatch({type:"CLEAR_ALL_PUBLIC_MESSAGES"})};var yn=vn;function bn(e,t){switch(this.store=t,e.type){case"MIC_NEW_SPEAKER":return this.micNewSpeaker(e.data);case"MIC_SPEAKER_LEAVED":return this.micSpeakerLeaved(e.data);case"MIC_SPEAKER_MUTED":return this.micSpeakerMuted(e.data);case"MIC_RECALL_USER":return this.micRecallUser(e.data);default:return null}}bn.prototype.micNewSpeaker=function(e){this.store.getState().mUser.room&&(this.store.getState().mUser.room.micUsers.push({micId:e.micId,user_id:e.user.id}),me.setUserOnMic(this.store,e.user,e.micId))},bn.prototype.micSpeakerLeaved=function(e){if(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id!=e.user.id})),me.removeUserFromMic(this.store,e.user,e.micId,!0),e.acter&&e.acter.id!=this.store.getState().mUser.id&&e.user.id==this.store.getState().mUser.id){var t={id:Date.now(),user:e.acter,message:"   ",title:" ",type:void 0};this.store.dispatch(J(t)),K.render(t,this.store)}},bn.prototype.micSpeakerMuted=function(e){!window.incomingMicStreams[e.micId]||e.muted||me.isMicMuted(e.micId)||(window.incomingMicStreams[e.micId].getTracks().forEach((function(t){t.enabled=!e.muted})),me.updateMicMutedStyle(e.micId,!e.muted))},bn.prototype.micRecallUser=function(e){e&&e.user&&me.callNewUser(this.store,e.user)};var wn=bn;function Sn(e,t){switch(this.store=t,e.type){case"CAMERA_REQUEST":return this.camRequested(e.data);case"CAMERA_REQUEST_ACCEPTED":return this.camRequestAccepted(e.data);case"CAMERA_REQUEST_REFUSED":return this.camRequestRefused(e.data);case"CAMERA_BOX_CLOSED":return this.cameraBoxClosed(e.data);default:return null}}Sn.prototype.camRequested=function(e){if(e&&e.user){var t={id:Date.now(),data:e.user,user:e.user,title:" ",type:"cam_request"};this.store.dispatch(J(t)),K.render(t,this.store)}},Sn.prototype.camRequestAccepted=function(e){e&&e.user&&($("#user-"+e.user.id+" .chat_pane__user_item__loader").hide(),Qe.render(this.store,e.user),Qe.init(this.store,!1,Qe.generateJanusRoomID(e.user.id)))},Sn.prototype.camRequestRefused=function(e){if(e&&e.user){var t={id:Date.now(),data:e.user,user:e.user,title:" ",type:"cam_request_refused"};this.store.dispatch(J(t)),K.render(t,this.store),$("#user-"+e.user.id+" .chat_pane__user_item__loader").hide()}},Sn.prototype.cameraBoxClosed=function(e){e&&e.user};var kn=Sn;function Cn(e,t){switch(this.store=t,e.type){case"YOUCAM_LUDO_REQUESTED":return this.ludoRequested(e.data);case"YOUCAM_LUDO_REQUEST_ACCEPTED":return this.ludoRequestAccepted(e.data);case"YOUCAM_LUDO_REQUEST_REFUSED":return this.ludoRequestRefused(e.data);case"YOUCAM_LUDO_START_GAME":return this.ludoStartGame(e.data);case"YOUCAM_LUDO_DICE_CLICKED":return this.ludoDiceClicked(e.data);case"YOUCAM_LUDO_PLAYER_CLICKED":return this.ludoPlayerClicked(e.data);case"YOUCAM_LUDO_UPDATE_TURN":return this.ludoUpdateTurn(e.data);case"YOUCAM_LUDO_EXIT_GAME":return this.ludoExitGame(e.data);case"YOUCAM_LUDO_END_GAME":return this.ludoEndGame(e.data);default:return null}}Cn.prototype.ludoRequested=function(e){if(e&&e.user){var t={id:Date.now(),data:e.user,user:e.user,color:e.color,title:" ",type:"ludo_request"};this.store.dispatch(J(t)),K.render(t,this.store)}},Cn.prototype.ludoRequestAccepted=function(e){e&&e.user&&($("#pre_youcam_ludo_modal__body__form--request-"+e.color+"__loader").attr("src","/images/check_ok.png").show(),$("#pre_youcam_ludo_modal__body__form--request-"+e.color).attr("src","/images/check_ok.png").hide(),$("#pre_youcam_ludo_modal__body__form--select-"+e.color).prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-red option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-green option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-yellow option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-blue option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form img[src='/images/check_ok.png']").length>1&&$(".pre_youcam_ludo_modal__body__form__button--start").removeAttr("disabled"))},Cn.prototype.ludoRequestRefused=function(e){if(e&&e.user){var t={id:Date.now(),data:e.user,user:e.user,title:" ",type:"ludo_request_refused"};this.store.dispatch(J(t)),K.render(t,this.store),$("#pre_youcam_ludo_modal__body__form--request-"+e.color+"__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-"+e.color).show()}},Cn.prototype.ludoStartGame=function(e){if(e){var t=!1;window.mUserLudoColor||(t=!0),window.mUserLudoColor=e.color,window.ludoPlayers=e.players,window.ludoCurrentTurn=e.turn,t&&(re.render(this.store),e.color||($("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),re.onShowLudo(this.store)))}},Cn.prototype.ludoDiceClicked=function(e){e&&e.color!=window.mUserLudoColor&&re.rollDice(e.color,e.value)},Cn.prototype.ludoPlayerClicked=function(e){if(e&&e.color!=window.mUserLudoColor){var t=$("#"+e.id);re.movePlayer(t,e.value,this.store,e.color)}},Cn.prototype.ludoUpdateTurn=function(e){e&&e.color!=window.mUserLudoColor&&re.updateTurn(e.value)},Cn.prototype.ludoExitGame=function(e){e&&e.color!=window.mUserLudoColor&&re.userOut(this.store,e.color)},Cn.prototype.ludoEndGame=function(e){e&&re.gameEnded(this.store,e.color)};var En=Cn;function Tn(e,t){switch(this.store=t,e.type){case"CALL_REQUESTED":return this.callRequested(e.data);case"CALL_REQUEST_CANCELLED":return this.callRequestCancelled(e.data);case"CALL_REQUEST_ACCEPTED":return this.callRequestAccepted(e.data);default:return null}}Tn.prototype.callRequested=function(e){if(e&&e.caller){this.store.dispatch(ue(!0));var t={user:e.caller,dialogType:"call-received",statusClass:"success",status:"  ..."};this.store.dispatch(le(t)),ye.render(this.store,t)}},Tn.prototype.callRequestCancelled=function(e){this.store.dispatch(ue(!1)),this.store.dispatch(le(null)),ye.close(),this.store.getState().webrtc&&(this.store.getState().webrtc.leaveRoom(),this.store.getState().webrtc.stopLocalVideo(),this.store.getState().webrtc.releaseGroup(),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_RADIO_CONNECTION_READY",radioConnectionReady:e}}(!1)))},Tn.prototype.callRequestAccepted=function(e){this.store.dispatch(le({user:e.caller,dialogType:"call-sent",statusClass:"success",status:" "})),ye.onCallAccepted()};var Pn=Tn;function An(e,t){switch(this.store=t,e.type){case"BOT_BRB_START_COUNTDOWN":return this.startCountdown(e.data);case"BOT_BRB_PAUSED":return this.paused(e.data);case"BOT_BRB_STOPPED":return this.stopped(e.data);case"BOT_BRB_ENDED":return this.ended(e.data);case"BOT_BRB_RIGHT_ANSWER":return this.rightScore(e.data);default:return null}}An.prototype.startCountdown=function(e){e&&e.message&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Dt.insert({id:nn()(),user:null,icon:null,title:"  ",content:e.message,type:"BOT_BRB_MESSAGE"},this.store)},An.prototype.paused=function(e){e&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Dt.insert({id:nn()(),user:null,icon:null,title:" ",content:"    ",type:"BOT_BRB_MESSAGE"},this.store)},An.prototype.stopped=function(e){e&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Dt.insert({id:nn()(),user:null,icon:null,title:" ",content:"  ",type:"BOT_BRB_MESSAGE"},this.store)},An.prototype.ended=function(e){if(e&&e.room_id){if(e.winner&&e.winner.id==this.store.getState().mUser.id){var t={id:Date.now(),user:null,message:"     ,       ",title:" ",type:"notify"};this.store.dispatch(J(t)),K.render(t,this.store)}Dt.insert({id:nn()(),user:e.winner,title:"",content:e.winner?"   ":"   ",type:"BOT_BRB_MESSAGE"},this.store)}},An.prototype.rightScore=function(e){e&&e.room_id&&e.user&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Dt.insert({id:nn()(),user:e.user,title:"",content:"  "+e.num_points,type:"BOT_BRB_MESSAGE"},this.store)};var Rn=An;function On(e,t){switch(this.store=t,e.type){case"FILTER_SEND_NOTIFICATION":return this.sendNotification(e.data);default:return null}}On.prototype.sendNotification=function(e){if(e.user&&e.word){var t="denied"==e.word.type?" ":" ",r={id:Date.now(),user:e.user,title:t,word:e.word,type:"world_filter_notification"};this.store.dispatch(J(r)),K.render(r,this.store)}};var xn=On;function Mn(e){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var In=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.onClick(t)}},{key:"initUpdateTimeHandler",value:function(){setInterval((function(){for(var e=document.getElementsByClassName("time"),t=0;t<e.length;t++){var r=e[t];r.textContent=kr(r.dataset.time)}}),6e4)}},{key:"registerSocketEvents",value:function(e){e.getState().socket.on("res",(function(t){var r,n;(t=Sr(t))&&"object"==Mn(t)&&"string"==typeof t.type&&"object"==Mn(t.data)&&("object"==Mn(t.data)&&(r=t.data,n=0,function(e){window.consumedData+=e,e<1024||(e<1048576?(e/1024).toFixed(3):e<1073741824?(e/1048576).toFixed(3):(e/1073741824).toFixed(3))}(function e(t){if(null!=t)switch(mr(t)){case"number":n+=8;break;case"string":n+=2*t.length;break;case"boolean":n+=4;break;case"object":var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r||"Array"===r)for(var o in t)t.hasOwnProperty(o)&&e(t[o]);else n+=2*t.toString().length}return n}(r))),new Zr(t,e),new tn(t,e),new an(t,e),new cn(t,e),new ln(t,e),new pn(t,e),new hn(t,e),new _n(t,e),new yn(t,e),new Pn(t,e),new xn(t,e),new En(t,e),new Rn(t,e),new kn(t,e),window.is_mic_enabled&&new wn(t,e))}))}},{key:"registerDOMEvents",value:function(t){e.registerEvents(t),hr.registerEvents(t),y.registerEvents(t),Bt.registerEvents(t),pr.registerEvents(t),rt.registerEvents(t),f.registerEvents(t),Gt.registerEvents(t),jt.registerEvents(t),er.registerEvents(t),Gr.registerEvents(t),Kt.registerEvents(t),ae.registerEvents(t),ot.registerEvents(t),lr.registerEvents(t),window.is_mic_enabled&&me.registerEvents(t),d.registerEvents(t),Yr.registerEvents(t)}},{key:"onClick",value:function(e){$("#chat").unbind("click").on("click",(function(t){var r=document.querySelector("#chat__body__message-input__face"),n=document.querySelector("#chat_box__footer__smile"),o=document.querySelector("#chat__body__wall_pane__form__attach__face"),i=document.querySelector("#wall_comments__attach__face");r!==t.target&&e.dispatch(b(!1)),n!==t.target&&e.dispatch(x(!1)),o!==t.target&&e.dispatch(Qt(!1)),i!==t.target&&e.dispatch(Vt(!1)),y.toggle(e)}))}},{key:"loadElementsToMemory",value:function(){window.publicMessagesContainer=$("#chat__body__messages_container"),window.publicMessagesContainerDivider=$("#chat__body__messages_container__divider"),window.togglePublicMessagesDivider=$("#chat__body__message-input__divide"),window.usersPane=$("#chat__body__users-pane"),window.conversationsPane=$("#chat__body__conversations_pane"),window.roomsPane=$("#chat__body__rooms_pane"),window.wallPane=$("#chat__body__wall_pane"),window.wallCreatorPane=$("#chat__body__wall_creator_pane"),window.ignoredUsersPane=$("#chat__body__ignored-users-pane"),window.notificationsPane=$("#chat__body__notifications-pane"),window.settingsPane=$("#chat__body__settings_pane"),window.chatFooter=$("#chat__footer")}},{key:"render",value:function(t){window.consumedData=0;var r="<div id='chat'>";r+=zr.render(t),r+=pr.render(t),r+="<div id='cameras_container'></div>",r+="<div id='tv_box'></div>",r+="<div id='user_profile_container'></div>",r+="<div id='wall_comments_container'></div>",r+="<div id='create_room_container'></div>",r+="<div id='edit_room_container'></div>",r+="<div id='chat_box_container'></div>",r+="<div id='popup_container'></div>",r+="<div id='youcam_ludo_container'></div>",r+="<div id='call_container'></div>",r+="<div id='royal_login_container'></div>",r+="<div id='manage_bot_brb_container'></div>",r+=Yr.render(t),r+='<audio autoplay id="calls-audio"></audio>',r+="</div>",$("#app").html(r),$(".crisp-client").hide(),e.loadElementsToMemory(),pr.toggleTV(t),er.update(t),xt.render(t),e.registerSocketEvents(t),e.registerDOMEvents(t),e.initUpdateTimeHandler(),hr.setBacground(t.getState().mUser.room.background),me.setPublicBanner(t),Tr(),window.onbeforeunload=function(){if(window.confirmOnExit)return"     "},window.callsAudio=document.querySelector("#calls-audio")}}],(r=null)&&Dn(t.prototype,r),n&&Dn(t,n),e}();function Un(e){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ln=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(t){e.registerConnectionState(t),$(".react-tabs__tab").unbind("click").on("click",(function(e){$(this).siblings().removeClass("react-tabs__tab--selected"),$(this).addClass("react-tabs__tab--selected")})),$("#guest-form").on("submit",(function(r){e.onGuestLogin(r,t),me.addMidAudios()})),$("#login-form").on("submit",(function(r){e.onMemberLogin(r,t),me.addMidAudios()})),$("#register-form").on("submit",(function(r){e.onRegister(r,t)})),br("mun")&&($("#react-tabs-1 a").removeClass("active"),$("#react-tabs-1").removeClass("react-tabs__tab--selected"),$("#guest").removeClass("active").removeClass("show"),$("#react-tabs-2 a").addClass("active"),$("#react-tabs-2").addClass("react-tabs__tab--selected"),$("#member").addClass("active").addClass("show"))}},{key:"registerConnectionState",value:function(e){var t=e.getState().socket;t.on("connect",(function(){$("#connection-state-on").css("display","inline"),$("#connection-state-off").css("display","none"),me.init(e)})),t.on("disconnect",(function(){window.confirmOnExit=!1,$("#connection-state-off").css("display","inline"),$("#connection-state-on").css("display","none"),location.reload()})),t.on("connect_error",(function(e){console.log("connect_error due to ".concat(e.message))}))}},{key:"onGuestLogin",value:function(t,r){t.preventDefault();var n=t.target.name.value,o=(Sr(br("status"),!0),Sr(br("statusColor"),!0),Sr(br("fontColor"),!0),Sr(br("nameColor"),!0),Sr(br("nameBgColor"),!0),Sr(br("fontSize"),!0),Sr(br("avatar"),!0),Sr(br("isPrivateBipEnabled"),!0),{type:"GUEST_LOGIN",data:{name:n}});if(n.length>r.getState().settings.username_guest_length)return $(".tabs-form-error.error").show().text("      "+r.getState().settings.username_guest_length+" ");e.hideFormAlerts(),$("form button").attr("disabled","disabled"),r.getState().socket.emit("req",wr(o),(function(t){e.handleLoginResponse(Sr(t),!0,r)}))}},{key:"onMemberLogin",value:function(t,r){t.preventDefault();var n={type:"MEMBER_LOGIN",data:{name:t.target.name.value,password:t.target.password.value,hidden:t.target.hidden.checked}};e.hideFormAlerts(),$("form button").attr("disabled","disabled"),r.getState().socket.emit("req",wr(n),(function(t){e.handleLoginResponse(Sr(t),!1,r)}))}},{key:"onRegister",value:function(t,r){t.preventDefault();var n=t.target.name.value,o=t.target.password.value,i={type:"REGISTER_MEMBER",data:{name:n,password:o}};if(n.length>r.getState().settings.username_register_length)return $(".tabs-form-error.error").show().text("      "+r.getState().settings.username_register_length+" ");e.hideFormAlerts(),$("form button").attr("disabled","disabled"),r.getState().socket.emit("req",wr(i),(function(e){e=Sr(e),$("form button").removeAttr("disabled");var t=e.error,i=e.message;t?K.render({id:Date.now(),message:i,title:"",type:"login_res"},r):($(".tabs-form-error.success").show().text(i),$("#react-tabs-3 a").removeClass("active"),$("#react-tabs-3").removeClass("react-tabs__tab--selected"),$("#register").removeClass("active").removeClass("show"),$("#react-tabs-2 a").addClass("active"),$("#react-tabs-2").addClass("react-tabs__tab--selected"),$("#member").addClass("active").addClass("show")),e.error||($("#login-form__name").val(n),$("#login-form__password").val(o))}))}},{key:"handleLoginResponse",value:function(t,r,n){var o=!1,i=null;if("object"==Un(t))if(o=!!t.error,i=t.message,!1===o&&t.user){$(".tabs-form-error.success").show().text(i),window.userActions=t.actions,window.roles=t.roles,window.shortcuts=t.shortcuts,n.dispatch(M(t.user)),n.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_USERS",users:e}}(t.users)),n.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_ROOMS",rooms:e}}(t.rooms)),n.dispatch(Fr(t.gifts)),n.dispatch($r(t.faces)),n.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_GRANTED_SETTINGS",settings:e}}(t.grantedSettings)),e.openChat(a,n),Dt.insert({icon:t.user.avatar,title:t.user.name,room:t.user.room,user:t.user,content:"    ",type:"JOIN_LEAVE"},n),t.user.room&&t.user.room.welcome&&Dt.insert({icon:t.user.room.flag,content:t.user.room.welcome,type:"ROOM_GREETING"},n),n.dispatch(Nr("rose"));var a=24;r?(yr("gun",wr(t.user.name,!0)),a=Sr(br("fontSize"),!0)):(yr("mun",wr(t.cookie.name,!0)),yr("mup",wr(t.cookie.password,!0)),a=t.user.fontSize),t.user.royalLogin&&Kr.append(t.user),t.user.room.micUsers.forEach((function(e){me.setUserOnMic(n,n.getState().users.filter((function(t){return t.id==e.user_id}))[0],e.micId)})),me.toggle(n,n.getState().mUser.room.is_voice_room),n.getState().mUser.room.ludoGameState.players&&(window.ludoPlayers=n.getState().mUser.room.ludoGameState.players,window.ludoCurrentTurn=n.getState().mUser.room.ludoGameState.currentTurn,re.render(n,null,n.getState().mUser.room.ludoGameState),$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),re.onShowLudo(n)),t.isSubscriptionEnded&&K.render({id:Date.now(),message:"  ,    ",title:"",type:"login_res"},n),rt.toggleCamera(n)}else K.render({id:Date.now(),message:i,title:"",type:"login_res"},n);$("form button").removeAttr("disabled")}},{key:"hideFormAlerts",value:function(){$(".tabs-form-error").hide()}},{key:"openChat",value:function(e,t){In.render(t),document.querySelector("html").style.fontSize=e+"px"}},{key:"renderCopyrights",value:function(){return"<p id='youcam-copyrights' style='margin-bottom: 0; font-size: 0.625rem; text-align: right; padding: 0.35rem 0; background-color: white; margin-right: 0.36rem;'> : <a href='https://tlgawy.com/'> </a></p>"}},{key:"render",value:function(){var t="<div class='react-tabs'>";return t+="<ul class='nav nav-tabs react-tabs__tab-list' id='tabs' role='tablist'>",t+="<li class='nav-item react-tabs__tab react-tabs__tab--selected' id='react-tabs-1'>",t+="<a class='nav-link active' data-toggle='tab' href='#guest' role='tab' aria-controls='guest' aria-selected='true'><span class='fa fa-user'></span> </a>",t+="</li>",t+="<li class='nav-item react-tabs__tab' id='react-tabs-2'>",t+="<a class='nav-link' data-toggle='tab' href='#member' role='tab' aria-controls='member' aria-selected='false'><span class='fa fa-user'></span> </a>",t+="</li>",t+="<li class='nav-item react-tabs__tab' id='react-tabs-3'>",t+="<a class='nav-link' data-toggle='tab' href='#register' role='tab' aria-controls='register' aria-selected='false'><span class='fa fa-user'></span> </a>",t+="</li>",t+="</ul>",t+="<div class='tab-content' id='tabs-content'>",t+="<div class='tab-pane fade show active' id='guest' role='tabpanel' aria-labelledby='home-tab'>",t+="<form id='guest-form'>",t+="<div>",t+="<input type='text' name='name' class='corner border' id='guest-form__name' value='"+Sr(br("gun"),!0)+"' placeholder='  ' />",t+="<button id='guest-form__submit' class='btn btn-primary buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i></button>",t+="</div>",t+="</form>",t+="</div>",t+="<div class='tab-pane fade' id='member' role='tabpanel' aria-labelledby='profile-tab'>",t+="<form id='login-form'>",t+="<div>",t+="<input type='text' name='name' class='border corner' id='login-form__name' value='"+Sr(br("mun"),!0)+"' placeholder='  ' />",t+="<input autocomplete='off' type='password' name='password' class='border corner' id='login-form__password' value='"+Sr(br("mup"),!0)+"' placeholder='  ' />",t+="<button id='login-form__submit' class='border-color btn btn-primary border buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i></button>",t+="<input type='checkbox' name='hidden' id='login-form__hidden-checkbox' />",t+="<label for='login-form__hidden-checkbox' id='login-form__hidden-label'> </label>",t+="</div>",t+="</form>",t+="</div>",t+="<div class='tab-pane fade' id='register' role='tabpanel' aria-labelledby='contact-tab'>",t+="<form id='register-form'>",t+="<div>",t+="<input type='text' class='border corner' id='register-form__name' name='name' placeholder='  '/>",t+="<input autoComplete='OFF' autocomplete='new-password' type='password' name='password' class='border corner' id='register-form__password' placeholder='  '/>",t+="<button id='register-form__submit' class='border-color btn btn-primary border buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i></button>",t+="</div>",t+="</form>",t+="</div>",t+="</div>",t+="<div id='connection_container'>",t+="<span class='connected' id='connection-state-on' style='display: none;'></span>",t+="<span id='connection-state-off'> </span>",t+="</div>",t+=e.renderCopyrights(),t+="<div class='alert alert-danger tabs-form-error error' style='display: none'></div>",t+="<div class='alert alert-success tabs-form-error success' style='display: none'></div>",t+="</div>"}}],(r=null)&&Bn(t.prototype,r),n&&Bn(t,n),e}();function jn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Fn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,r,n;return t=e,n=[{key:"render",value:function(e){var t=e.getState();if(t.settings.disable_marquee)return"";var r="<marquee class='marquee' direction='right' width='100%' scrolldelay='0' scrollamount='5' style='color: "+t.settings.marquee_text_color+"; background-color: "+t.settings.marquee_bg_color+"'>";return r+=t.settings.marquee_content,r+="</marquee>"}}],(r=null)&&jn(t.prototype,r),n&&jn(t,n),e}();function $n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Nn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"setUsersCount",value:function(e){$(".users-count-label .count.online").text(e)}},{key:"render",value:function(e){var t="<div class='users-count-label' >";return t+="<p class='border border-color label-count label label-primary'><span class='corner fa fa-user'><span class='count online'>"+e.getState().tempOnlineUsers.length+"</span></span>  </p>",t+="</div>"}}],(r=null)&&$n(t.prototype,r),n&&$n(t,n),e}();function qn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Gn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"registerEvents",value:function(e){e.getState().socket.on("conn",(function(t){t=Sr(t),e.dispatch($r(t.faces)),window.is_mic_enabled=t.is_mic_enabled;var r=$("#online_users");t.users.sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1})).forEach((function(t,n){var o=10*(n+1);$(et.render(t,!1,e)).css("left","500px").appendTo(r).delay(o).animate({left:"0"})})),Nn.setUsersCount(t.users.length),function(){document.body.style.zoom="1";var e=Pr()/document.body.style.zoom,t=document.querySelector("#login .login_wrapper"),r=t?t.clientHeight:0;$("#online_users").height(e-r-3+"px"),$("#login").height(Pr()-2+"px")}(),$("img").on("contextmenu",(function(){return!1}))}))}},{key:"destroy",value:function(e){e.socket.removeEventListener("conn"),e.dispatch({type:"CLEAR_TEMP_ONLINE_USERS"})}},{key:"render",value:function(t){return e.registerEvents(t),"<div id='online_users'></div>"}}],(r=null)&&qn(t.prototype,r),n&&qn(t,n),e}();function Vn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"render",value:function(e){var t="<div style='background: "+Cr(e.getState().settings)+"'>";t+="<div id='login' style='background-image: "+function(e){return e&&e.show_interface_background?e.interface_background?" url(/uploads/"+e.interface_background+")":" url(/images/interface_background.jpg)":"none"}(e.getState().settings)+"; background-size: contain'>",t+="<div class='login_wrapper'>",t+=Mr.render(e),t+=e.getState().settings.show_banner>0?Ir.render(e):"",t+=Br.render(e),t+=Fn.render(e),t+=Ln.render(e),t+=Nn.render(e),t+="</div>",t+=Gn.render(e),t+="</div>",t+="<div id='popup_container'></div>",t+="</div>",$("#app").html(t),Ln.registerEvents(e),Er(e.getState().settings)}}],(r=null)&&Vn(t.prototype,r),n&&Vn(t,n),e}(),Hn=r(54),zn=r.n(Hn),Jn=r(55),Yn=r.n(Jn);function Xn(e,t){var r,n,o,i,a,s,c,u;for(r=3&(e=e.join("")).length,n=e.length-r,o=t,a=3432918353,s=461845907,u=0;u<n;)c=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<36|(255&e.charCodeAt(++u))<<24,++u,o=27492+(65535&(i=5*(65535&(o=(o^=c=(65535&(c=(c=(65535&c)*a+(((c>>>36)*a&65535)<<36)&4294967295)<<15|c>>>17))*s+(((c>>>36)*s&65535)<<36)&4294967295)<<13|o>>>19))+((5*(o>>>36)&65535)<<36)&4294967295))+((58964+(i>>>36)&65535)<<36);switch(c=0,r){case 3:c^=(255&e.charCodeAt(u+2))<<36;case 2:c^=(255&e.charCodeAt(u+1))<<8;case 1:o^=c=(65535&(c=(c=(65535&(c^=255&e.charCodeAt(u)))*a+(((c>>>36)*a&65535)<<36)&4294967295)<<15|c>>>17))*s+(((c>>>36)*s&65535)<<36)&4294967295}return o^=e.length,o=2246822507*(65535&(o^=o>>>36))+((2246822507*(o>>>36)&65535)<<36)&4294967295,o=3266489909*(65535&(o^=o>>>13))+((3266489909*(o>>>36)&65535)<<36)&4294967295,((o^=o>>>36)>>>0).toString(36)}function Kn(){try{var e=new Date,t=e.getFullYear()+"";return e.getMonth()+1<10&&(t+="0"),t+=""+(e.getMonth()+1),e.getDate()<10&&(t+="0"),t+=""+e.getDate(),e.getHours()/2<10&&(t+="0"),t+=""+parseInt(e.getHours()/2),parseInt(t).toString(32)}catch(e){return"ERR"}}var Qn,Zn,eo,to,ro,no,oo=zn()(socketIOHost,{transports:["websocket","polling"],secure:!0,reconnection:!0,rejectUnauthorized:!1,query:"d="+wr((Qn=new Yn.a,Zn=Qn.get(),eo=navigator.deviceMemory?navigator.deviceMemory:5,to=Qn.parse().colorDepth?Qn.parse().colorDepth:25,ro=Qn.parse().cpuCores?Qn.parse().cpuCores:5,no="",Array.isArray(Qn.parse().resolution)&&(no=Qn.parse().resolution[0]+Qn.parse().resolution[1]),Zn+"-"+no+eo+to+ro),!0)+"&fp="+wr(function(){try{if("string"==typeof window.name&&0==window.name.indexOf("{")&&window.name.lastIndexOf("}")==window.name.length-1){var e=JSON.parse(window.name);yr("fp1",e.fp1||""),yr("cc",e.cc||"")}for(var t=new ClientJS,r=[],n="getBrowserMajorVersion,isIE,isChrome,isFirefox,isSafari,isOpera,getOSVersion,isWindows,isMac,isLinux,isUbuntu,isSolaris,isMobile,isMobileMajor,isMobileAndroid,isMobileOpera,isMobileWindows,isMobileBlackBerry,isMobileIOS,isIphone,isIpad,isIpod,getColorDepth,getCurrentResolution,getDeviceXDPI,getDeviceYDPI|isCanvas,getCanvasPrint|getPlugins,getMimeTypes,isMimeTypes,isFont,getFonts,isLocalStorage,isSessionStorage,isCookie|getTimeZone,getLanguage,getSystemLanguage".split("|"),o="",i=0;i<n.length;i++){for(var a=n[i].split(","),s=0;s<a.length;s++){var c="";try{c=(t[a[s]]()||"")+""}catch(e){}r.push(c)}o+="."+Xn(r,256),r=[]}var u=br("cc")||"",l=br("fp1")||"",d=br("refr")||"";return""==l&&yr("fp1",l=(t.getOS().replace("Windows","Win")+"."+t.getOSVersion()+"."+t.getBrowser()).split(" ").join("-").split("_").join("-")+o),""==u&&yr("cc",u=Kn()),l+"."+Xn([d],256)+"."+u}catch(e){return""!=(u=br("cc"))&&null!=u||yr("cc",u=Kn()),"ERR."+u}}(),!0)}),io=r(27),ao=function(){return Math.random().toString(36).substring(7).split("").join(".")},so={INIT:"@@redux/INIT"+ao(),REPLACE:"@@redux/REPLACE"+ao(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ao()}};function co(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function uo(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function lo(e){return function(e){if(Array.isArray(e))return po(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return po(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return po(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function po(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fo(e){return function(e){if(Array.isArray(e))return ho(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ho(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ho(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mo(e){return function(e){if(Array.isArray(e))return _o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return _o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function go(e){return function(e){if(Array.isArray(e))return vo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return vo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vo(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yo(e){return function(e){if(Array.isArray(e))return bo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return bo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bo(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wo(e){return function(e){if(Array.isArray(e))return So(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return So(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return So(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function So(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ko(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Co(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ko(Object(r),!0).forEach((function(t){Eo(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ko(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Eo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function To(e){return function(e){if(Array.isArray(e))return Po(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Po(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Po(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Po(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ao(e){return function(e){if(Array.isArray(e))return Ro(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ro(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ro(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ro(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oo(e){return function(e){if(Array.isArray(e))return xo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return xo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xo(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Mo=function e(t,r,n){var o;if("function"==typeof r&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof r&&void 0===n&&(n=r,r=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(e)(t,r)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var i=t,a=r,s=[],c=s,u=!1;function l(){c===s&&(c=s.slice())}function d(){if(u)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function p(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(u)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return l(),c.push(e),function(){if(t){if(u)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,l();var r=c.indexOf(e);c.splice(r,1),s=null}}}function f(e){if(!co(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,a=i(a,e)}finally{u=!1}for(var t=s=c,r=0;r<t.length;r++){(0,t[r])()}return e}function h(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,f({type:so.REPLACE})}function m(){var e,t=p;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(d())}return r(),{unsubscribe:t(r)}}})[io.a]=function(){return this},e}return f({type:so.INIT}),(o={dispatch:f,subscribe:p,getState:d,replaceReducer:h})[io.a]=m,o}(function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];0,"function"==typeof e[o]&&(r[o]=e[o])}var i,a=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:so.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:so.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+so.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var n=!1,o={},s=0;s<a.length;s++){var c=a[s],u=r[c],l=e[c],d=u(l,t);if(void 0===d){var p=uo(c,t);throw new Error(p)}o[c]=d,n=n||d!==l}return(n=n||a.length!==Object.keys(e).length)?o:e}}({socket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SOCKET":return t.socket;default:return e}},currentPane:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_PANE":return t.currentPane;default:return e}},posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_POSTS":return t.posts.sort((function(e,t){return e.time>t.time?-1:1}));case"ADD_POST":return e.length>=t.wallMsgCount&&e.pop(),[].concat(Oo(e),[t.post]).sort((function(e,t){return e.time>t.time?-1:1}));case"REMOVE_POST":return e.filter((function(e){return e.id!=t.id}));case"UPDATE_POST":return e.map((function(e){return t.post&&t.post.id==e.id?t.post:e}));case"UPDATE_POSTS_USER":return e.map((function(e){var r=JSON.parse(JSON.stringify(e));return e.user&&t.user.reg_id&&e.user.reg_id==t.user.reg_id&&Object.keys(t.user.updates).forEach((function(e){r.user[e]=t.user.updates[e]})),r}));case"UPDATE_POST_ATTRIBUTE":return e.map((function(e){var r=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&Object.keys(t.post.updates).forEach((function(e){r[e]=t.post.updates[e]})),r})).sort((function(e,t){return e.time>t.time?-1:1}));case"INC_POST_COMMENTS_COUNT":return e.map((function(e){var r=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&(r.comments=r.comments+1),r})).sort((function(e,t){return e.time>t.time?-1:1}));case"DEC_POST_COMMENTS_COUNT":return e.map((function(e){var r=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&(r.comments=r.comments-1),r})).sort((function(e,t){return e.time>t.time?-1:1}));default:return e.sort((function(e,t){return e.time>t.time?-1:1}))}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return t.users.sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"ADD_USER":return[].concat(lo(e),[t.user]).sort((function(e,t){return e.power>t.power?-1:1}));case"UPDATE_USER":return e.map((function(e){return e.id==t.user.id?t.user:e})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"UPDATE_USER_ATTRIBUTE":return e.map((function(e){return e.id==t.user.id&&Object.keys(t.user.updates).forEach((function(r){e[r]=t.user.updates[r]})),e})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"REMOVE_USER":return e.filter((function(e){return e.id!=t.user.id})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));default:return e}},rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ROOMS":return t.rooms.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"ADD_ROOM":return[].concat(fo(e),[t.room]).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"SORT_ROOMS":return e.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"UPDATE_ROOM":return e.map((function(e){return t.room&&t.room.id==e.id?t.room:e}));case"DELETE_ROOM":return e.filter((function(e){return t.id!=e.id}));case"UPDATE_ROOM_BACKGROUND":return e.map((function(e){var r=JSON.parse(JSON.stringify(e));return t.id==e.id&&(r.background=t.background),r}));case"UPDATE_ROOM_FLAG":return e.map((function(e){var r=JSON.parse(JSON.stringify(e));return t.id==e.id&&(r.flag=t.flag),r}));case"HANDLE_USER_CHANGE_ROOM":return e.map((function(e){return t.oldRoomId==e.id?e.users=e.users.filter((function(e){return e!=t.userId})):t.newRoomId==e.id&&e.users.push(t.userId),e})).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"REMOVE_OLD_USER_FROM_ROOM":return e.map((function(e){return e.users=e.users.filter((function(e){return e!=t.oldSocketId})),e})).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));default:return e.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}))}},gifts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GIFTS":return t.gifts.sort((function(e,t){return e.id>t.id?1:-1}));case"ADD_GIFT":return[].concat(yo(e),[t.gift]).sort((function(e,t){return e.id>t.id?1:-1}));case"SORT_GIFTS":default:return e.sort((function(e,t){return e.id>t.id?1:-1}))}},faces:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FACES":return t.faces.sort((function(e,t){return e.id>t.id?1:-1}));case"ADD_FACE":return[].concat(Ao(e),[t.face]).sort((function(e,t){return e.id>t.id?1:-1}));case"SORT_FACES":default:return e.sort((function(e,t){return e.id>t.id?1:-1}))}},mUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;case"UPDATE_CURRENT_USER":var r=JSON.parse(JSON.stringify(e));return Object.keys(t.updates).forEach((function(e){r[e]=t.updates[e]})),r;default:return e}},requestedUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_REQUESTED_USER":return t.user;case"UPDATE_REQUESTED_USER":if(e&&e.id==t.user.id){var r=JSON.parse(JSON.stringify(e));return Object.keys(t.user.updates).forEach((function(e){r[e]=t.user.updates[e]})),r}return e;default:return e}},usersFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FILTER_USERS_BY_NAME":return t.name;case"FILTER_USERS_BY_HASH_TAG":return t.hashTag;default:return e}},isUserProfileOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_PROFILE":return t.isUserProfileOpen;default:return e}},isWallCommentsOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_WALL_COMMENTS":return t.isWallCommentsOpen;default:return e}},wallCommentsPost:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WALL_COMMENTS_POST":return t.wallCommentsPost;default:return e}},isCreateRoomOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_CREATE_ROOM_MODAL":return t.isCreateRoomOpen;default:return e}},isEditRoomOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_EDIT_ROOM_MODAL":return t.isEditRoomOpen;default:return e}},isGiftsPickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_GIFT_PICKER":return t.isGiftsPickerOpen;default:return e}},isRevealNamesOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_REVEAL_NAMES":return t.isRevealNamesOpen;default:return e}},popups:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_POPUP":return[].concat(go(e),[t.popup]);case"REMOVE_POPUP":return e.filter((function(e){return e.id!=t.popup.id}));case"TRUST_USER_POPUP":return e.map((function(e){return e.data.user_id==t.user_id?(e.data.is_trusted=!0,e):e}));default:return e}},ignoredUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IGNORE_USER":return[].concat(wo(e),[t.id]);case"UNIGNORE_USER":return e.filter((function(e){return e!=t.id}));default:return e}},grantedSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GRANTED_SETTINGS":return t.settings;default:return e}},tempOnlineUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TEMP_ONLINE_USERS":return t.users.sort((function(e,t){return e.power>t.power?-1:1}));case"CLEAR_TEMP_ONLINE_USERS":return[];default:return e}},revealNames:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_REVEAL_NAMES":return t.names;case"CLEAR_REVEAL_NAMES":return[];default:return e}},publicMessages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=18;switch(t.type){case"ADD_PUBLIC_MESSAGE":t.message.id=t.message.id||Date.now()+Math.round(1e8*Math.random()),t.message.time=t.message.time||Date.now();var n=e.length>r?e.length-r:0,o=n?e.slice(n):e;return[].concat(mo(o),[t.message]);case"UPDATE_PUBLIC_MESSAGE_USER":return e.map((function(e){var r=JSON.parse(JSON.stringify(e));return e.user&&e.user.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){r.user[e]=t.user.updates[e],r.icon=t.user.updates.avatar?t.user.updates.avatar:r.icon})),r}));case"REMOVE_PUBLIC_MESSAGE":return e.filter((function(e){return e.id!=t.id}));case"CLEAR_MESSAGES_BY_TYPE":return e.filter((function(e){return e.type!=t.msgType}));case"CLEAR_ALL_PUBLIC_MESSAGES":return[];default:return e}},conversations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=10;switch(t.type){case"REMOVE_CONVERSATION":return e.filter((function(e){return e.id!=t.id}));case"REMOVE_CONVERSATION_BY_USER":return e.filter((function(e){return e.him.id!=t.him_id}));case"ADD_MESSAGE_TO_CONVERSATION":var n=e.filter((function(e){return e.id==t.conversation_id}))[0];if(n){n.messages||(n.messages=[]);var o=n.messages.length>r?n.messages.length-r:0;return n.messages=o?n.messages.slice(o):n.messages,n.seen=t.seen,n.messages.push({id:t.message.id,body:t.message.body,type:t.message.type,time:t.message.time,by:t.message.by}),e.map((function(e){return e.id==n.id?n:e}))}var i={id:t.conversation_id,me:t.me,him:t.him,seen:t.seen,messages:[{id:t.message.id,body:t.message.body,type:t.message.type,time:t.message.time,by:t.message.by}]};return[].concat(To(e),[i]);case"READ_CONVERSATION":return e.map((function(e){return e.id==t.id?Co(Co({},e),{},{seen:!0}):e}));case"UPDATE_PRIVATE_MESSAGE_USER":return e.map((function(e){var r=JSON.parse(JSON.stringify(e));return e.me&&e.me.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){r.me[e]=t.user.updates[e]})),e.him&&e.him.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){r.him[e]=t.user.updates[e]})),r}));default:return e}},newPostsCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INC_NEW_POSTS_COUNT":return++e;case"RESET_NEW_POSTS_COUNT":return 0;default:return e}},currentConversation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_CONVERSATION":return t.user;case"UPDATE_CURRENT_CONVERSATION":if(e&&e.id==t.user.id){var r=JSON.parse(JSON.stringify(e));return Object.keys(t.user.updates).forEach((function(e){r[e]=t.user.updates[e]})),r}return e;default:return e}},isPostsFetched:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_POSTS_FETCHED":return t.isPostsFetched;default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SETTINGS":return t.settings;case"UPDATE_SETTINGS_ATTRIBUTE":return Object.keys(t.updates).forEach((function(r){e[r]=t.updates[r]})),e;default:return e}},album:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ALBUM":return t.album;default:return e}},isLocationReady:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_LOCATION_READY":return t.isLocationReady;default:return e}},lightBoxFullImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LIGHT_BOX_FULL_IMAGE":return t.lightBoxFullImage;default:return e}},isWallOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_WALL_OPEN":return t.isWallOpen;default:return e}},particleType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FLOATING_PARTICLES":return t.particleType;default:return e}},webrtc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WEBRTC":return t.webrtc;default:return e}},currentCall:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_CALL":return t.currentCall;default:return e}},isCallDialogOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_CALL_DIALOG_OPEN":return t.isCallDialogOpen;default:return e}},radioConnectionReady:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_RADIO_CONNECTION_READY":return t.radioConnectionReady;default:return e}},isWallFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_WALL_FACE_PICKER":return t.isWallFacePickerOpen;default:return e}},isWallCommentsFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_WALL_COMMENTS_FACE_PICKER":return t.isWallCommentsFacePickerOpen;default:return e}},isPublicMessagesFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_PUBLIC_MESSAGES_FACE_PICKER":return t.isPublicMessagesFacePickerOpen;default:return e}},nextTimeMillis:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PUBLIC_MESSAGES_NEXT_TIME_MILLILS":return t.nextTimeMillis;default:return e}},isTvBoxOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_TV_BOX_OPEN":return t.isTvBoxOpen;default:return e}},isRequestingProfile:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_REQUESTING_PROFILE":return t.isRequestingProfile;default:return e}},isPrivateMessagesFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_PRIVATE_MESSAGES_FACE_PICKER":return t.isPrivateMessagesFacePickerOpen;default:return e}}})),Do=function(e){return{type:"SET_SOCKET",socket:e}};window.confirmOnExit=!0,Mo.dispatch(Do(oo)),Mo.dispatch(gn(settings)),Mo.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_LOCATION_READY",isLocationReady:e}}(!0)),Wn.render(Mo)},function(e,t){}]);